{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/utils/banUtils.tsx"],"sourcesContent":["// src/utils/banUtils.tsx\r\nimport { \r\n  AlertTriangle, \r\n  MessageSquare, \r\n  AlertCircle, \r\n  UserCheck, \r\n  Info \r\n} from 'lucide-react';\r\nimport { BanEntry, BanReason } from '@/types/ban';\r\nimport { sanitizeStrict } from '@/utils/security/sanitization';\r\n\r\nexport const getBanReasonDisplay = (reason: string, customReason?: string) => {\r\n  if (!reason || typeof reason !== 'string') {\r\n    return 'Unknown Reason';\r\n  }\r\n\r\n  const reasonMap: Record<string, { label: string, icon: any, color: string }> = {\r\n    harassment: { label: 'Harassment', icon: AlertTriangle, color: 'text-red-400' },\r\n    spam: { label: 'Spam', icon: MessageSquare, color: 'text-yellow-400' },\r\n    inappropriate_content: { label: 'Inappropriate Content', icon: AlertCircle, color: 'text-orange-400' },\r\n    scam: { label: 'Scam/Fraud', icon: AlertTriangle, color: 'text-red-500' },\r\n    underage: { label: 'Underage', icon: UserCheck, color: 'text-purple-400' },\r\n    payment_fraud: { label: 'Payment Fraud', icon: AlertTriangle, color: 'text-red-600' },\r\n    other: { label: 'Other', icon: Info, color: 'text-gray-400' }\r\n  };\r\n\r\n  const reasonInfo = reasonMap[reason.toLowerCase()] || { label: reason, icon: Info, color: 'text-gray-400' };\r\n  const Icon = reasonInfo.icon;\r\n\r\n  // Sanitize customReason before display to prevent XSS\r\n  const sanitizedCustomReason = customReason ? sanitizeStrict(customReason) : undefined;\r\n\r\n  return (\r\n    <span className={`flex items-center gap-1 ${reasonInfo.color}`}>\r\n      <Icon size={14} />\r\n      {reasonInfo.label}\r\n      {sanitizedCustomReason && <span className=\"text-gray-400 ml-1\">- {sanitizedCustomReason}</span>}\r\n    </span>\r\n  );\r\n};\r\n\r\nexport const isValidBan = (ban: any): ban is BanEntry => {\r\n  return ban && \r\n         typeof ban === 'object' && \r\n         ban.id && \r\n         ban.username && \r\n         typeof ban.username === 'string' &&\r\n         ban.banType &&\r\n         ban.reason &&\r\n         ban.startTime &&\r\n         typeof ban.bannedBy === 'string'; // Changed to check type instead of truthiness\r\n};\r\n"],"names":[],"mappings":"AAAA,yBAAyB;;;;;;AACzB;AAAA;AAAA;AAAA;AAAA;AAQA;;;;AAEO,MAAM,sBAAsB,CAAC,QAAgB;IAClD,IAAI,CAAC,UAAU,OAAO,WAAW,UAAU;QACzC,OAAO;IACT;IAEA,MAAM,YAAyE;QAC7E,YAAY;YAAE,OAAO;YAAc,MAAM,2NAAA,CAAA,gBAAa;YAAE,OAAO;QAAe;QAC9E,MAAM;YAAE,OAAO;YAAQ,MAAM,2NAAA,CAAA,gBAAa;YAAE,OAAO;QAAkB;QACrE,uBAAuB;YAAE,OAAO;YAAyB,MAAM,uNAAA,CAAA,cAAW;YAAE,OAAO;QAAkB;QACrG,MAAM;YAAE,OAAO;YAAc,MAAM,2NAAA,CAAA,gBAAa;YAAE,OAAO;QAAe;QACxE,UAAU;YAAE,OAAO;YAAY,MAAM,mNAAA,CAAA,YAAS;YAAE,OAAO;QAAkB;QACzE,eAAe;YAAE,OAAO;YAAiB,MAAM,2NAAA,CAAA,gBAAa;YAAE,OAAO;QAAe;QACpF,OAAO;YAAE,OAAO;YAAS,MAAM,qMAAA,CAAA,OAAI;YAAE,OAAO;QAAgB;IAC9D;IAEA,MAAM,aAAa,SAAS,CAAC,OAAO,WAAW,GAAG,IAAI;QAAE,OAAO;QAAQ,MAAM,qMAAA,CAAA,OAAI;QAAE,OAAO;IAAgB;IAC1G,MAAM,OAAO,WAAW,IAAI;IAE5B,sDAAsD;IACtD,MAAM,wBAAwB,eAAe,CAAA,GAAA,2IAAA,CAAA,iBAAc,AAAD,EAAE,gBAAgB;IAE5E,qBACE,6LAAC;QAAK,WAAW,AAAC,2BAA2C,OAAjB,WAAW,KAAK;;0BAC1D,6LAAC;gBAAK,MAAM;;;;;;YACX,WAAW,KAAK;YAChB,uCAAyB,6LAAC;gBAAK,WAAU;;oBAAqB;oBAAG;;;;;;;;;;;;;AAGxE;AAEO,MAAM,aAAa,CAAC;IACzB,OAAO,OACA,OAAO,QAAQ,YACf,IAAI,EAAE,IACN,IAAI,QAAQ,IACZ,OAAO,IAAI,QAAQ,KAAK,YACxB,IAAI,OAAO,IACX,IAAI,MAAM,IACV,IAAI,SAAS,IACb,OAAO,IAAI,QAAQ,KAAK,UAAU,8CAA8C;AACzF","debugId":null}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/admin/bans/UnbanModal.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { UserCheck } from 'lucide-react';\r\nimport { SecureTextarea } from '@/components/ui/SecureInput';\r\nimport { sanitizeStrict } from '@/utils/security/sanitization';\r\nimport { BanEntry } from '@/types/ban';\r\nimport { getBanReasonDisplay } from '@/utils/banUtils';\r\n\r\ninterface UnbanModalProps {\r\n  ban: BanEntry | null;\r\n  isLoading: boolean;\r\n  onClose: () => void;\r\n  onConfirm: (reason: string) => void;\r\n}\r\n\r\nexport default function UnbanModal({ ban, isLoading, onClose, onConfirm }: UnbanModalProps) {\r\n  const [unbanReason, setUnbanReason] = useState('');\r\n\r\n  if (!ban) return null;\r\n\r\n  const handleConfirm = () => {\r\n    onConfirm(unbanReason.trim());\r\n    setUnbanReason('');\r\n  };\r\n\r\n  const handleClose = () => {\r\n    onClose();\r\n    setUnbanReason('');\r\n  };\r\n\r\n  const handleReasonChange = (value: string) => {\r\n    // Let SecureTextarea sanitize; additionally trim long runs of whitespace\r\n    setUnbanReason(sanitizeStrict(value));\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Unban user dialog\">\r\n      <div className=\"bg-[#1a1a1a] border border-gray-800 rounded-lg p-6 max-w-md w-full\">\r\n        <h3 className=\"text-xl font-bold text-white mb-4 flex items-center\">\r\n          <UserCheck className=\"mr-2 text-green-400\" />\r\n          Unban User\r\n        </h3>\r\n\r\n        <div className=\"mb-4\">\r\n          <p className=\"text-gray-300 mb-2\">\r\n            Are you sure you want to unban <strong>{ban.username}</strong>?\r\n          </p>\r\n          <div className=\"text-sm text-gray-400 space-y-1\">\r\n            <div>Original reason: {getBanReasonDisplay(ban.reason, ban.customReason)}</div>\r\n            <div>Banned by: {ban.bannedBy || 'Unknown'}</div>\r\n            <div>Ban type: {ban.banType || 'Unknown'}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mb-4\">\r\n          <SecureTextarea\r\n            label=\"Reason for unbanning (optional)\"\r\n            value={unbanReason}\r\n            onChange={handleReasonChange}\r\n            placeholder=\"Reason for lifting this ban...\"\r\n            maxLength={500}\r\n            characterCount\r\n            rows={3}\r\n            sanitize\r\n            sanitizer={sanitizeStrict}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"flex gap-3\">\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"flex-1 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors\"\r\n            disabled={isLoading}\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={handleConfirm}\r\n            className=\"flex-1 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 flex items-center justify-center transition-colors\"\r\n            disabled={isLoading}\r\n          >\r\n            {isLoading ? (\r\n              <>\r\n                <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\r\n                Unbanning...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <UserCheck size={16} className=\"mr-2\" />\r\n                Unban User\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AAEA;;;AAPA;;;;;;AAgBe,SAAS,WAAW,KAAuD;QAAvD,EAAE,GAAG,EAAE,SAAS,EAAE,OAAO,EAAE,SAAS,EAAmB,GAAvD;;IACjC,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE/C,IAAI,CAAC,KAAK,OAAO;IAEjB,MAAM,gBAAgB;QACpB,UAAU,YAAY,IAAI;QAC1B,eAAe;IACjB;IAEA,MAAM,cAAc;QAClB;QACA,eAAe;IACjB;IAEA,MAAM,qBAAqB,CAAC;QAC1B,yEAAyE;QACzE,eAAe,CAAA,GAAA,2IAAA,CAAA,iBAAc,AAAD,EAAE;IAChC;IAEA,qBACE,6LAAC;QAAI,WAAU;QAAiF,MAAK;QAAS,cAAW;QAAO,cAAW;kBACzI,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;;sCACZ,6LAAC,mNAAA,CAAA,YAAS;4BAAC,WAAU;;;;;;wBAAwB;;;;;;;8BAI/C,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAE,WAAU;;gCAAqB;8CACD,6LAAC;8CAAQ,IAAI,QAAQ;;;;;;gCAAU;;;;;;;sCAEhE,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;;wCAAI;wCAAkB,CAAA,GAAA,4HAAA,CAAA,sBAAmB,AAAD,EAAE,IAAI,MAAM,EAAE,IAAI,YAAY;;;;;;;8CACvE,6LAAC;;wCAAI;wCAAY,IAAI,QAAQ,IAAI;;;;;;;8CACjC,6LAAC;;wCAAI;wCAAW,IAAI,OAAO,IAAI;;;;;;;;;;;;;;;;;;;8BAInC,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,0IAAA,CAAA,iBAAc;wBACb,OAAM;wBACN,OAAO;wBACP,UAAU;wBACV,aAAY;wBACZ,WAAW;wBACX,cAAc;wBACd,MAAM;wBACN,QAAQ;wBACR,WAAW,2IAAA,CAAA,iBAAc;;;;;;;;;;;8BAI7B,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BACC,SAAS;4BACT,WAAU;4BACV,UAAU;sCACX;;;;;;sCAGD,6LAAC;4BACC,SAAS;4BACT,WAAU;4BACV,UAAU;sCAET,0BACC;;kDACE,6LAAC;wCAAI,WAAU;;;;;;oCAAsF;;6DAIvG;;kDACE,6LAAC,mNAAA,CAAA,YAAS;wCAAC,MAAM;wCAAI,WAAU;;;;;;oCAAS;;;;;;;;;;;;;;;;;;;;;;;;;AASxD;GAlFwB;KAAA","debugId":null}},
    {"offset": {"line": 334, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/user-check.js","sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/node_modules/lucide-react/src/icons/user-check.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2', key: '1yyitq' }],\n  ['circle', { cx: '9', cy: '7', r: '4', key: 'nufk8' }],\n  ['polyline', { points: '16 11 18 13 22 9', key: '1pwet4' }],\n];\n\n/**\n * @component @name UserCheck\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMjF2LTJhNCA0IDAgMCAwLTQtNEg2YTQgNCAwIDAgMC00IDR2MiIgLz4KICA8Y2lyY2xlIGN4PSI5IiBjeT0iNyIgcj0iNCIgLz4KICA8cG9seWxpbmUgcG9pbnRzPSIxNiAxMSAxOCAxMyAyMiA5IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/user-check\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst UserCheck = createLucideIcon('user-check', __iconNode);\n\nexport default UserCheck;\n"],"names":[],"mappings":";;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAuB,CAAA,CAAA,CAAA,CAAA;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA;QAAA,CAAA;YAAE,GAAG,CAA6C,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAA,CAAA,CAAA,CAAA,CAAA,CAAK;QAAA,CAAU;KAAA,CAAA;IAC1E;QAAC,QAAU,CAAA;QAAA,CAAA;YAAE,EAAI,CAAA,CAAA,CAAA,CAAA,CAAA;YAAK,CAAI,CAAA,CAAA,CAAA,GAAA,CAAK;YAAA,CAAG,EAAA,CAAA,CAAA,CAAA,CAAA;YAAK,GAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAS;KAAA,CAAA;IACrD;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAY,CAAA;QAAA,CAAA;YAAE,QAAQ,CAAoB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAA,CAAA,CAAA,CAAA,CAAA,CAAK;QAAA,CAAU;KAAA;CAC5D,CAAA;AAaM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,SAAA,CAAY,CAAA,2KAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAiB,AAAjB,CAAA,CAAA,AAAiB,CAAjB,AAAiB,CAAjB,AAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAc,CAAU,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA","debugId":null}}]
}