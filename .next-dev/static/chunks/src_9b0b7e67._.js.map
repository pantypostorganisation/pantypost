{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/RequireAuth.tsx"],"sourcesContent":["// src/components/RequireAuth.tsx\r\n'use client';\r\n\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useEffect, useState } from 'react';\r\nimport { z } from 'zod';\r\n\r\nconst VALID_ROLES = ['buyer', 'seller', 'admin'] as const;\r\ntype ValidRole = (typeof VALID_ROLES)[number];\r\n\r\nconst RoleSchema = z.enum(VALID_ROLES);\r\n\r\nexport default function RequireAuth({\r\n  role,\r\n  children,\r\n}: {\r\n  role: ValidRole;\r\n  children: React.ReactNode;\r\n}) {\r\n  const { user, isAuthReady } = useAuth();\r\n  const router = useRouter();\r\n  const [authorized, setAuthorized] = useState(false);\r\n  const [hasChecked, setHasChecked] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isAuthReady || hasChecked) return;\r\n\r\n    // Runtime validation of `role` prop (dev-only noise)\r\n    const parsed = RoleSchema.safeParse(role);\r\n    if (!parsed.success) {\r\n      if (process.env.NODE_ENV === 'development') {\r\n        console.warn('[RequireAuth] Invalid role prop supplied:', role);\r\n      }\r\n      router.push('/login');\r\n      setHasChecked(true);\r\n      return;\r\n    }\r\n\r\n    const userRole = user?.role as ValidRole | undefined;\r\n\r\n    // NEW: strict role matching — no admin override for buyer/seller routes\r\n    let hasAccess = false;\r\n    if (parsed.data === 'admin') {\r\n      hasAccess = userRole === 'admin';\r\n    } else {\r\n      hasAccess = userRole === parsed.data; // admin can’t view buyer/seller pages\r\n    }\r\n\r\n    if (!user || !hasAccess) {\r\n      router.push('/login');\r\n    } else {\r\n      setAuthorized(true);\r\n    }\r\n\r\n    setHasChecked(true);\r\n  }, [isAuthReady, user, role, router, hasChecked]);\r\n\r\n  if (!isAuthReady || !hasChecked) {\r\n    return (\r\n      <div className=\"min-h-screen bg-black flex items-center justify-center\" role=\"status\" aria-label=\"Checking access\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          <div className=\"w-4 h-4 bg-[#ff950e] rounded-full animate-pulse\" />\r\n          <div className=\"w-4 h-4 bg-[#ff950e] rounded-full animate-pulse\" style={{ animationDelay: '0.2s' }} />\r\n          <div className=\"w-4 h-4 bg-[#ff950e] rounded-full animate-pulse\" style={{ animationDelay: '0.4s' }} />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!authorized) return null;\r\n\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":"AAAA,iCAAiC;;;;AA+BvB;;AA5BV;AACA;AACA;AACA;;;AALA;;;;;AAOA,MAAM,cAAc;IAAC;IAAS;IAAU;CAAQ;AAGhD,MAAM,aAAa,qKAAA,CAAA,IAAC,CAAC,IAAI,CAAC;;AAEX,SAAS,YAAY,KAMnC;QANmC,EAClC,IAAI,EACJ,QAAQ,EAIT,GANmC;;IAOlC,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,GAAG,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;IACpC,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE7C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR,IAAI,CAAC,eAAe,YAAY;YAEhC,qDAAqD;YACrD,MAAM,SAAS,WAAW,SAAS,CAAC;YACpC,IAAI,CAAC,OAAO,OAAO,EAAE;gBACnB,wCAA4C;oBAC1C,QAAQ,IAAI,CAAC,6CAA6C;gBAC5D;gBACA,OAAO,IAAI,CAAC;gBACZ,cAAc;gBACd;YACF;YAEA,MAAM,WAAW,iBAAA,2BAAA,KAAM,IAAI;YAE3B,wEAAwE;YACxE,IAAI,YAAY;YAChB,IAAI,OAAO,IAAI,KAAK,SAAS;gBAC3B,YAAY,aAAa;YAC3B,OAAO;gBACL,YAAY,aAAa,OAAO,IAAI,EAAE,sCAAsC;YAC9E;YAEA,IAAI,CAAC,QAAQ,CAAC,WAAW;gBACvB,OAAO,IAAI,CAAC;YACd,OAAO;gBACL,cAAc;YAChB;YAEA,cAAc;QAChB;gCAAG;QAAC;QAAa;QAAM;QAAM;QAAQ;KAAW;IAEhD,IAAI,CAAC,eAAe,CAAC,YAAY;QAC/B,qBACE,6LAAC;YAAI,WAAU;YAAyD,MAAK;YAAS,cAAW;sBAC/F,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;;;;;kCACf,6LAAC;wBAAI,WAAU;wBAAkD,OAAO;4BAAE,gBAAgB;wBAAO;;;;;;kCACjG,6LAAC;wBAAI,WAAU;wBAAkD,OAAO;4BAAE,gBAAgB;wBAAO;;;;;;;;;;;;;;;;;IAIzG;IAEA,IAAI,CAAC,YAAY,OAAO;IAExB,qBAAO;kBAAG;;AACZ;GA5DwB;;QAOQ,iIAAA,CAAA,UAAO;QACtB,qIAAA,CAAA,YAAS;;;MARF","debugId":null}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/admin/wallet/WalletHeader.tsx"],"sourcesContent":["// src/components/admin/wallet/WalletHeader.tsx\r\n'use client';\r\n\r\nimport { Crown, Users, Wallet, RefreshCw, Download } from 'lucide-react';\r\n\r\ninterface WalletHeaderProps {\r\n  totalUsers: number;\r\n  onRefresh: () => void;\r\n  onExport: () => void;\r\n  isRefreshing: boolean;\r\n}\r\n\r\nexport default function WalletHeader({ totalUsers, onRefresh, onExport, isRefreshing }: WalletHeaderProps) {\r\n  const safeTotalUsers = Number.isFinite(Number(totalUsers)) && Number(totalUsers) >= 0 ? Number(totalUsers) : 0;\r\n\r\n  return (\r\n    <div className=\"flex flex-col sm:flex-row sm:items-center justify-between mb-8 gap-4\">\r\n      <div>\r\n        <h1 className=\"text-3xl font-bold text-[#ff950e] flex items-center gap-3\">\r\n          <Wallet className=\"h-8 w-8\" />\r\n          Wallet Management\r\n        </h1>\r\n        <p className=\"text-gray-400 mt-1\">Manage user wallet balances and view transaction history</p>\r\n      </div>\r\n\r\n      <div className=\"flex flex-wrap items-center gap-3\">\r\n        <button\r\n          onClick={onRefresh}\r\n          disabled={isRefreshing}\r\n          className=\"bg-[#1a1a1a] px-4 py-2 rounded-lg border border-gray-800 flex items-center gap-2 hover:bg-[#2a2a2a] transition-colors disabled:opacity-50\"\r\n          aria-busy={isRefreshing}\r\n        >\r\n          <RefreshCw className={`h-4 w-4 text-[#ff950e] ${isRefreshing ? 'animate-spin' : ''}`} />\r\n          <span className=\"text-sm font-medium text-white\">Refresh</span>\r\n        </button>\r\n\r\n        <button\r\n          onClick={onExport}\r\n          className=\"bg-[#1a1a1a] px-4 py-2 rounded-lg border border-gray-800 flex items-center gap-2 hover:bg-[#2a2a2a] transition-colors\"\r\n        >\r\n          <Download className=\"h-4 w-4 text-[#ff950e]\" />\r\n          <span className=\"text-sm font-medium text-white\">Export</span>\r\n        </button>\r\n\r\n        <div className=\"bg-[#1a1a1a] px-4 py-2 rounded-lg border border-gray-800 flex items-center gap-2\">\r\n          <Crown className=\"h-5 w-5 text-[#ff950e]\" />\r\n          <span className=\"text-sm font-medium text-white\">Admin Panel</span>\r\n        </div>\r\n\r\n        <div className=\"bg-[#1a1a1a] px-4 py-2 rounded-lg border border-gray-800 flex items-center gap-2\">\r\n          <Users className=\"h-5 w-5 text-[#ff950e]\" />\r\n          <span className=\"text-sm font-medium text-white\">{safeTotalUsers} Users</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,+CAA+C;;;;;AAG/C;AAAA;AAAA;AAAA;AAAA;AAFA;;;AAWe,SAAS,aAAa,KAAoE;QAApE,EAAE,UAAU,EAAE,SAAS,EAAE,QAAQ,EAAE,YAAY,EAAqB,GAApE;IACnC,MAAM,iBAAiB,OAAO,QAAQ,CAAC,OAAO,gBAAgB,OAAO,eAAe,IAAI,OAAO,cAAc;IAE7G,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;;kCACC,6LAAC;wBAAG,WAAU;;0CACZ,6LAAC,yMAAA,CAAA,SAAM;gCAAC,WAAU;;;;;;4BAAY;;;;;;;kCAGhC,6LAAC;wBAAE,WAAU;kCAAqB;;;;;;;;;;;;0BAGpC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,SAAS;wBACT,UAAU;wBACV,WAAU;wBACV,aAAW;;0CAEX,6LAAC,mNAAA,CAAA,YAAS;gCAAC,WAAW,AAAC,0BAA4D,OAAnC,eAAe,iBAAiB;;;;;;0CAChF,6LAAC;gCAAK,WAAU;0CAAiC;;;;;;;;;;;;kCAGnD,6LAAC;wBACC,SAAS;wBACT,WAAU;;0CAEV,6LAAC,6MAAA,CAAA,WAAQ;gCAAC,WAAU;;;;;;0CACpB,6LAAC;gCAAK,WAAU;0CAAiC;;;;;;;;;;;;kCAGnD,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,uMAAA,CAAA,QAAK;gCAAC,WAAU;;;;;;0CACjB,6LAAC;gCAAK,WAAU;0CAAiC;;;;;;;;;;;;kCAGnD,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,uMAAA,CAAA,QAAK;gCAAC,WAAU;;;;;;0CACjB,6LAAC;gCAAK,WAAU;;oCAAkC;oCAAe;;;;;;;;;;;;;;;;;;;;;;;;;AAK3E;KA5CwB","debugId":null}},
    {"offset": {"line": 327, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/admin/wallet/WalletFilters.tsx"],"sourcesContent":["// src/components/admin/wallet/WalletFilters.tsx\r\n'use client';\r\n\r\nimport { Search, Eye, EyeOff, X } from 'lucide-react';\r\nimport { SecureInput } from '@/components/ui/SecureInput';\r\nimport { sanitizeSearchQuery } from '@/utils/security/sanitization';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\ninterface WalletFiltersProps {\r\n  searchTerm: string;\r\n  setSearchTerm: (term: string) => void;\r\n  roleFilter: 'all' | 'buyer' | 'seller';\r\n  setRoleFilter: (filter: 'all' | 'buyer' | 'seller') => void;\r\n  balanceFilter: 'all' | 'positive' | 'zero' | 'negative';\r\n  setBalanceFilter: (filter: 'all' | 'positive' | 'zero' | 'negative') => void;\r\n  showBalances: boolean;\r\n  setShowBalances: (show: boolean) => void;\r\n  selectedUsers: string[];\r\n  setSelectedUsers: (users: string[]) => void;\r\n  displayedUsers: any[];\r\n  handleSelectAll: () => void;\r\n  setShowBulkModal: (show: boolean) => void;\r\n}\r\n\r\nexport default function WalletFilters({\r\n  searchTerm,\r\n  setSearchTerm,\r\n  roleFilter,\r\n  setRoleFilter,\r\n  balanceFilter,\r\n  setBalanceFilter,\r\n  showBalances,\r\n  setShowBalances,\r\n  selectedUsers = [],\r\n  setSelectedUsers,\r\n  displayedUsers = [],\r\n  handleSelectAll,\r\n  setShowBulkModal\r\n}: WalletFiltersProps) {\r\n  const handleSearchChange = (value: string) => {\r\n    const sanitizedValue = sanitizeSearchQuery(value);\r\n    setSearchTerm(sanitizedValue);\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-[#1a1a1a] p-6 rounded-xl border border-gray-800 shadow-lg mb-8\">\r\n      <div className=\"flex flex-col lg:flex-row gap-4 mb-4\">\r\n        {/* Search Bar */}\r\n        <div className=\"flex-1 relative\">\r\n          <Search className=\"absolute left-3 top-3 h-4 w-4 text-gray-400 z-10\" />\r\n          <SecureInput\r\n            type=\"text\"\r\n            value={searchTerm}\r\n            onChange={handleSearchChange}\r\n            placeholder=\"Search users...\"\r\n            className=\"w-full pl-10 pr-4 py-2 bg-black/50 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#ff950e]\"\r\n            maxLength={100}\r\n            sanitize={true}\r\n            sanitizer={sanitizeSearchQuery}\r\n            aria-label=\"Search users\"\r\n          />\r\n        </div>\r\n\r\n        {/* Role Filter */}\r\n        <select\r\n          value={roleFilter}\r\n          onChange={(e) => setRoleFilter(e.target.value as any)}\r\n          className=\"px-4 py-2 bg-black/50 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-[#ff950e]\"\r\n          aria-label=\"Role filter\"\r\n        >\r\n          <option value=\"all\">All Roles</option>\r\n          <option value=\"buyer\">Buyers</option>\r\n          <option value=\"seller\">Sellers</option>\r\n        </select>\r\n\r\n        {/* Balance Filter */}\r\n        <select\r\n          value={balanceFilter}\r\n          onChange={(e) => setBalanceFilter(e.target.value as any)}\r\n          className=\"px-4 py-2 bg-black/50 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-[#ff950e]\"\r\n          aria-label=\"Balance filter\"\r\n        >\r\n          <option value=\"all\">All Balances</option>\r\n          <option value=\"positive\">Positive</option>\r\n          <option value=\"zero\">Zero</option>\r\n          <option value=\"negative\">Negative</option>\r\n        </select>\r\n\r\n        {/* Toggle Balance Visibility */}\r\n        <button\r\n          onClick={() => setShowBalances(!showBalances)}\r\n          className=\"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white transition-colors flex items-center gap-2\"\r\n          aria-pressed={showBalances}\r\n          aria-label=\"Toggle balance visibility\"\r\n        >\r\n          {showBalances ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\r\n          {showBalances ? 'Hide' : 'Show'} Balances\r\n        </button>\r\n      </div>\r\n\r\n      {/* Bulk Actions Bar */}\r\n      {selectedUsers.length > 0 && (\r\n        <div className=\"flex items-center justify-between bg-[#ff950e]/10 border border-[#ff950e]/30 rounded-lg p-3 mb-4\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <span className=\"text-sm font-medium text-white\">{selectedUsers.length} users selected</span>\r\n            <button onClick={() => setSelectedUsers([])} className=\"text-gray-400 hover:text-white\" aria-label=\"Clear selection\">\r\n              <X className=\"h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n          <button\r\n            onClick={() => setShowBulkModal(true)}\r\n            className=\"px-4 py-2 bg-[#ff950e] hover:bg-[#ff6b00] text-black rounded-lg text-sm font-medium transition-colors\"\r\n          >\r\n            Bulk Action\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Selected users (optional inline peek) */}\r\n      {selectedUsers.length > 0 && (\r\n        <div className=\"mb-3 -mt-2\">\r\n          <div className=\"max-h-16 overflow-y-auto\">\r\n            {selectedUsers.map((u) => (\r\n              <span key={u} className=\"inline-block bg-[#ff950e]/20 text-[#ff950e] px-2 py-1 rounded text-xs mr-1 mb-1\">\r\n                <SecureMessageDisplay content={u} allowBasicFormatting={false} className=\"inline\" />\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Results Summary */}\r\n      <div className=\"flex items-center justify-between text-sm text-gray-400\">\r\n        <span>Showing {Array.isArray(displayedUsers) ? displayedUsers.length : 0} users</span>\r\n        {Array.isArray(displayedUsers) && displayedUsers.length > 0 && (\r\n          <button onClick={handleSelectAll} className=\"text-[#ff950e] hover:text-[#ff6b00] transition-colors\">\r\n            {selectedUsers.length === displayedUsers.length ? 'Deselect All' : 'Select All'}\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,gDAAgD;;;;;AAGhD;AAAA;AAAA;AAAA;AACA;AACA;AACA;AALA;;;;;;AAuBe,SAAS,cAAc,KAcjB;QAdiB,EACpC,UAAU,EACV,aAAa,EACb,UAAU,EACV,aAAa,EACb,aAAa,EACb,gBAAgB,EAChB,YAAY,EACZ,eAAe,EACf,gBAAgB,EAAE,EAClB,gBAAgB,EAChB,iBAAiB,EAAE,EACnB,eAAe,EACf,gBAAgB,EACG,GAdiB;IAepC,MAAM,qBAAqB,CAAC;QAC1B,MAAM,iBAAiB,CAAA,GAAA,2IAAA,CAAA,sBAAmB,AAAD,EAAE;QAC3C,cAAc;IAChB;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCAEb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,yMAAA,CAAA,SAAM;gCAAC,WAAU;;;;;;0CAClB,6LAAC,0IAAA,CAAA,cAAW;gCACV,MAAK;gCACL,OAAO;gCACP,UAAU;gCACV,aAAY;gCACZ,WAAU;gCACV,WAAW;gCACX,UAAU;gCACV,WAAW,2IAAA,CAAA,sBAAmB;gCAC9B,cAAW;;;;;;;;;;;;kCAKf,6LAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;wBAC7C,WAAU;wBACV,cAAW;;0CAEX,6LAAC;gCAAO,OAAM;0CAAM;;;;;;0CACpB,6LAAC;gCAAO,OAAM;0CAAQ;;;;;;0CACtB,6LAAC;gCAAO,OAAM;0CAAS;;;;;;;;;;;;kCAIzB,6LAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;wBAChD,WAAU;wBACV,cAAW;;0CAEX,6LAAC;gCAAO,OAAM;0CAAM;;;;;;0CACpB,6LAAC;gCAAO,OAAM;0CAAW;;;;;;0CACzB,6LAAC;gCAAO,OAAM;0CAAO;;;;;;0CACrB,6LAAC;gCAAO,OAAM;0CAAW;;;;;;;;;;;;kCAI3B,6LAAC;wBACC,SAAS,IAAM,gBAAgB,CAAC;wBAChC,WAAU;wBACV,gBAAc;wBACd,cAAW;;4BAEV,6BAAe,6LAAC,6MAAA,CAAA,SAAM;gCAAC,WAAU;;;;;qDAAe,6LAAC,mMAAA,CAAA,MAAG;gCAAC,WAAU;;;;;;4BAC/D,eAAe,SAAS;4BAAO;;;;;;;;;;;;;YAKnC,cAAc,MAAM,GAAG,mBACtB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAK,WAAU;;oCAAkC,cAAc,MAAM;oCAAC;;;;;;;0CACvE,6LAAC;gCAAO,SAAS,IAAM,iBAAiB,EAAE;gCAAG,WAAU;gCAAiC,cAAW;0CACjG,cAAA,6LAAC,+LAAA,CAAA,IAAC;oCAAC,WAAU;;;;;;;;;;;;;;;;;kCAGjB,6LAAC;wBACC,SAAS,IAAM,iBAAiB;wBAChC,WAAU;kCACX;;;;;;;;;;;;YAOJ,cAAc,MAAM,GAAG,mBACtB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;8BACZ,cAAc,GAAG,CAAC,CAAC,kBAClB,6LAAC;4BAAa,WAAU;sCACtB,cAAA,6LAAC,mJAAA,CAAA,uBAAoB;gCAAC,SAAS;gCAAG,sBAAsB;gCAAO,WAAU;;;;;;2BADhE;;;;;;;;;;;;;;;0BASnB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;;4BAAK;4BAAS,MAAM,OAAO,CAAC,kBAAkB,eAAe,MAAM,GAAG;4BAAE;;;;;;;oBACxE,MAAM,OAAO,CAAC,mBAAmB,eAAe,MAAM,GAAG,mBACxD,6LAAC;wBAAO,SAAS;wBAAiB,WAAU;kCACzC,cAAc,MAAM,KAAK,eAAe,MAAM,GAAG,iBAAiB;;;;;;;;;;;;;;;;;;AAM/E;KAtHwB","debugId":null}},
    {"offset": {"line": 633, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/admin/wallet/WalletUserList.tsx"],"sourcesContent":["// src/components/admin/wallet/WalletUserList.tsx\r\n'use client';\r\n\r\nimport { Users, UserCheck, UserX, CheckCircle } from 'lucide-react';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\ninterface User {\r\n  username: string;\r\n  role: string; // 'buyer' | 'seller' | 'admin' (fallback safe)\r\n}\r\n\r\ninterface WalletUserListProps {\r\n  displayedUsers: User[];\r\n  selectedUsers: string[];\r\n  selectedUser: string | null;\r\n  showBalances: boolean;\r\n  handleSelectUser: (username: string, role: string) => void;\r\n  handleBulkSelect: (username: string) => void;\r\n  getUserBalance: (username: string) => number;\r\n  getRoleBadgeColor: (role: string) => string;\r\n  getBalanceColor: (balance: number) => string;\r\n  formatRole: (role: string) => string;\r\n}\r\n\r\nexport default function WalletUserList({\r\n  displayedUsers = [],\r\n  selectedUsers = [],\r\n  selectedUser,\r\n  showBalances,\r\n  handleSelectUser,\r\n  handleBulkSelect,\r\n  getUserBalance,\r\n  getRoleBadgeColor,\r\n  getBalanceColor,\r\n  formatRole\r\n}: WalletUserListProps) {\r\n  if (!Array.isArray(displayedUsers) || displayedUsers.length === 0) {\r\n    return (\r\n      <div className=\"lg:col-span-2 bg-[#1a1a1a] rounded-xl border border-gray-800 shadow-lg\">\r\n        <div className=\"p-6 border-b border-gray-800\">\r\n          <h2 className=\"text-xl font-bold text-white flex items-center gap-2\">\r\n            <Users className=\"h-5 w-5 text-[#ff950e]\" />\r\n            User List\r\n          </h2>\r\n        </div>\r\n        <div className=\"p-8 text-center text-gray-400\">\r\n          <Users className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\r\n          <p>No users found matching your criteria</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const safeBalance = (u: string) => {\r\n    const n = Number(getUserBalance(u));\r\n    return Number.isFinite(n) ? n : 0;\r\n  };\r\n\r\n  return (\r\n    <div className=\"lg:col-span-2 bg-[#1a1a1a] rounded-xl border border-gray-800 shadow-lg\">\r\n      <div className=\"p-6 border-b border-gray-800\">\r\n        <h2 className=\"text-xl font-bold text-white flex items-center gap-2\">\r\n          <Users className=\"h-5 w-5 text-[#ff950e]\" />\r\n          User List\r\n        </h2>\r\n      </div>\r\n\r\n      <div className=\"max-h-96 overflow-y-auto\" role=\"list\" aria-label=\"Wallet users\">\r\n        <div className=\"space-y-1 p-2\">\r\n          {displayedUsers.map((user) => {\r\n            const uname = user?.username ?? '';\r\n            const role = user?.role ?? 'buyer';\r\n            const isSelected = selectedUser === uname;\r\n            const isBulkSelected = selectedUsers.includes(uname);\r\n            const balance = safeBalance(uname);\r\n\r\n            return (\r\n              <div\r\n                key={uname}\r\n                role=\"listitem\"\r\n                aria-selected={isSelected}\r\n                className={`p-3 rounded-lg transition-all cursor-pointer border ${\r\n                  isSelected\r\n                    ? 'bg-[#ff950e]/10 border-[#ff950e]/50'\r\n                    : isBulkSelected\r\n                    ? 'bg-blue-600/10 border-blue-600/50'\r\n                    : 'bg-black/30 border-transparent hover:bg-black/50 hover:border-gray-700'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div\r\n                    className=\"flex items-center gap-3 flex-1\"\r\n                    onClick={() => handleSelectUser(uname, role)}\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === 'Enter' || e.key === ' ') {\r\n                        e.preventDefault();\r\n                        handleSelectUser(uname, role);\r\n                      }\r\n                    }}\r\n                    role=\"button\"\r\n                    tabIndex={0}\r\n                    aria-label={`Select ${uname}`}\r\n                  >\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={isBulkSelected}\r\n                        onChange={() => handleBulkSelect(uname)}\r\n                        onClick={(e) => e.stopPropagation()}\r\n                        className=\"rounded border-gray-600 text-[#ff950e] focus:ring-[#ff950e] focus:ring-offset-0 bg-transparent\"\r\n                        aria-label={`Bulk select ${uname}`}\r\n                      />\r\n                      {role === 'buyer' ? (\r\n                        <UserCheck className=\"h-4 w-4 text-blue-400\" />\r\n                      ) : (\r\n                        <UserX className=\"h-4 w-4 text-green-400\" />\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"font-medium text-white truncate\">\r\n                          <SecureMessageDisplay content={uname} allowBasicFormatting={false} className=\"inline\" />\r\n                        </span>\r\n                        <span className={`px-2 py-1 rounded text-xs border ${getRoleBadgeColor(role)}`}>\r\n                          {formatRole(role)}\r\n                        </span>\r\n                      </div>\r\n                      {showBalances && (\r\n                        <div className=\"text-sm text-gray-400 mt-1\">\r\n                          Balance:{' '}\r\n                          <span className={getBalanceColor(balance)}>\r\n                            ${balance.toFixed(2)}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {isSelected && (\r\n                    <div className=\"text-[#ff950e]\" aria-hidden=\"true\">\r\n                      <CheckCircle className=\"h-5 w-5\" />\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 932, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/admin/wallet/WalletActionPanel.tsx"],"sourcesContent":["// src/components/admin/wallet/WalletActionPanel.tsx\r\n'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { DollarSign, ArrowUpRight, ArrowDownRight, UserCheck, Loader2 } from 'lucide-react';\r\nimport { SecureInput, SecureTextarea } from '@/components/ui/SecureInput';\r\nimport { sanitizeCurrency, sanitizeStrict } from '@/utils/security/sanitization';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\ninterface WalletActionPanelProps {\r\n  selectedUser: string | null;\r\n  selectedUserRole: 'buyer' | 'seller' | 'admin';\r\n  actionType: 'credit' | 'debit';\r\n  setActionType: (type: 'credit' | 'debit') => void;\r\n  amount: string;\r\n  setAmount: (amount: string) => void;\r\n  reason: string;\r\n  setReason: (reason: string) => void;\r\n  isLoading: boolean;\r\n  handleAction: () => void;\r\n  clearSelection: () => void;\r\n  getUserBalance: (username: string) => number;\r\n  getRoleBadgeColor: (role: string) => string;\r\n  getBalanceColor: (balance: number) => string;\r\n  formatRole: (role: string) => string;\r\n}\r\n\r\nexport default function WalletActionPanel({\r\n  selectedUser,\r\n  selectedUserRole,\r\n  actionType,\r\n  setActionType,\r\n  amount,\r\n  setAmount,\r\n  reason,\r\n  setReason,\r\n  isLoading,\r\n  handleAction,\r\n  clearSelection,\r\n  getUserBalance,\r\n  getRoleBadgeColor,\r\n  getBalanceColor,\r\n  formatRole\r\n}: WalletActionPanelProps) {\r\n  const [touched, setTouched] = useState({ amount: false, reason: false });\r\n\r\n  const handleSecureAmountChange = (value: string) => {\r\n    if (value === '') {\r\n      setAmount('');\r\n    } else {\r\n      const sanitized = sanitizeCurrency(value);\r\n      setAmount(sanitized.toString());\r\n    }\r\n  };\r\n\r\n  const canSubmit = Boolean(amount) && Boolean(sanitizeStrict(reason).trim()) && !isLoading;\r\n\r\n  return (\r\n    <div className=\"bg-[#1a1a1a] p-6 rounded-xl border border-gray-800 shadow-lg h-fit\">\r\n      <h2 className=\"text-xl font-bold mb-4 text-white flex items-center gap-2\">\r\n        <DollarSign className=\"h-5 w-5 text-[#ff950e]\" />\r\n        Wallet Actions\r\n      </h2>\r\n\r\n      {selectedUser ? (\r\n        <div className=\"space-y-4\">\r\n          {/* Selected User Info */}\r\n          <div className=\"bg-black/30 p-4 rounded-lg\">\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n              <span className=\"font-medium text-white\">\r\n                <SecureMessageDisplay content={selectedUser} allowBasicFormatting={false} className=\"inline\" />\r\n              </span>\r\n              <span className={`px-2 py-1 rounded text-xs border ${getRoleBadgeColor(selectedUserRole)}`}>\r\n                {formatRole(selectedUserRole)}\r\n              </span>\r\n            </div>\r\n            <div className=\"text-sm text-gray-400\">\r\n              Current Balance:{' '}\r\n              <span className={getBalanceColor(getUserBalance(selectedUser))}>\r\n                ${Number(getUserBalance(selectedUser)).toFixed(2)}\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Action Type */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-300 mb-2\">Action Type</label>\r\n            <div className=\"flex gap-2\">\r\n              <button\r\n                onClick={() => setActionType('credit')}\r\n                className={`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2 ${\r\n                  actionType === 'credit' ? 'bg-green-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n                }`}\r\n                aria-pressed={actionType === 'credit'}\r\n              >\r\n                <ArrowUpRight className=\"h-4 w-4\" />\r\n                Credit\r\n              </button>\r\n              <button\r\n                onClick={() => setActionType('debit')}\r\n                className={`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2 ${\r\n                  actionType === 'debit' ? 'bg-red-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n                }`}\r\n                aria-pressed={actionType === 'debit'}\r\n              >\r\n                <ArrowDownRight className=\"h-4 w-4\" />\r\n                Debit\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Amount */}\r\n          <div>\r\n            <SecureInput\r\n              label=\"Amount ($)\"\r\n              type=\"number\"\r\n              value={amount}\r\n              onChange={handleSecureAmountChange}\r\n              onBlur={() => setTouched((prev) => ({ ...prev, amount: true }))}\r\n              step=\"0.01\"\r\n              min=\"0\"\r\n              max=\"999999.99\"\r\n              className=\"w-full px-3 py-2 bg-black/50 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-[#ff950e]\"\r\n              placeholder=\"0.00\"\r\n              touched={touched.amount}\r\n              sanitize={false}\r\n            />\r\n          </div>\r\n\r\n          {/* Reason */}\r\n          <div>\r\n            <SecureTextarea\r\n              label=\"Reason\"\r\n              value={reason}\r\n              onChange={setReason}\r\n              onBlur={() => setTouched((prev) => ({ ...prev, reason: true }))}\r\n              className=\"w-full px-3 py-2 bg-black/50 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-[#ff950e] resize-none\"\r\n              rows={3}\r\n              placeholder=\"Reason for this action...\"\r\n              maxLength={500}\r\n              characterCount={true}\r\n              touched={touched.reason}\r\n              sanitize={true}\r\n              sanitizer={sanitizeStrict}\r\n            />\r\n          </div>\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex gap-3\">\r\n            <button\r\n              onClick={() => {\r\n                clearSelection();\r\n                setTouched({ amount: false, reason: false });\r\n              }}\r\n              className=\"flex-1 py-2 px-4 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors\"\r\n            >\r\n              Clear\r\n            </button>\r\n            <button\r\n              onClick={handleAction}\r\n              disabled={!canSubmit}\r\n              className=\"flex-1 py-2 px-4 bg-[#ff950e] hover:bg-[#ff6b00] disabled:bg-gray-600 disabled:cursor-not-allowed text-black disabled:text-gray-400 rounded-lg transition-colors font-medium flex items-center justify-center gap-2\"\r\n            >\r\n              {isLoading && <Loader2 className=\"h-4 w-4 animate-spin\" />}\r\n              {actionType === 'credit' ? 'Credit' : 'Debit'} Account\r\n            </button>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <div className=\"text-center py-8\">\r\n          <UserCheck className=\"h-12 w-12 text-gray-600 mx-auto mb-4\" />\r\n          <p className=\"text-gray-400 mb-2\">No user selected</p>\r\n          <p className=\"text-sm text-gray-500\">Select a user from the list to manage their wallet</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1275, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/ui/SecureForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { FormEvent, useState, useEffect } from 'react';\r\nimport { AlertCircle, ShieldCheck, Loader2 } from 'lucide-react';\r\nimport { getRateLimiter, getRateLimitMessage } from '@/utils/security/rate-limiter';\r\n\r\ninterface SecureFormProps {\r\n  children: React.ReactNode;\r\n  onSubmit: (e: FormEvent) => Promise<void> | void;\r\n  className?: string;\r\n  rateLimitKey?: string;\r\n  rateLimitConfig?: { maxAttempts: number; windowMs: number };\r\n  showSecurityBadge?: boolean;\r\n  csrfProtection?: boolean;\r\n  isRateLimited?: boolean;\r\n  rateLimitWaitTime?: number;\r\n}\r\n\r\n/**\r\n * Secure form wrapper with CSRF protection and rate limiting\r\n */\r\nexport const SecureForm: React.FC<SecureFormProps> = ({\r\n  children,\r\n  onSubmit,\r\n  className = '',\r\n  rateLimitKey,\r\n  rateLimitConfig,\r\n  showSecurityBadge = false,\r\n  csrfProtection = true,\r\n  isRateLimited = false,\r\n  rateLimitWaitTime = 0,\r\n}) => {\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [rateLimitError, setRateLimitError] = useState<string | null>(null);\r\n  const [csrfToken, setCsrfToken] = useState<string>('');\r\n\r\n  // Initialize CSRF token\r\n  useEffect(() => {\r\n    if (csrfProtection && typeof window !== 'undefined') {\r\n      const tokenManager = new CSRFTokenManager();\r\n      const token = tokenManager.generateToken();\r\n      setCsrfToken(token);\r\n    }\r\n  }, [csrfProtection]);\r\n\r\n  // Update rate limit error when props change\r\n  useEffect(() => {\r\n    if (isRateLimited && rateLimitWaitTime > 0) {\r\n      setRateLimitError(\r\n        `Too many attempts. Please wait ${rateLimitWaitTime} seconds before trying again.`\r\n      );\r\n    } else {\r\n      setRateLimitError(null);\r\n    }\r\n  }, [isRateLimited, rateLimitWaitTime]);\r\n\r\n  const handleSubmit = async (e: FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    // Don't submit if externally rate limited\r\n    if (isRateLimited) {\r\n      return;\r\n    }\r\n\r\n    // Clear previous errors\r\n    setRateLimitError(null);\r\n\r\n    // Check rate limit if configured and not already checked externally\r\n    if (rateLimitKey && rateLimitConfig && !isRateLimited) {\r\n      const limiter = getRateLimiter();\r\n      const result = limiter.check(rateLimitKey, rateLimitConfig);\r\n\r\n      if (!result.allowed) {\r\n        setRateLimitError(getRateLimitMessage(result));\r\n        return;\r\n      }\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    try {\r\n      await onSubmit(e);\r\n    } catch (error) {\r\n      console.error('Form submission error:', error);\r\n\r\n      // If it's a rate limit error, reset the attempt\r\n      if (rateLimitKey && error instanceof Error && error.message.includes('Rate limit')) {\r\n        const limiter = getRateLimiter();\r\n        limiter.reset(rateLimitKey);\r\n      }\r\n\r\n      throw error;\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className={className} noValidate>\r\n      {/* CSRF Token (hidden) */}\r\n      {csrfProtection && csrfToken && <input type=\"hidden\" name=\"_csrf\" value={csrfToken} />}\r\n\r\n      {/* Security Badge */}\r\n      {showSecurityBadge && (\r\n        <div className=\"mb-4 flex items-center gap-2 text-xs text-gray-500\">\r\n          <ShieldCheck className=\"w-4 h-4\" />\r\n          <span>Secure form with protection against attacks</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Rate Limit Error - only show if not handled externally */}\r\n      {rateLimitError && !isRateLimited && (\r\n        <div className=\"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg\">\r\n          <div className=\"flex items-center gap-2 text-sm text-red-400\">\r\n            <AlertCircle className=\"w-4 h-4 flex-shrink-0\" />\r\n            <span>{rateLimitError}</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Form Content */}\r\n      {children}\r\n    </form>\r\n  );\r\n};\r\n\r\n/**\r\n * Field wrapper for consistent styling and error handling\r\n */\r\ninterface SecureFieldWrapperProps {\r\n  children: React.ReactNode;\r\n  error?: string;\r\n  touched?: boolean;\r\n  className?: string;\r\n}\r\n\r\nexport const SecureFieldWrapper: React.FC<SecureFieldWrapperProps> = ({\r\n  children,\r\n  error,\r\n  touched,\r\n  className = '',\r\n}) => (\r\n  <div className={className}>\r\n    {children}\r\n    {touched && error && (\r\n      <div className=\"mt-1 flex items-center gap-1 text-xs text-red-400\">\r\n        <AlertCircle className=\"w-3 h-3 flex-shrink-0\" />\r\n        <span>{error}</span>\r\n      </div>\r\n    )}\r\n  </div>\r\n);\r\n\r\n/**\r\n * Secure submit button with loading state\r\n */\r\ninterface SecureSubmitButtonProps {\r\n  children: React.ReactNode;\r\n  isLoading?: boolean;\r\n  isDisabled?: boolean;\r\n  className?: string;\r\n  loadingText?: string;\r\n  type?: 'submit' | 'button';\r\n  disabled?: boolean;\r\n}\r\n\r\nexport const SecureSubmitButton: React.FC<SecureSubmitButtonProps> = ({\r\n  children,\r\n  isLoading = false,\r\n  isDisabled = false,\r\n  disabled = false,\r\n  className = '',\r\n  loadingText = 'Processing...',\r\n  type = 'submit',\r\n}) => (\r\n  <button\r\n    type={type}\r\n    disabled={isLoading || isDisabled || disabled}\r\n    className={`relative ${className} ${\r\n      isLoading || isDisabled || disabled ? 'opacity-50 cursor-not-allowed' : ''\r\n    }`}\r\n  >\r\n    {isLoading ? (\r\n      <span className=\"flex items-center justify-center gap-2\">\r\n        <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n        {loadingText}\r\n      </span>\r\n    ) : (\r\n      children\r\n    )}\r\n  </button>\r\n);\r\n\r\n/**\r\n * CSRF Token Manager for form protection\r\n */\r\nclass CSRFTokenManager {\r\n  private tokenKey = 'csrf_token';\r\n  private tokenExpiry = 60 * 60 * 1000; // 1 hour\r\n\r\n  generateToken(): string {\r\n    const token = this.createSecureToken();\r\n    const expiry = Date.now() + this.tokenExpiry;\r\n\r\n    if (typeof window !== 'undefined') {\r\n      sessionStorage.setItem(this.tokenKey, JSON.stringify({ token, expiry }));\r\n    }\r\n\r\n    return token;\r\n  }\r\n\r\n  validateToken(token: string): boolean {\r\n    if (typeof window === 'undefined') return false;\r\n\r\n    try {\r\n      const stored = sessionStorage.getItem(this.tokenKey);\r\n      if (!stored) return false;\r\n\r\n      const { token: storedToken, expiry } = JSON.parse(stored);\r\n\r\n      if (Date.now() > expiry) {\r\n        sessionStorage.removeItem(this.tokenKey);\r\n        return false;\r\n      }\r\n\r\n      return token === storedToken;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private createSecureToken(): string {\r\n    const array = new Uint8Array(32);\r\n    crypto.getRandomValues(array);\r\n    return Array.from(array, (byte) => byte.toString(16).padStart(2, '0')).join('');\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1554, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/admin/wallet/BulkActionModal.tsx"],"sourcesContent":["// src/components/admin/wallet/BulkActionModal.tsx\r\n'use client';\r\n\r\nimport { X, Loader2 } from 'lucide-react';\r\nimport { useState } from 'react';\r\nimport { SecureInput, SecureTextarea } from '@/components/ui/SecureInput';\r\nimport { SecureForm } from '@/components/ui/SecureForm';\r\nimport { sanitizeCurrency, sanitizeStrict } from '@/utils/security/sanitization';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\ninterface BulkActionModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  selectedUsers: string[];\r\n  onAction: (action: 'credit' | 'debit', amount: number, reason: string) => void | Promise<void>;\r\n  isLoading?: boolean;\r\n}\r\n\r\nexport default function BulkActionModal({\r\n  isOpen,\r\n  onClose,\r\n  selectedUsers = [],\r\n  onAction,\r\n  isLoading = false\r\n}: BulkActionModalProps) {\r\n  const [actionType, setActionType] = useState<'credit' | 'debit'>('credit');\r\n  const [amount, setAmount] = useState('');\r\n  const [reason, setReason] = useState('');\r\n  const [touched, setTouched] = useState({ amount: false, reason: false });\r\n  const [errors, setErrors] = useState<{ amount?: string; reason?: string }>({});\r\n\r\n  if (!isOpen) return null;\r\n\r\n  // Handle secure amount change\r\n  const handleSecureAmountChange = (value: string) => {\r\n    if (value === '') {\r\n      setAmount('');\r\n      return;\r\n    }\r\n    const sanitized = sanitizeCurrency(value);\r\n    setAmount(sanitized.toString());\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setErrors({});\r\n\r\n    const numAmount = parseFloat(amount);\r\n    const sanitizedReason = sanitizeStrict(reason).trim();\r\n    const validationErrors: typeof errors = {};\r\n\r\n    if (!Number.isFinite(numAmount) || numAmount <= 0) {\r\n      validationErrors.amount = 'Please enter a valid amount greater than 0';\r\n    }\r\n\r\n    if (!sanitizedReason) {\r\n      validationErrors.reason = 'Please provide a reason';\r\n    }\r\n\r\n    if (Object.keys(validationErrors).length > 0) {\r\n      setErrors(validationErrors);\r\n      setTouched({ amount: true, reason: true });\r\n      return;\r\n    }\r\n\r\n    await onAction(actionType, numAmount, sanitizedReason);\r\n\r\n    // Reset form on success\r\n    setAmount('');\r\n    setReason('');\r\n    setTouched({ amount: false, reason: false });\r\n  };\r\n\r\n  const handleClose = () => {\r\n    // Reset form when closing\r\n    setAmount('');\r\n    setReason('');\r\n    setTouched({ amount: false, reason: false });\r\n    setErrors({});\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Bulk wallet action\">\r\n      <div className=\"bg-[#1a1a1a] border border-gray-800 rounded-xl p-6 max-w-md w-full shadow-xl\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"text-lg font-semibold text-white\">Bulk Action</h3>\r\n          <button onClick={handleClose} className=\"text-gray-400 hover:text-white\" aria-label=\"Close\">\r\n            <X className=\"h-5 w-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"mb-4\">\r\n          <p className=\"text-sm text-gray-300 mb-2\">Selected Users: {selectedUsers.length}</p>\r\n          <div className=\"max-h-20 overflow-y-auto bg-black/30 rounded-lg p-2\">\r\n            {selectedUsers.map((user) => (\r\n              <span key={user} className=\"inline-block bg-[#ff950e]/20 text-[#ff950e] px-2 py-1 rounded text-xs mr-1 mb-1\">\r\n                <SecureMessageDisplay content={user} allowBasicFormatting={false} className=\"inline\" />\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <SecureForm onSubmit={handleSubmit} rateLimitKey=\"bulk_wallet_action\" rateLimitConfig={{ maxAttempts: 10, windowMs: 60 * 1000 }}>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-300 mb-2\">Action Type</label>\r\n              <div className=\"flex gap-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setActionType('credit')}\r\n                  className={`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors ${\r\n                    actionType === 'credit' ? 'bg-green-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n                  }`}\r\n                  aria-pressed={actionType === 'credit'}\r\n                >\r\n                  Credit\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setActionType('debit')}\r\n                  className={`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors ${\r\n                    actionType === 'debit' ? 'bg-red-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\r\n                  }`}\r\n                  aria-pressed={actionType === 'debit'}\r\n                >\r\n                  Debit\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <SecureInput\r\n                label=\"Amount ($)\"\r\n                type=\"number\"\r\n                value={amount}\r\n                onChange={handleSecureAmountChange}\r\n                onBlur={() => setTouched((prev) => ({ ...prev, amount: true }))}\r\n                step=\"0.01\"\r\n                min=\"0\"\r\n                max=\"999999.99\"\r\n                className=\"w-full px-3 py-2 bg-black/50 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-[#ff950e]\"\r\n                placeholder=\"0.00\"\r\n                error={errors.amount}\r\n                touched={touched.amount}\r\n                sanitize={false}\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <SecureTextarea\r\n                label=\"Reason\"\r\n                value={reason}\r\n                onChange={setReason}\r\n                onBlur={() => setTouched((prev) => ({ ...prev, reason: true }))}\r\n                className=\"w-full px-3 py-2 bg-black/50 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-[#ff950e] resize-none\"\r\n                rows={3}\r\n                placeholder=\"Reason for this action...\"\r\n                maxLength={500}\r\n                characterCount={true}\r\n                error={errors.reason}\r\n                touched={touched.reason}\r\n                sanitize={true}\r\n                sanitizer={sanitizeStrict}\r\n                required\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex gap-3 justify-end mt-6\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleClose}\r\n              disabled={isLoading}\r\n              className=\"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              disabled={isLoading || !amount || !sanitizeStrict(reason).trim()}\r\n              className=\"px-4 py-2 bg-[#ff950e] hover:bg-[#ff6b00] text-black rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50\"\r\n            >\r\n              {isLoading && <Loader2 className=\"h-4 w-4 animate-spin\" />}\r\n              Apply to {selectedUsers.length} {selectedUsers.length === 1 ? 'user' : 'users'}\r\n            </button>\r\n          </div>\r\n        </SecureForm>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1915, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/admin/wallet/ConfirmationModal.tsx"],"sourcesContent":["// src/components/admin/wallet/ConfirmationModal.tsx\r\n'use client';\r\n\r\nimport { AlertTriangle, XCircle, Info, Loader2 } from 'lucide-react';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\ninterface ConfirmationModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onConfirm: () => void;\r\n  title: string;\r\n  message: string;\r\n  type?: 'warning' | 'danger' | 'info';\r\n  isLoading?: boolean;\r\n}\r\n\r\nexport default function ConfirmationModal({\r\n  isOpen,\r\n  onClose,\r\n  onConfirm,\r\n  title,\r\n  message,\r\n  type = 'warning',\r\n  isLoading = false\r\n}: ConfirmationModalProps) {\r\n  if (!isOpen) return null;\r\n\r\n  const getIcon = () => {\r\n    switch (type) {\r\n      case 'danger':\r\n        return <XCircle className=\"h-6 w-6 text-red-500\" />;\r\n      case 'info':\r\n        return <Info className=\"h-6 w-6 text-blue-500\" />;\r\n      default:\r\n        return <AlertTriangle className=\"h-6 w-6 text-orange-500\" />;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\" role=\"dialog\" aria-modal=\"true\">\r\n      <div className=\"bg-[#1a1a1a] border border-gray-800 rounded-xl p-6 max-w-md w-full shadow-xl\">\r\n        <div className=\"flex items-center gap-3 mb-4\">\r\n          {getIcon()}\r\n          <h3 className=\"text-lg font-semibold text-white\">\r\n            <SecureMessageDisplay content={title} allowBasicFormatting={false} className=\"inline\" />\r\n          </h3>\r\n        </div>\r\n        <div className=\"text-gray-300 mb-6\">\r\n          <SecureMessageDisplay content={message} allowBasicFormatting={false} />\r\n        </div>\r\n        <div className=\"flex gap-3 justify-end\">\r\n          <button\r\n            onClick={onClose}\r\n            disabled={isLoading}\r\n            className=\"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors disabled:opacity-50\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={onConfirm}\r\n            disabled={isLoading}\r\n            className={`px-4 py-2 ${type === 'danger' ? 'bg-red-600 hover:bg-red-700' : type === 'info' ? 'bg-blue-600 hover:bg-blue-700' : 'bg-orange-600 hover:bg-orange-700'} text-white rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50`}\r\n          >\r\n            {isLoading && <Loader2 className=\"h-4 w-4 animate-spin\" />}\r\n            Confirm\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,oDAAoD;;;;;AAGpD;AAAA;AAAA;AAAA;AACA;AAHA;;;;AAee,SAAS,kBAAkB,KAQjB;QARiB,EACxC,MAAM,EACN,OAAO,EACP,SAAS,EACT,KAAK,EACL,OAAO,EACP,OAAO,SAAS,EAChB,YAAY,KAAK,EACM,GARiB;IASxC,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,UAAU;QACd,OAAQ;YACN,KAAK;gBACH,qBAAO,6LAAC,+MAAA,CAAA,UAAO;oBAAC,WAAU;;;;;;YAC5B,KAAK;gBACH,qBAAO,6LAAC,qMAAA,CAAA,OAAI;oBAAC,WAAU;;;;;;YACzB;gBACE,qBAAO,6LAAC,2NAAA,CAAA,gBAAa;oBAAC,WAAU;;;;;;QACpC;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;QAAuF,MAAK;QAAS,cAAW;kBAC7H,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;wBACZ;sCACD,6LAAC;4BAAG,WAAU;sCACZ,cAAA,6LAAC,mJAAA,CAAA,uBAAoB;gCAAC,SAAS;gCAAO,sBAAsB;gCAAO,WAAU;;;;;;;;;;;;;;;;;8BAGjF,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,mJAAA,CAAA,uBAAoB;wBAAC,SAAS;wBAAS,sBAAsB;;;;;;;;;;;8BAEhE,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BACC,SAAS;4BACT,UAAU;4BACV,WAAU;sCACX;;;;;;sCAGD,6LAAC;4BACC,SAAS;4BACT,UAAU;4BACV,WAAW,AAAC,aAAwJ,OAA5I,SAAS,WAAW,gCAAgC,SAAS,SAAS,kCAAkC,qCAAoC;;gCAEnK,2BAAa,6LAAC,oNAAA,CAAA,UAAO;oCAAC,WAAU;;;;;;gCAA0B;;;;;;;;;;;;;;;;;;;;;;;;AAOvE;KAtDwB","debugId":null}},
    {"offset": {"line": 2070, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/admin/wallet/WalletToast.tsx"],"sourcesContent":["// src/components/admin/wallet/WalletToast.tsx\r\n'use client';\r\n\r\nimport { CheckCircle, XCircle } from 'lucide-react';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\ninterface WalletToastProps {\r\n  message: string;\r\n  type: 'success' | 'error';\r\n  isVisible: boolean;\r\n}\r\n\r\nexport default function WalletToast({ message, type, isVisible }: WalletToastProps) {\r\n  if (!isVisible) return null;\r\n\r\n  const isError = type === 'error';\r\n\r\n  return (\r\n    <div\r\n      className=\"fixed bottom-4 right-4 z-40\"\r\n      aria-live={isError ? 'assertive' : 'polite'}\r\n      aria-atomic=\"true\"\r\n    >\r\n      <div\r\n        role={isError ? 'alert' : 'status'}\r\n        className={`flex items-center gap-3 px-4 py-3 rounded-lg shadow-lg transition-all duration-300 ${\r\n          isError ? 'bg-red-600 text-white' : 'bg-green-600 text-white'\r\n        }`}\r\n      >\r\n        {isError ? <XCircle className=\"h-5 w-5\" /> : <CheckCircle className=\"h-5 w-5\" />}\r\n        <div className=\"text-sm font-medium\">\r\n          <SecureMessageDisplay\r\n            content={message || ''}\r\n            allowBasicFormatting={false}\r\n            className=\"inline\"\r\n            maxLength={300}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,8CAA8C;;;;;AAG9C;AAAA;AACA;AAHA;;;;AAWe,SAAS,YAAY,KAA8C;QAA9C,EAAE,OAAO,EAAE,IAAI,EAAE,SAAS,EAAoB,GAA9C;IAClC,IAAI,CAAC,WAAW,OAAO;IAEvB,MAAM,UAAU,SAAS;IAEzB,qBACE,6LAAC;QACC,WAAU;QACV,aAAW,UAAU,cAAc;QACnC,eAAY;kBAEZ,cAAA,6LAAC;YACC,MAAM,UAAU,UAAU;YAC1B,WAAW,AAAC,sFAEX,OADC,UAAU,0BAA0B;;gBAGrC,wBAAU,6LAAC,+MAAA,CAAA,UAAO;oBAAC,WAAU;;;;;yCAAe,6LAAC,8NAAA,CAAA,cAAW;oBAAC,WAAU;;;;;;8BACpE,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,mJAAA,CAAA,uBAAoB;wBACnB,SAAS,WAAW;wBACpB,sBAAsB;wBACtB,WAAU;wBACV,WAAW;;;;;;;;;;;;;;;;;;;;;;AAMvB;KA7BwB","debugId":null}},
    {"offset": {"line": 2148, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/utils/walletSync.ts"],"sourcesContent":["// src/utils/walletSync.ts\r\n\r\nimport { storageService } from '@/services/storage.service';\r\nimport { WebSocketEvent } from '@/types/websocket';\r\n\r\n/**\r\n * Force sync wallet balances between enhanced service and WalletContext\r\n * This ensures both storage mechanisms stay in sync\r\n */\r\nexport async function forceSyncWalletBalance(username: string): Promise<void> {\r\n  try {\r\n    console.log('[ForceSync] Starting wallet sync for:', username);\r\n    \r\n    // Get balance from enhanced service (in cents)\r\n    const balanceKey = `wallet_buyer_${username}`;\r\n    const balanceInCents = localStorage.getItem(balanceKey);\r\n    console.log('[ForceSync] Balance in cents from storage:', balanceInCents);\r\n    \r\n    if (balanceInCents !== null) {\r\n      const balanceInDollars = parseInt(balanceInCents) / 100;\r\n      console.log('[ForceSync] Balance in dollars:', balanceInDollars);\r\n      \r\n      // Update wallet_buyers object\r\n      const buyersJson = localStorage.getItem('wallet_buyers') || '{}';\r\n      const buyers = JSON.parse(buyersJson);\r\n      buyers[username] = balanceInDollars;\r\n      localStorage.setItem('wallet_buyers', JSON.stringify(buyers));\r\n      console.log('[ForceSync] Updated wallet_buyers:', buyers);\r\n      \r\n      // Force a storage event to trigger WalletContext update\r\n      window.dispatchEvent(new StorageEvent('storage', {\r\n        key: 'wallet_buyers',\r\n        newValue: JSON.stringify(buyers),\r\n        url: window.location.href\r\n      }));\r\n      console.log('[ForceSync] Dispatched storage event');\r\n      \r\n      // Also trigger global balance update\r\n      if (typeof window !== 'undefined' && (window as any).__pantypost_balance_context?.forceUpdate) {\r\n        (window as any).__pantypost_balance_context.forceUpdate();\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.error('[ForceSync] Error syncing wallet:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Enhanced sync that updates all storage formats and triggers events\r\n */\r\nexport async function enhancedWalletSync(\r\n  username: string, \r\n  role: 'buyer' | 'seller', \r\n  newBalance: number\r\n): Promise<void> {\r\n  try {\r\n    console.log('[EnhancedSync] Syncing wallet for:', { username, role, newBalance });\r\n    \r\n    // Update individual key (in cents)\r\n    const balanceInCents = Math.round(newBalance * 100);\r\n    const individualKey = `wallet_${role}_${username}`;\r\n    localStorage.setItem(individualKey, balanceInCents.toString());\r\n    \r\n    // Update collective storage\r\n    const collectiveKey = role === 'buyer' ? 'wallet_buyers' : 'wallet_sellers';\r\n    const collectiveData = JSON.parse(localStorage.getItem(collectiveKey) || '{}');\r\n    \r\n    // FIXED: Always store seller balance as a number, not an object\r\n    collectiveData[username] = newBalance;\r\n    \r\n    localStorage.setItem(collectiveKey, JSON.stringify(collectiveData));\r\n    \r\n    // Dispatch storage event for cross-tab sync\r\n    window.dispatchEvent(new StorageEvent('storage', {\r\n      key: collectiveKey,\r\n      newValue: JSON.stringify(collectiveData),\r\n      url: window.location.href\r\n    }));\r\n    \r\n    // Trigger global update\r\n    if (typeof window !== 'undefined' && (window as any).__pantypost_balance_context?.forceUpdate) {\r\n      (window as any).__pantypost_balance_context.forceUpdate();\r\n    }\r\n    \r\n    // Emit custom event for immediate local updates\r\n    window.dispatchEvent(new CustomEvent('wallet-balance-updated', {\r\n      detail: { username, role, balance: newBalance }\r\n    }));\r\n    \r\n    console.log('[EnhancedSync] Sync completed successfully');\r\n  } catch (error) {\r\n    console.error('[EnhancedSync] Error:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Subscribe to wallet balance updates\r\n */\r\nexport function subscribeToWalletUpdates(\r\n  callback: (data: { username: string; role: string; balance: number }) => void\r\n): () => void {\r\n  const handleUpdate = (event: Event) => {\r\n    if (event instanceof CustomEvent) {\r\n      callback(event.detail);\r\n    }\r\n  };\r\n  \r\n  window.addEventListener('wallet-balance-updated', handleUpdate);\r\n  \r\n  // Return unsubscribe function\r\n  return () => {\r\n    window.removeEventListener('wallet-balance-updated', handleUpdate);\r\n  };\r\n}\r\n\r\n/**\r\n * Sync all wallet data across storage formats\r\n */\r\nexport async function syncAllWalletData(): Promise<void> {\r\n  try {\r\n    console.log('[SyncAll] Starting full wallet sync');\r\n    \r\n    // Sync buyer balances\r\n    const buyerBalances = await storageService.getItem<Record<string, number>>('wallet_buyers', {});\r\n    for (const [username, balance] of Object.entries(buyerBalances)) {\r\n      const balanceInCents = Math.round(balance * 100);\r\n      await storageService.setItem(`wallet_buyer_${username}`, balanceInCents);\r\n    }\r\n    \r\n    // Sync seller balances - FIXED to handle both number and object formats\r\n    const sellerBalances = await storageService.getItem<Record<string, any>>('wallet_sellers', {});\r\n    for (const [username, data] of Object.entries(sellerBalances)) {\r\n      let balance = 0;\r\n      \r\n      // Handle both number and object formats\r\n      if (typeof data === 'number' && !isNaN(data)) {\r\n        balance = data;\r\n      } else if (data && typeof data === 'object' && 'balance' in data) {\r\n        const objBalance = data.balance;\r\n        if (typeof objBalance === 'number' && !isNaN(objBalance)) {\r\n          balance = objBalance;\r\n        }\r\n      }\r\n      \r\n      const balanceInCents = Math.round(balance * 100);\r\n      await storageService.setItem(`wallet_seller_${username}`, balanceInCents);\r\n      \r\n      // Also fix the collective storage to be a number\r\n      sellerBalances[username] = balance;\r\n    }\r\n    \r\n    // Save the fixed seller balances back\r\n    await storageService.setItem('wallet_sellers', sellerBalances);\r\n    \r\n    console.log('[SyncAll] Full sync completed');\r\n  } catch (error) {\r\n    console.error('[SyncAll] Error:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Real-time balance listener for components\r\n */\r\nexport class WalletBalanceListener {\r\n  private listeners: Map<string, Set<(balance: number) => void>> = new Map();\r\n  private currentBalances: Map<string, number> = new Map();\r\n  private pollInterval: NodeJS.Timeout | null = null;\r\n  \r\n  constructor() {\r\n    this.startPolling();\r\n    this.setupEventListeners();\r\n  }\r\n  \r\n  private startPolling() {\r\n    // Poll for balance changes every 2 seconds\r\n    this.pollInterval = setInterval(() => {\r\n      this.checkForBalanceChanges();\r\n    }, 2000);\r\n  }\r\n  \r\n  private setupEventListeners() {\r\n    // Listen for storage events\r\n    window.addEventListener('storage', this.handleStorageChange.bind(this));\r\n    \r\n    // Listen for custom wallet update events\r\n    window.addEventListener('wallet-balance-updated', this.handleWalletUpdate.bind(this));\r\n  }\r\n  \r\n  private handleStorageChange(event: StorageEvent) {\r\n    if (event.key === 'wallet_buyers' || event.key === 'wallet_sellers') {\r\n      this.checkForBalanceChanges();\r\n    }\r\n  }\r\n  \r\n  private handleWalletUpdate(event: Event) {\r\n    if (event instanceof CustomEvent) {\r\n      const { username, role, balance } = event.detail;\r\n      const key = `${role}_${username}`;\r\n      this.notifyListeners(key, balance);\r\n    }\r\n  }\r\n  \r\n  private async checkForBalanceChanges() {\r\n    try {\r\n      // Check buyer balances\r\n      const buyers = JSON.parse(localStorage.getItem('wallet_buyers') || '{}');\r\n      for (const [username, balance] of Object.entries(buyers)) {\r\n        const key = `buyer_${username}`;\r\n        const currentBalance = this.currentBalances.get(key);\r\n        if (currentBalance !== balance) {\r\n          this.currentBalances.set(key, balance as number);\r\n          this.notifyListeners(key, balance as number);\r\n        }\r\n      }\r\n      \r\n      // Check seller balances - FIXED to handle both number and object formats\r\n      const sellers = JSON.parse(localStorage.getItem('wallet_sellers') || '{}');\r\n      for (const [username, data] of Object.entries(sellers)) {\r\n        let balance = 0;\r\n        \r\n        // Handle both number and object formats\r\n        if (typeof data === 'number' && !isNaN(data)) {\r\n          balance = data;\r\n        } else if (data && typeof data === 'object' && 'balance' in (data as any)) {\r\n          const objBalance = (data as any).balance;\r\n          if (typeof objBalance === 'number' && !isNaN(objBalance)) {\r\n            balance = objBalance;\r\n          }\r\n        }\r\n        \r\n        const key = `seller_${username}`;\r\n        const currentBalance = this.currentBalances.get(key);\r\n        if (currentBalance !== balance) {\r\n          this.currentBalances.set(key, balance);\r\n          this.notifyListeners(key, balance);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('[WalletBalanceListener] Error checking balances:', error);\r\n    }\r\n  }\r\n  \r\n  private notifyListeners(key: string, balance: number) {\r\n    const listeners = this.listeners.get(key);\r\n    if (listeners) {\r\n      listeners.forEach(callback => {\r\n        try {\r\n          callback(balance);\r\n        } catch (error) {\r\n          console.error('[WalletBalanceListener] Error in callback:', error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  \r\n  subscribe(username: string, role: 'buyer' | 'seller', callback: (balance: number) => void): () => void {\r\n    const key = `${role}_${username}`;\r\n    \r\n    if (!this.listeners.has(key)) {\r\n      this.listeners.set(key, new Set());\r\n    }\r\n    \r\n    this.listeners.get(key)!.add(callback);\r\n    \r\n    // Immediately call with current balance\r\n    const currentBalance = this.currentBalances.get(key) || 0;\r\n    callback(currentBalance);\r\n    \r\n    // Return unsubscribe function\r\n    return () => {\r\n      const listeners = this.listeners.get(key);\r\n      if (listeners) {\r\n        listeners.delete(callback);\r\n        if (listeners.size === 0) {\r\n          this.listeners.delete(key);\r\n        }\r\n      }\r\n    };\r\n  }\r\n  \r\n  destroy() {\r\n    if (this.pollInterval) {\r\n      clearInterval(this.pollInterval);\r\n    }\r\n    window.removeEventListener('storage', this.handleStorageChange.bind(this));\r\n    window.removeEventListener('wallet-balance-updated', this.handleWalletUpdate.bind(this));\r\n    this.listeners.clear();\r\n    this.currentBalances.clear();\r\n  }\r\n}\r\n\r\n// Create a singleton instance\r\nlet balanceListenerInstance: WalletBalanceListener | null = null;\r\n\r\nexport function getWalletBalanceListener(): WalletBalanceListener {\r\n  if (!balanceListenerInstance) {\r\n    balanceListenerInstance = new WalletBalanceListener();\r\n  }\r\n  return balanceListenerInstance;\r\n}\r\n\r\n// Add to window for easy testing\r\nif (typeof window !== 'undefined') {\r\n  (window as any).forceSyncWalletBalance = forceSyncWalletBalance;\r\n  (window as any).enhancedWalletSync = enhancedWalletSync;\r\n  (window as any).syncAllWalletData = syncAllWalletData;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2414, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/app/admin/wallet-management/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useListings } from '@/context/ListingContext';\r\nimport RequireAuth from '@/components/RequireAuth';\r\nimport WalletHeader from '@/components/admin/wallet/WalletHeader';\r\nimport WalletFilters from '@/components/admin/wallet/WalletFilters';\r\nimport WalletUserList from '@/components/admin/wallet/WalletUserList';\r\nimport WalletActionPanel from '@/components/admin/wallet/WalletActionPanel';\r\nimport BulkActionModal from '@/components/admin/wallet/BulkActionModal';\r\nimport ConfirmationModal from '@/components/admin/wallet/ConfirmationModal';\r\nimport WalletToast from '@/components/admin/wallet/WalletToast';\r\nimport { Loader2 } from 'lucide-react';\r\nimport { WalletProvider, useWallet } from '@/context/WalletContext';\r\nimport { useWebSocket } from '@/context/WebSocketContext';\r\nimport { subscribeToWalletUpdates, getWalletBalanceListener } from '@/utils/walletSync';\r\nimport { WebSocketEvent } from '@/types/websocket';\r\nimport { sanitizeStrict } from '@/utils/security/sanitization';\r\nimport { securityService } from '@/services/security.service';\r\n\r\nfunction AdminWalletContent() {\r\n  const { \r\n    wallet, \r\n    adminCreditUser, \r\n    adminDebitUser, \r\n    adminActions,\r\n    buyerBalances,\r\n    sellerBalances,\r\n    reloadData \r\n  } = useWallet();\r\n  const { user } = useAuth();\r\n  const { users: listingUsers } = useListings();\r\n  \r\n  // Fix: Handle nullable WebSocket context\r\n  const wsContext = useWebSocket();\r\n  const subscribe = wsContext?.subscribe || (() => () => {});\r\n  const isConnected = wsContext?.isConnected || false;\r\n  \r\n  // Force re-render hook\r\n  const [, forceUpdate] = useState({});\r\n  const forceRender = useCallback(() => forceUpdate({}), []);\r\n  \r\n  // Track component mount status\r\n  const isMountedRef = useRef(true);\r\n  \r\n  // Search and filtering\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [roleFilter, setRoleFilter] = useState<'all' | 'buyer' | 'seller'>('all');\r\n  const [balanceFilter, setBalanceFilter] = useState<'all' | 'positive' | 'zero' | 'negative'>('all');\r\n  \r\n  // User selection and actions\r\n  const [selectedUser, setSelectedUser] = useState<string | null>(null);\r\n  const [selectedUserRole, setSelectedUserRole] = useState<'buyer' | 'seller' | 'admin'>('buyer');\r\n  const [amount, setAmount] = useState('');\r\n  const [reason, setReason] = useState('');\r\n  const [actionType, setActionType] = useState<'credit' | 'debit'>('credit');\r\n  \r\n  // Bulk operations\r\n  const [selectedUsers, setSelectedUsers] = useState<string[]>([]);\r\n  const [showBulkModal, setShowBulkModal] = useState(false);\r\n  \r\n  // UI state\r\n  const [message, setMessage] = useState('');\r\n  const [messageType, setMessageType] = useState<'success' | 'error'>('success');\r\n  const [showMessage, setShowMessage] = useState(false);\r\n  const [allUsers, setAllUsers] = useState<{username: string, role: string}[]>([]);\r\n  const [displayedUsers, setDisplayedUsers] = useState<{username: string, role: string}[]>([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isBulkLoading, setIsBulkLoading] = useState(false);\r\n  const [isRefreshing, setIsRefreshing] = useState(false);\r\n  \r\n  // Modals\r\n  const [showConfirmModal, setShowConfirmModal] = useState(false);\r\n  const [pendingAction, setPendingAction] = useState<(() => void) | null>(null);\r\n  \r\n  // Advanced features\r\n  const [showBalances, setShowBalances] = useState(true);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      isMountedRef.current = false;\r\n    };\r\n  }, []);\r\n\r\n  // Subscribe to WebSocket balance updates\r\n  useEffect(() => {\r\n    if (!isConnected || !isMountedRef.current) return;\r\n\r\n    // Subscribe to wallet balance updates\r\n    const unsubBalance = subscribe(WebSocketEvent.WALLET_BALANCE_UPDATE, (data: any) => {\r\n      console.log('[AdminWallet] Received balance update:', data);\r\n      // Force component re-render when any balance updates\r\n      if (isMountedRef.current) {\r\n        forceRender();\r\n      }\r\n    });\r\n\r\n    // Subscribe to wallet transactions\r\n    const unsubTransaction = subscribe(WebSocketEvent.WALLET_TRANSACTION, (data: any) => {\r\n      console.log('[AdminWallet] Received transaction:', data);\r\n      if (isMountedRef.current) {\r\n        forceRender();\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      unsubBalance();\r\n      unsubTransaction();\r\n    };\r\n  }, [isConnected, subscribe, forceRender]);\r\n\r\n  // Subscribe to custom wallet updates\r\n  useEffect(() => {\r\n    const unsubscribe = subscribeToWalletUpdates((data) => {\r\n      console.log('[AdminWallet] Custom wallet update:', data);\r\n      if (isMountedRef.current) {\r\n        forceRender();\r\n      }\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [forceRender]);\r\n\r\n  // Subscribe to real-time balance updates for specific users\r\n  useEffect(() => {\r\n    const balanceListener = getWalletBalanceListener();\r\n    const subscriptions: (() => void)[] = [];\r\n\r\n    // Subscribe to balance updates for all displayed users\r\n    displayedUsers.forEach(user => {\r\n      const unsubscribe = balanceListener.subscribe(\r\n        user.username,\r\n        user.role as 'buyer' | 'seller',\r\n        (newBalance) => {\r\n          console.log(`[AdminWallet] Balance updated for ${user.username}: ${newBalance}`);\r\n          if (isMountedRef.current) {\r\n            forceRender();\r\n          }\r\n        }\r\n      );\r\n      subscriptions.push(unsubscribe);\r\n    });\r\n\r\n    return () => {\r\n      subscriptions.forEach(unsub => unsub());\r\n    };\r\n  }, [displayedUsers, forceRender]);\r\n\r\n  // Load all users - now using combined wallet data\r\n  useEffect(() => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    console.log('=== LOADING USERS WITH REAL-TIME DATA ===');\r\n    console.log('Buyer balances:', buyerBalances);\r\n    console.log('Seller balances:', sellerBalances);\r\n    console.log('Wallet object:', wallet);\r\n    \r\n    let allUsersMap: {[key: string]: any} = {};\r\n    \r\n    // Add users from ListingContext\r\n    if (listingUsers && Object.keys(listingUsers).length > 0) {\r\n      Object.entries(listingUsers).forEach(([username, userData]) => {\r\n        allUsersMap[username] = userData;\r\n      });\r\n    }\r\n    \r\n    // Add buyers from buyerBalances\r\n    Object.keys(buyerBalances).forEach(username => {\r\n      if (!allUsersMap[username]) {\r\n        allUsersMap[username] = {\r\n          username: username,\r\n          role: 'buyer',\r\n        };\r\n      }\r\n    });\r\n    \r\n    // Add sellers from sellerBalances\r\n    Object.keys(sellerBalances).forEach(username => {\r\n      if (!allUsersMap[username] || allUsersMap[username].role !== 'seller') {\r\n        allUsersMap[username] = {\r\n          username: username,\r\n          role: 'seller',\r\n        };\r\n      }\r\n    });\r\n    \r\n    // Add any remaining users from wallet object\r\n    Object.keys(wallet).forEach(username => {\r\n      if (!allUsersMap[username] && username !== 'admin') {\r\n        allUsersMap[username] = {\r\n          username: username,\r\n          role: 'buyer', // Default to buyer if not specified\r\n        };\r\n      }\r\n    });\r\n    \r\n    // Filter out admin users and convert to array\r\n    const nonAdminUsers = Object.entries(allUsersMap)\r\n      .filter(([username, userData]) => {\r\n        return userData.role !== 'admin' && username !== 'admin';\r\n      })\r\n      .map(([username, userData]) => ({\r\n        username: sanitizeStrict(username),\r\n        role: userData.role || 'buyer'\r\n      }));\r\n    \r\n    // Sort users\r\n    const sortedUsers = nonAdminUsers.sort((a, b) => {\r\n      if (a.role !== b.role) {\r\n        if (a.role === 'buyer' && b.role === 'seller') return -1;\r\n        if (a.role === 'seller' && b.role === 'buyer') return 1;\r\n      }\r\n      return a.username.localeCompare(b.username);\r\n    });\r\n    \r\n    console.log('Final users:', sortedUsers);\r\n    console.log('=== END LOADING ===');\r\n    \r\n    if (isMountedRef.current) {\r\n      setAllUsers(sortedUsers);\r\n    }\r\n  }, [listingUsers, wallet, buyerBalances, sellerBalances, user]);\r\n\r\n  // Get user balance - Fixed to handle all possible data formats\r\n  const getUserBalance = (username: string) => {\r\n    // Validate username\r\n    if (!username || typeof username !== 'string') return 0;\r\n    \r\n    // Check if user is a buyer or seller\r\n    const user = allUsers.find(u => u.username === username);\r\n    let balance = 0;\r\n    \r\n    if (user?.role === 'seller') {\r\n      const sellerBalance = sellerBalances[username];\r\n      // Handle case where balance might be an object\r\n      if (typeof sellerBalance === 'number') {\r\n        balance = sellerBalance;\r\n      } else if (sellerBalance && typeof sellerBalance === 'object' && 'balance' in sellerBalance) {\r\n        balance = (sellerBalance as any).balance;\r\n      } else {\r\n        balance = 0;\r\n      }\r\n    } else {\r\n      // Default to buyer balance\r\n      const buyerBalance = buyerBalances[username];\r\n      if (typeof buyerBalance === 'number') {\r\n        balance = buyerBalance;\r\n      } else if (buyerBalance && typeof buyerBalance === 'object' && 'balance' in buyerBalance) {\r\n        balance = (buyerBalance as any).balance;\r\n      } else {\r\n        // Fallback to wallet\r\n        const walletBalance = wallet[username];\r\n        if (typeof walletBalance === 'number') {\r\n          balance = walletBalance;\r\n        } else {\r\n          balance = 0;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Ensure we always return a valid number\r\n    return isNaN(balance) ? 0 : balance;\r\n  };\r\n\r\n  // Handle search term change with sanitization\r\n  const handleSearchTermChange = (term: string) => {\r\n    const sanitized = securityService.sanitizeSearchQuery(term);\r\n    if (isMountedRef.current) {\r\n      setSearchTerm(sanitized);\r\n    }\r\n  };\r\n\r\n  // Filter users based on search term, role filter, and balance filter\r\n  useEffect(() => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    let filtered = allUsers;\r\n    \r\n    if (roleFilter !== 'all') {\r\n      filtered = filtered.filter(user => user.role === roleFilter);\r\n    }\r\n    \r\n    if (searchTerm) {\r\n      const searchLower = searchTerm.toLowerCase();\r\n      filtered = filtered.filter(user => \r\n        user.username.toLowerCase().includes(searchLower)\r\n      );\r\n    }\r\n\r\n    if (balanceFilter !== 'all') {\r\n      filtered = filtered.filter(user => {\r\n        const balance = getUserBalance(user.username);\r\n        switch (balanceFilter) {\r\n          case 'positive': return balance > 0;\r\n          case 'zero': return balance === 0;\r\n          case 'negative': return balance < 0;\r\n          default: return true;\r\n        }\r\n      });\r\n    }\r\n    \r\n    if (isMountedRef.current) {\r\n      setDisplayedUsers(filtered);\r\n    }\r\n  }, [searchTerm, allUsers, roleFilter, balanceFilter, wallet, buyerBalances, sellerBalances]);\r\n\r\n  // Handle user selection\r\n  const handleSelectUser = (username: string, role: string) => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    const sanitizedUsername = sanitizeStrict(username);\r\n    setSelectedUser(sanitizedUsername);\r\n    setSelectedUserRole(role as 'buyer' | 'seller' | 'admin');\r\n    setSelectedUsers([]);\r\n  };\r\n\r\n  // Handle bulk user selection\r\n  const handleBulkSelect = (username: string) => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    const sanitizedUsername = sanitizeStrict(username);\r\n    setSelectedUsers(prev => \r\n      prev.includes(sanitizedUsername) \r\n        ? prev.filter(u => u !== sanitizedUsername)\r\n        : [...prev, sanitizedUsername]\r\n    );\r\n    setSelectedUser(null);\r\n  };\r\n\r\n  // Select all filtered users\r\n  const handleSelectAll = () => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    if (selectedUsers.length === displayedUsers.length) {\r\n      setSelectedUsers([]);\r\n    } else {\r\n      setSelectedUsers(displayedUsers.map(u => u.username));\r\n    }\r\n  };\r\n\r\n  // Show message helper\r\n  const showMessageHelper = (msg: string, type: 'success' | 'error' = 'success') => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    setMessage(msg);\r\n    setMessageType(type);\r\n    setShowMessage(true);\r\n    setTimeout(() => {\r\n      if (isMountedRef.current) {\r\n        setShowMessage(false);\r\n      }\r\n    }, 4000);\r\n  };\r\n\r\n  // Validate amount and reason\r\n  const validateAction = (amount: string, reason: string): { valid: boolean; error?: string } => {\r\n    const numAmount = parseFloat(amount);\r\n    \r\n    if (!amount || isNaN(numAmount) || numAmount <= 0) {\r\n      return { valid: false, error: 'Please enter a valid amount greater than 0' };\r\n    }\r\n    \r\n    if (numAmount > 10000) {\r\n      return { valid: false, error: 'Amount cannot exceed $10,000' };\r\n    }\r\n    \r\n    if (!reason || reason.trim().length < 3) {\r\n      return { valid: false, error: 'Please provide a reason (minimum 3 characters)' };\r\n    }\r\n    \r\n    if (reason.length > 200) {\r\n      return { valid: false, error: 'Reason cannot exceed 200 characters' };\r\n    }\r\n    \r\n    return { valid: true };\r\n  };\r\n\r\n  // Handle the wallet action (credit or debit) with confirmation\r\n  const handleAction = () => {\r\n    if (!selectedUser || !amount || !reason) {\r\n      showMessageHelper('Please fill in all fields', 'error');\r\n      return;\r\n    }\r\n\r\n    const validation = validateAction(amount, reason);\r\n    if (!validation.valid) {\r\n      showMessageHelper(validation.error || 'Invalid input', 'error');\r\n      return;\r\n    }\r\n\r\n    const numAmount = parseFloat(amount);\r\n    if (actionType === 'debit' || numAmount > 100) {\r\n      setPendingAction(() => () => executeAction(numAmount));\r\n      setShowConfirmModal(true);\r\n    } else {\r\n      executeAction(numAmount);\r\n    }\r\n  };\r\n\r\n  // Execute the wallet action\r\n  const executeAction = async (numAmount: number) => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    setIsLoading(true);\r\n    \r\n    // Small delay for UI feedback\r\n    await new Promise(resolve => setTimeout(resolve, 500));\r\n\r\n    const roleForWallet: 'buyer' | 'seller' = selectedUserRole === 'admin' ? 'buyer' : selectedUserRole as 'buyer' | 'seller';\r\n    const sanitizedReason = sanitizeStrict(reason);\r\n\r\n    let success = false;\r\n    if (actionType === 'credit') {\r\n      success = await adminCreditUser(selectedUser!, roleForWallet, numAmount, sanitizedReason);\r\n    } else {\r\n      success = await adminDebitUser(selectedUser!, roleForWallet, numAmount, sanitizedReason);\r\n    }\r\n\r\n    if (isMountedRef.current) {\r\n      if (success) {\r\n        showMessageHelper(`Successfully ${actionType === 'credit' ? 'credited' : 'debited'} $${numAmount.toFixed(2)} to ${selectedUser}'s account`, 'success');\r\n        setAmount('');\r\n        setReason('');\r\n        \r\n        // Force a re-render to show updated balance immediately\r\n        forceRender();\r\n      } else {\r\n        showMessageHelper(`Failed to ${actionType} account. ${actionType === 'debit' ? 'Check if user has sufficient balance.' : ''}`, 'error');\r\n      }\r\n\r\n      setIsLoading(false);\r\n      setShowConfirmModal(false);\r\n      setPendingAction(null);\r\n    }\r\n  };\r\n\r\n  // Handle bulk actions with validation\r\n  const handleBulkAction = async (action: 'credit' | 'debit', amount: number, reason: string) => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    // Validate bulk action\r\n    const validation = validateAction(amount.toString(), reason);\r\n    if (!validation.valid) {\r\n      showMessageHelper(validation.error || 'Invalid input', 'error');\r\n      return;\r\n    }\r\n    \r\n    setIsBulkLoading(true);\r\n    \r\n    let successCount = 0;\r\n    let failCount = 0;\r\n    const sanitizedReason = sanitizeStrict(reason);\r\n\r\n    for (const username of selectedUsers) {\r\n      const userRole = allUsers.find(u => u.username === username)?.role as 'buyer' | 'seller';\r\n      let success = false;\r\n      \r\n      if (action === 'credit') {\r\n        success = await adminCreditUser(username, userRole, amount, sanitizedReason);\r\n      } else {\r\n        success = await adminDebitUser(username, userRole, amount, sanitizedReason);\r\n      }\r\n\r\n      if (success) successCount++;\r\n      else failCount++;\r\n    }\r\n\r\n    if (isMountedRef.current) {\r\n      showMessageHelper(\r\n        `Bulk action completed: ${successCount} successful, ${failCount} failed`, \r\n        failCount > 0 ? 'error' : 'success'\r\n      );\r\n\r\n      setSelectedUsers([]);\r\n      setShowBulkModal(false);\r\n      setIsBulkLoading(false);\r\n      \r\n      // Force re-render to show updated balances\r\n      forceRender();\r\n    }\r\n  };\r\n\r\n  // Refresh data\r\n  const handleRefresh = async () => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    setIsRefreshing(true);\r\n    \r\n    // Call the reloadData function from WalletContext\r\n    if (reloadData) {\r\n      await reloadData();\r\n    }\r\n    \r\n    // Small delay for UI feedback\r\n    await new Promise(resolve => setTimeout(resolve, 500));\r\n    \r\n    if (isMountedRef.current) {\r\n      setIsRefreshing(false);\r\n      showMessageHelper('Data refreshed successfully');\r\n      forceRender();\r\n    }\r\n  };\r\n\r\n  // Export user data to CSV\r\n  const exportUserData = () => {\r\n    if (!displayedUsers || displayedUsers.length === 0) {\r\n      showMessageHelper('No users to export');\r\n      return;\r\n    }\r\n\r\n    const csvData = displayedUsers.map(user => ({\r\n      Username: sanitizeStrict(user.username),\r\n      Role: user.role,\r\n      Balance: getUserBalance(user.username).toFixed(2),\r\n      'Last Activity': 'N/A'\r\n    }));\r\n\r\n    const headers = Object.keys(csvData[0]);\r\n    const rows = csvData.map(row =>\r\n      headers\r\n        .map(h => `\"${String((row as any)[h]).replace(/\"/g, '\"\"')}\"`)\r\n        .join(',')\r\n    );\r\n    const csvContent = [headers.join(','), ...rows].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `user_data_${new Date().toISOString().split('T')[0]}.csv`;\r\n    a.click();\r\n    URL.revokeObjectURL(url);\r\n    \r\n    showMessageHelper('User data exported successfully');\r\n  };\r\n\r\n  // Clear selection\r\n  const clearSelection = () => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    setSelectedUser(null);\r\n    setSelectedUsers([]);\r\n    setSearchTerm('');\r\n    setAmount('');\r\n    setReason('');\r\n    setActionType('credit');\r\n  };\r\n\r\n  // Get role badge color\r\n  const getRoleBadgeColor = (role: string) => {\r\n    switch (role) {\r\n      case 'buyer': return 'bg-blue-600/20 text-blue-400 border-blue-600/30';\r\n      case 'seller': return 'bg-green-600/20 text-green-400 border-green-600/30';\r\n      default: return 'bg-gray-600/20 text-gray-400 border-gray-600/30';\r\n    }\r\n  };\r\n\r\n  // Get balance color\r\n  const getBalanceColor = (balance: number) => {\r\n    if (balance > 0) return 'text-green-400';\r\n    if (balance < 0) return 'text-red-400';\r\n    return 'text-gray-400';\r\n  };\r\n\r\n  // Format role display\r\n  const formatRole = (role: string) => {\r\n    return role.charAt(0).toUpperCase() + role.slice(1);\r\n  };\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-black text-white py-10 px-4 sm:px-6\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        <WalletHeader\r\n          totalUsers={allUsers.length}\r\n          onRefresh={handleRefresh}\r\n          onExport={exportUserData}\r\n          isRefreshing={isRefreshing}\r\n        />\r\n\r\n        <WalletFilters\r\n          searchTerm={searchTerm}\r\n          setSearchTerm={handleSearchTermChange}\r\n          roleFilter={roleFilter}\r\n          setRoleFilter={setRoleFilter}\r\n          balanceFilter={balanceFilter}\r\n          setBalanceFilter={setBalanceFilter}\r\n          showBalances={showBalances}\r\n          setShowBalances={setShowBalances}\r\n          selectedUsers={selectedUsers}\r\n          setSelectedUsers={setSelectedUsers}\r\n          displayedUsers={displayedUsers}\r\n          handleSelectAll={handleSelectAll}\r\n          setShowBulkModal={setShowBulkModal}\r\n        />\r\n\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n          <WalletUserList\r\n            displayedUsers={displayedUsers}\r\n            selectedUsers={selectedUsers}\r\n            selectedUser={selectedUser}\r\n            showBalances={showBalances}\r\n            handleSelectUser={handleSelectUser}\r\n            handleBulkSelect={handleBulkSelect}\r\n            getUserBalance={getUserBalance}\r\n            getRoleBadgeColor={getRoleBadgeColor}\r\n            getBalanceColor={getBalanceColor}\r\n            formatRole={formatRole}\r\n          />\r\n\r\n          <WalletActionPanel\r\n            selectedUser={selectedUser}\r\n            selectedUserRole={selectedUserRole}\r\n            actionType={actionType}\r\n            setActionType={setActionType}\r\n            amount={amount}\r\n            setAmount={setAmount}\r\n            reason={reason}\r\n            setReason={setReason}\r\n            isLoading={isLoading}\r\n            handleAction={handleAction}\r\n            clearSelection={clearSelection}\r\n            getUserBalance={getUserBalance}\r\n            getRoleBadgeColor={getRoleBadgeColor}\r\n            getBalanceColor={getBalanceColor}\r\n            formatRole={formatRole}\r\n          />\r\n        </div>\r\n\r\n        <WalletToast\r\n          message={message}\r\n          type={messageType}\r\n          isVisible={showMessage}\r\n        />\r\n      </div>\r\n\r\n      <ConfirmationModal\r\n        isOpen={showConfirmModal}\r\n        onClose={() => {\r\n          setShowConfirmModal(false);\r\n          setPendingAction(null);\r\n        }}\r\n        onConfirm={() => pendingAction && pendingAction()}\r\n        title={`Confirm ${actionType === 'credit' ? 'Credit' : 'Debit'}`}\r\n        message={`Are you sure you want to ${actionType} $${amount} ${actionType === 'credit' ? 'to' : 'from'} ${selectedUser}'s account?`}\r\n        type={actionType === 'debit' ? 'danger' : 'warning'}\r\n        isLoading={isLoading}\r\n      />\r\n\r\n      <BulkActionModal\r\n        isOpen={showBulkModal}\r\n        onClose={() => setShowBulkModal(false)}\r\n        selectedUsers={selectedUsers}\r\n        onAction={handleBulkAction}\r\n        isLoading={isBulkLoading}\r\n      />\r\n    </main>\r\n  );\r\n}\r\n\r\n// Wrap the component with WalletProvider to ensure it's available\r\nexport default function AdminWalletManagementPage() {\r\n  const [mounted, setMounted] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setMounted(true);\r\n  }, []);\r\n\r\n  if (!mounted) {\r\n    return (\r\n      <RequireAuth role=\"admin\">\r\n        <div className=\"min-h-screen bg-black flex items-center justify-center p-4\">\r\n          <div className=\"text-center\">\r\n            <Loader2 className=\"h-8 w-8 text-[#ff950e] animate-spin mx-auto mb-4\" />\r\n            <p className=\"text-gray-400\">Loading wallet management...</p>\r\n          </div>\r\n        </div>\r\n      </RequireAuth>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <RequireAuth role=\"admin\">\r\n      <WalletProvider>\r\n        <AdminWalletContent />\r\n      </WalletProvider>\r\n    </RequireAuth>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}