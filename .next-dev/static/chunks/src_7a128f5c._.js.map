{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/RequireAuth.tsx"],"sourcesContent":["// src/components/RequireAuth.tsx\r\n'use client';\r\n\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useEffect, useState } from 'react';\r\nimport { z } from 'zod';\r\n\r\nconst VALID_ROLES = ['buyer', 'seller', 'admin'] as const;\r\ntype ValidRole = (typeof VALID_ROLES)[number];\r\n\r\nconst RoleSchema = z.enum(VALID_ROLES);\r\n\r\nexport default function RequireAuth({\r\n  role,\r\n  children,\r\n}: {\r\n  role: ValidRole;\r\n  children: React.ReactNode;\r\n}) {\r\n  const { user, isAuthReady } = useAuth();\r\n  const router = useRouter();\r\n  const [authorized, setAuthorized] = useState(false);\r\n  const [hasChecked, setHasChecked] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isAuthReady || hasChecked) return;\r\n\r\n    // Runtime validation of `role` prop (dev-only noise)\r\n    const parsed = RoleSchema.safeParse(role);\r\n    if (!parsed.success) {\r\n      if (process.env.NODE_ENV === 'development') {\r\n        console.warn('[RequireAuth] Invalid role prop supplied:', role);\r\n      }\r\n      router.push('/login');\r\n      setHasChecked(true);\r\n      return;\r\n    }\r\n\r\n    const userRole = user?.role as ValidRole | undefined;\r\n\r\n    // NEW: strict role matching — no admin override for buyer/seller routes\r\n    let hasAccess = false;\r\n    if (parsed.data === 'admin') {\r\n      hasAccess = userRole === 'admin';\r\n    } else {\r\n      hasAccess = userRole === parsed.data; // admin can’t view buyer/seller pages\r\n    }\r\n\r\n    if (!user || !hasAccess) {\r\n      router.push('/login');\r\n    } else {\r\n      setAuthorized(true);\r\n    }\r\n\r\n    setHasChecked(true);\r\n  }, [isAuthReady, user, role, router, hasChecked]);\r\n\r\n  if (!isAuthReady || !hasChecked) {\r\n    return (\r\n      <div className=\"min-h-screen bg-black flex items-center justify-center\" role=\"status\" aria-label=\"Checking access\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          <div className=\"w-4 h-4 bg-[#ff950e] rounded-full animate-pulse\" />\r\n          <div className=\"w-4 h-4 bg-[#ff950e] rounded-full animate-pulse\" style={{ animationDelay: '0.2s' }} />\r\n          <div className=\"w-4 h-4 bg-[#ff950e] rounded-full animate-pulse\" style={{ animationDelay: '0.4s' }} />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!authorized) return null;\r\n\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":"AAAA,iCAAiC;;;;AA+BvB;;AA5BV;AACA;AACA;AACA;;;AALA;;;;;AAOA,MAAM,cAAc;IAAC;IAAS;IAAU;CAAQ;AAGhD,MAAM,aAAa,qKAAA,CAAA,IAAC,CAAC,IAAI,CAAC;;AAEX,SAAS,YAAY,KAMnC;QANmC,EAClC,IAAI,EACJ,QAAQ,EAIT,GANmC;;IAOlC,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,GAAG,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;IACpC,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE7C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR,IAAI,CAAC,eAAe,YAAY;YAEhC,qDAAqD;YACrD,MAAM,SAAS,WAAW,SAAS,CAAC;YACpC,IAAI,CAAC,OAAO,OAAO,EAAE;gBACnB,wCAA4C;oBAC1C,QAAQ,IAAI,CAAC,6CAA6C;gBAC5D;gBACA,OAAO,IAAI,CAAC;gBACZ,cAAc;gBACd;YACF;YAEA,MAAM,WAAW,iBAAA,2BAAA,KAAM,IAAI;YAE3B,wEAAwE;YACxE,IAAI,YAAY;YAChB,IAAI,OAAO,IAAI,KAAK,SAAS;gBAC3B,YAAY,aAAa;YAC3B,OAAO;gBACL,YAAY,aAAa,OAAO,IAAI,EAAE,sCAAsC;YAC9E;YAEA,IAAI,CAAC,QAAQ,CAAC,WAAW;gBACvB,OAAO,IAAI,CAAC;YACd,OAAO;gBACL,cAAc;YAChB;YAEA,cAAc;QAChB;gCAAG;QAAC;QAAa;QAAM;QAAM;QAAQ;KAAW;IAEhD,IAAI,CAAC,eAAe,CAAC,YAAY;QAC/B,qBACE,6LAAC;YAAI,WAAU;YAAyD,MAAK;YAAS,cAAW;sBAC/F,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;;;;;kCACf,6LAAC;wBAAI,WAAU;wBAAkD,OAAO;4BAAE,gBAAgB;wBAAO;;;;;;kCACjG,6LAAC;wBAAI,WAAU;wBAAkD,OAAO;4BAAE,gBAAgB;wBAAO;;;;;;;;;;;;;;;;;IAIzG;IAEA,IAAI,CAAC,YAAY,OAAO;IAExB,qBAAO;kBAAG;;AACZ;GA5DwB;;QAOQ,iIAAA,CAAA,UAAO;QACtB,qIAAA,CAAA,YAAS;;;MARF","debugId":null}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/buyers/my-orders/OrdersHeader.tsx"],"sourcesContent":["// src/components/buyers/my-orders/OrdersHeader.tsx\r\n'use client';\r\n\r\nimport React from 'react';\r\nimport { ShoppingBag, TrendingUp, Package } from 'lucide-react';\r\n\r\nexport default function OrdersHeader() {\r\n  return (\r\n    <div className=\"mb-10 relative\">\r\n      {/* Background decoration */}\r\n      <div className=\"absolute -top-4 -left-4 w-24 h-24 bg-[#ff950e]/10 rounded-full blur-3xl\" />\r\n      <div className=\"absolute -top-8 right-0 w-32 h-32 bg-[#ff950e]/5 rounded-full blur-3xl\" />\r\n      \r\n      <div className=\"relative\">\r\n        <div className=\"flex items-center gap-4 mb-6\">\r\n          {/* Animated icon container */}\r\n          <div className=\"relative group\">\r\n            <div className=\"absolute inset-0 bg-gradient-to-r from-[#ff950e] to-[#ff6b00] rounded-xl blur-md opacity-30 group-hover:opacity-50 transition-opacity duration-300\" />\r\n            <div className=\"relative bg-gradient-to-r from-[#ff950e] to-[#ff6b00] p-3 rounded-xl shadow-xl\">\r\n              <ShoppingBag className=\"w-8 h-8 text-white\" />\r\n            </div>\r\n          </div>\r\n          \r\n          {/* Title with gradient */}\r\n          <h1 className=\"text-4xl md:text-5xl font-bold\">\r\n            <span className=\"bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent\">\r\n              My Orders\r\n            </span>\r\n          </h1>\r\n        </div>\r\n        \r\n        {/* Modern description with tags */}\r\n        <div className=\"flex flex-col sm:flex-row sm:items-center gap-4\">\r\n          <p className=\"text-gray-400 text-lg flex-1\">\r\n            Track your purchases, manage delivery addresses, and stay updated on order status.\r\n          </p>\r\n          \r\n          {/* Quick stats/tags */}\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"flex items-center gap-2 bg-green-500/10 px-3 py-1.5 rounded-full border border-green-500/20\">\r\n              <TrendingUp className=\"w-4 h-4 text-green-400\" />\r\n              <span className=\"text-green-400 text-sm font-medium\">Live Tracking</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2 bg-green-500/10 px-3 py-1.5 rounded-full border border-green-500/20\">\r\n              <Package className=\"w-4 h-4 text-green-400\" />\r\n              <span className=\"text-green-400 text-sm font-medium\">Secure Delivery</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,mDAAmD;;;;;AAInD;AAAA;AAAA;AAHA;;;AAKe,SAAS;IACtB,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;;;;;0BACf,6LAAC;gBAAI,WAAU;;;;;;0BAEf,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CAEb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;;;;;kDACf,6LAAC;wCAAI,WAAU;kDACb,cAAA,6LAAC,uNAAA,CAAA,cAAW;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAK3B,6LAAC;gCAAG,WAAU;0CACZ,cAAA,6LAAC;oCAAK,WAAU;8CAAwE;;;;;;;;;;;;;;;;;kCAO5F,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAE,WAAU;0CAA+B;;;;;;0CAK5C,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC,qNAAA,CAAA,aAAU;gDAAC,WAAU;;;;;;0DACtB,6LAAC;gDAAK,WAAU;0DAAqC;;;;;;;;;;;;kDAEvD,6LAAC;wCAAI,WAAU;;0DACb,6LAAC,2MAAA,CAAA,UAAO;gDAAC,WAAU;;;;;;0DACnB,6LAAC;gDAAK,WAAU;0DAAqC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOnE;KA9CwB","debugId":null}},
    {"offset": {"line": 329, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/buyers/my-orders/OrderStats.tsx"],"sourcesContent":["// src/components/buyers/my-orders/OrderStats.tsx\r\n'use client';\r\n\r\nimport React from 'react';\r\nimport { DollarSign, Clock, Truck } from 'lucide-react';\r\nimport { OrderStats as StatsType } from '@/hooks/useMyOrders';\r\n\r\ninterface OrderStatsProps {\r\n  stats: StatsType;\r\n}\r\n\r\nexport default function OrderStats({ stats }: OrderStatsProps) {\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n      <div className=\"bg-gray-800/50 p-6 rounded-xl border-2 border-red-500/60 hover:border-red-400/80 transition-all duration-300 hover:shadow-lg hover:shadow-red-500/20\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <p className=\"text-red-400 text-sm font-medium\">Total Spent</p>\r\n            <p className=\"text-white text-2xl font-bold\">${stats.totalSpent.toFixed(2)}</p>\r\n          </div>\r\n          <div className=\"bg-red-500/20 p-3 rounded-lg\">\r\n            <DollarSign className=\"w-8 h-8 text-red-400\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <div className=\"bg-gradient-to-br from-yellow-500/15 to-amber-500/15 p-6 rounded-xl border border-yellow-500/40 hover:border-yellow-400/60 transition-all duration-300 hover:shadow-lg hover:shadow-yellow-500/15\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <p className=\"text-yellow-400 text-sm font-medium\">Pending Orders</p>\r\n            <p className=\"text-white text-2xl font-bold\">{stats.pendingOrders}</p>\r\n          </div>\r\n          <div className=\"bg-yellow-500/25 p-3 rounded-lg\">\r\n            <Clock className=\"w-8 h-8 text-yellow-400\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <div className=\"bg-gradient-to-br from-blue-500/15 to-sky-500/15 p-6 rounded-xl border border-blue-500/40 hover:border-blue-400/60 transition-all duration-300 hover:shadow-lg hover:shadow-blue-500/15\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <p className=\"text-blue-400 text-sm font-medium\">Shipped Orders</p>\r\n            <p className=\"text-white text-2xl font-bold\">{stats.shippedOrders}</p>\r\n          </div>\r\n          <div className=\"bg-blue-500/25 p-3 rounded-lg\">\r\n            <Truck className=\"w-8 h-8 text-blue-400\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,iDAAiD;;;;;AAIjD;AAAA;AAAA;AAHA;;;AAUe,SAAS,WAAW,KAA0B;QAA1B,EAAE,KAAK,EAAmB,GAA1B;IACjC,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;;8CACC,6LAAC;oCAAE,WAAU;8CAAmC;;;;;;8CAChD,6LAAC;oCAAE,WAAU;;wCAAgC;wCAAE,MAAM,UAAU,CAAC,OAAO,CAAC;;;;;;;;;;;;;sCAE1E,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC,qNAAA,CAAA,aAAU;gCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;0BAK5B,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;;8CACC,6LAAC;oCAAE,WAAU;8CAAsC;;;;;;8CACnD,6LAAC;oCAAE,WAAU;8CAAiC,MAAM,aAAa;;;;;;;;;;;;sCAEnE,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC,uMAAA,CAAA,QAAK;gCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;0BAKvB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;;8CACC,6LAAC;oCAAE,WAAU;8CAAoC;;;;;;8CACjD,6LAAC;oCAAE,WAAU;8CAAiC,MAAM,aAAa;;;;;;;;;;;;sCAEnE,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC,uMAAA,CAAA,QAAK;gCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM7B;KAxCwB","debugId":null}},
    {"offset": {"line": 529, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/buyers/my-orders/OrderFilters.tsx"],"sourcesContent":["// src/components/buyers/my-orders/OrderFilters.tsx\r\n'use client';\r\n\r\nimport React from 'react';\r\nimport { Search, Calendar, DollarSign } from 'lucide-react';\r\nimport { SecureInput } from '@/components/ui/SecureInput';\r\nimport { sanitizeSearchQuery } from '@/utils/security/sanitization';\r\n\r\ninterface OrderFiltersProps {\r\n  searchQuery: string;\r\n  onSearchChange: (query: string) => void;\r\n  filterStatus: 'all' | 'pending' | 'processing' | 'shipped';\r\n  onFilterStatusChange: (status: 'all' | 'pending' | 'processing' | 'shipped') => void;\r\n  sortBy: 'date' | 'price' | 'status';\r\n  sortOrder: 'asc' | 'desc';\r\n  onToggleSort: (sortBy: 'date' | 'price' | 'status') => void;\r\n}\r\n\r\nexport default function OrderFilters({\r\n  searchQuery,\r\n  onSearchChange,\r\n  filterStatus,\r\n  onFilterStatusChange,\r\n  sortBy,\r\n  sortOrder,\r\n  onToggleSort,\r\n}: OrderFiltersProps) {\r\n  return (\r\n    <div className=\"bg-gray-800/50 rounded-2xl p-5 mb-8 border border-[#ff950e]/40\">\r\n      <div className=\"flex flex-col lg:flex-row gap-3\">\r\n        {/* Search (secured) */}\r\n        <div className=\"flex-1\">\r\n          <div className=\"relative group\">\r\n            <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-600 w-4 h-4 group-focus-within:text-[#ff950e] transition-colors duration-300\" />\r\n            <SecureInput\r\n              type=\"text\"\r\n              placeholder=\"Search orders...\"\r\n              value={searchQuery}\r\n              onChange={(v) => onSearchChange(v)}\r\n              sanitizer={sanitizeSearchQuery}\r\n              className=\"w-full pl-11 pr-4 py-3 !bg-black/30 !border !border-gray-800/50 rounded-xl !text-white placeholder-gray-600 focus:!border-[#ff950e]/50 focus:!bg-black/50 focus:!outline-none focus:placeholder-gray-500 transition-all duration-300\"\r\n              maxLength={100}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filters Group */}\r\n        <div className=\"flex gap-2\">\r\n          <select\r\n            className=\"px-4 py-3 bg-black/30 border border-gray-800/50 rounded-xl text-gray-300 focus:text-white focus:border-[#ff950e]/50 focus:outline-none transition-all duration-300 cursor-pointer hover:bg-black/50\"\r\n            value={filterStatus}\r\n            onChange={(e) => onFilterStatusChange(e.target.value as 'all' | 'pending' | 'processing' | 'shipped')}\r\n          >\r\n            <option value=\"all\">All Status</option>\r\n            <option value=\"pending\">Pending</option>\r\n            <option value=\"processing\">Processing</option>\r\n            <option value=\"shipped\">Shipped</option>\r\n          </select>\r\n\r\n          <div className=\"flex bg-black/30 rounded-xl p-1 border border-gray-800/50\">\r\n            <button\r\n              onClick={() => onToggleSort('date')}\r\n              className={`flex items-center gap-1.5 px-3 py-2 rounded-lg transition-all duration-300 text-sm font-medium ${\r\n                sortBy === 'date' ? 'bg-[#ff950e] text-black shadow-md' : 'text-gray-400 hover:text-gray-200'\r\n              }`}\r\n            >\r\n              <Calendar className=\"w-3.5 h-3.5\" />\r\n              <span>Date</span>\r\n            </button>\r\n\r\n            <button\r\n              onClick={() => onToggleSort('price')}\r\n              className={`flex items-center gap-1.5 px-3 py-2 rounded-lg transition-all duration-300 text-sm font-medium ${\r\n                sortBy === 'price' ? 'bg-[#ff950e] text-black shadow-md' : 'text-gray-400 hover:text-gray-200'\r\n              }`}\r\n            >\r\n              <DollarSign className=\"w-3.5 h-3.5\" />\r\n              <span>Price</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,mDAAmD;;;;;AAInD;AAAA;AAAA;AACA;AACA;AALA;;;;;AAiBe,SAAS,aAAa,KAQjB;QARiB,EACnC,WAAW,EACX,cAAc,EACd,YAAY,EACZ,oBAAoB,EACpB,MAAM,EACN,SAAS,EACT,YAAY,EACM,GARiB;IASnC,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BAEb,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,yMAAA,CAAA,SAAM;gCAAC,WAAU;;;;;;0CAClB,6LAAC,0IAAA,CAAA,cAAW;gCACV,MAAK;gCACL,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,eAAe;gCAChC,WAAW,2IAAA,CAAA,sBAAmB;gCAC9B,WAAU;gCACV,WAAW;;;;;;;;;;;;;;;;;8BAMjB,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BACC,WAAU;4BACV,OAAO;4BACP,UAAU,CAAC,IAAM,qBAAqB,EAAE,MAAM,CAAC,KAAK;;8CAEpD,6LAAC;oCAAO,OAAM;8CAAM;;;;;;8CACpB,6LAAC;oCAAO,OAAM;8CAAU;;;;;;8CACxB,6LAAC;oCAAO,OAAM;8CAAa;;;;;;8CAC3B,6LAAC;oCAAO,OAAM;8CAAU;;;;;;;;;;;;sCAG1B,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,SAAS,IAAM,aAAa;oCAC5B,WAAW,AAAC,kGAEX,OADC,WAAW,SAAS,sCAAsC;;sDAG5D,6LAAC,6MAAA,CAAA,WAAQ;4CAAC,WAAU;;;;;;sDACpB,6LAAC;sDAAK;;;;;;;;;;;;8CAGR,6LAAC;oCACC,SAAS,IAAM,aAAa;oCAC5B,WAAW,AAAC,kGAEX,OADC,WAAW,UAAU,sCAAsC;;sDAG7D,6LAAC,qNAAA,CAAA,aAAU;4CAAC,WAAU;;;;;;sDACtB,6LAAC;sDAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOpB;KAlEwB","debugId":null}},
    {"offset": {"line": 720, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/utils/profileUtils.ts"],"sourcesContent":["// src/utils/profileUtils.ts\r\n\r\nimport { storageService } from '@/services';\r\n\r\nexport interface UserProfile {\r\n  bio: string;\r\n  profilePic: string | null;\r\n  subscriptionPrice: string;\r\n  lastUpdated?: string;\r\n}\r\n\r\n/**\r\n * Get user profile data from shared storage\r\n * Returns Promise<UserProfile | null>\r\n */\r\nexport async function getUserProfileData(username: string): Promise<UserProfile | null> {\r\n  if (!username || typeof window === 'undefined') return null;\r\n\r\n  try {\r\n    // First check shared storage via DSAL\r\n    const profiles = await storageService.getItem<Record<string, UserProfile>>('user_profiles', {});\r\n    \r\n    if (profiles[username]) {\r\n      return profiles[username];\r\n    }\r\n\r\n    // Fallback: check legacy storage keys for backward compatibility\r\n    const legacyBio = await storageService.getItem<string | null>(`profile_bio_${username}`, null);\r\n    const legacyProfilePic = await storageService.getItem<string | null>(`profile_pic_${username}`, null);\r\n    const legacySubscriptionPrice = await storageService.getItem<string | null>(`subscription_price_${username}`, null);\r\n\r\n    // If we found legacy data, migrate it\r\n    if (legacyBio !== null || legacyProfilePic !== null || legacySubscriptionPrice !== null) {\r\n      const profile: UserProfile = {\r\n        bio: legacyBio || '',\r\n        profilePic: legacyProfilePic || null,\r\n        subscriptionPrice: legacySubscriptionPrice || '0'\r\n      };\r\n      \r\n      // Save to new format\r\n      await saveUserProfileData(username, profile);\r\n      \r\n      // Clean up legacy keys\r\n      await storageService.removeItem(`profile_bio_${username}`);\r\n      await storageService.removeItem(`profile_pic_${username}`);\r\n      await storageService.removeItem(`subscription_price_${username}`);\r\n      \r\n      return profile;\r\n    }\r\n\r\n    // No data found, return default\r\n    return {\r\n      bio: '',\r\n      profilePic: null,\r\n      subscriptionPrice: '0'\r\n    };\r\n  } catch (error) {\r\n    console.error('Error loading user profile:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Save user profile data to shared storage\r\n * Returns Promise<boolean>\r\n */\r\nexport async function saveUserProfileData(username: string, profile: UserProfile): Promise<boolean> {\r\n  if (!username || typeof window === 'undefined') return false;\r\n\r\n  try {\r\n    // Get existing profiles via DSAL\r\n    const profiles = await storageService.getItem<Record<string, UserProfile>>('user_profiles', {});\r\n    \r\n    // Update profile\r\n    profiles[username] = {\r\n      ...profile,\r\n      lastUpdated: new Date().toISOString()\r\n    };\r\n    \r\n    // Save to storage via DSAL\r\n    const success = await storageService.setItem('user_profiles', profiles);\r\n    \r\n    if (!success) {\r\n      return false;\r\n    }\r\n    \r\n    // For backward compatibility, also save individual keys\r\n    // This helps during the migration period\r\n    await storageService.setItem(`profile_bio_${username}`, profile.bio);\r\n    if (profile.profilePic) {\r\n      await storageService.setItem(`profile_pic_${username}`, profile.profilePic);\r\n    } else {\r\n      await storageService.removeItem(`profile_pic_${username}`);\r\n    }\r\n    await storageService.setItem(`subscription_price_${username}`, profile.subscriptionPrice);\r\n    \r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error saving user profile:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Get profile picture for a user\r\n * Returns Promise<string | null>\r\n */\r\nexport async function getUserProfilePic(username: string): Promise<string | null> {\r\n  const profile = await getUserProfileData(username);\r\n  return profile?.profilePic || null;\r\n}\r\n\r\n/**\r\n * Get bio for a user\r\n * Returns Promise<string>\r\n */\r\nexport async function getUserBio(username: string): Promise<string> {\r\n  const profile = await getUserProfileData(username);\r\n  return profile?.bio || '';\r\n}\r\n\r\n/**\r\n * Get subscription price for a user\r\n * Returns Promise<string>\r\n */\r\nexport async function getUserSubscriptionPrice(username: string): Promise<string> {\r\n  const profile = await getUserProfileData(username);\r\n  return profile?.subscriptionPrice || '0';\r\n}\r\n\r\n/**\r\n * Delete user profile data\r\n * Useful for cleanup operations\r\n */\r\nexport async function deleteUserProfileData(username: string): Promise<boolean> {\r\n  if (!username || typeof window === 'undefined') return false;\r\n\r\n  try {\r\n    // Get existing profiles\r\n    const profiles = await storageService.getItem<Record<string, UserProfile>>('user_profiles', {});\r\n    \r\n    // Delete the user's profile\r\n    delete profiles[username];\r\n    \r\n    // Save updated profiles\r\n    const success = await storageService.setItem('user_profiles', profiles);\r\n    \r\n    if (success) {\r\n      // Clean up individual keys too\r\n      await storageService.removeItem(`profile_bio_${username}`);\r\n      await storageService.removeItem(`profile_pic_${username}`);\r\n      await storageService.removeItem(`subscription_price_${username}`);\r\n    }\r\n    \r\n    return success;\r\n  } catch (error) {\r\n    console.error('Error deleting user profile:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Check if user has profile data\r\n * Useful for checking if profile exists\r\n */\r\nexport async function hasUserProfile(username: string): Promise<boolean> {\r\n  if (!username || typeof window === 'undefined') return false;\r\n\r\n  try {\r\n    const profiles = await storageService.getItem<Record<string, UserProfile>>('user_profiles', {});\r\n    return !!profiles[username];\r\n  } catch (error) {\r\n    console.error('Error checking user profile:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Get all user profiles\r\n * Useful for admin views\r\n */\r\nexport async function getAllUserProfiles(): Promise<Record<string, UserProfile>> {\r\n  try {\r\n    return await storageService.getItem<Record<string, UserProfile>>('user_profiles', {});\r\n  } catch (error) {\r\n    console.error('Error getting all user profiles:', error);\r\n    return {};\r\n  }\r\n}\r\n\r\n/**\r\n * Migrate profile data from legacy storage format\r\n * One-time migration utility\r\n */\r\nexport async function migrateProfileFromLegacy(username: string): Promise<boolean> {\r\n  if (!username || typeof window === 'undefined') return false;\r\n\r\n  try {\r\n    // Check if already migrated\r\n    const hasProfile = await hasUserProfile(username);\r\n    if (hasProfile) return true;\r\n\r\n    // Check legacy storage keys\r\n    const bio = await storageService.getItem<string | null>(`profile_bio_${username}`, null);\r\n    const profilePic = await storageService.getItem<string | null>(`profile_pic_${username}`, null);\r\n    const subscriptionPrice = await storageService.getItem<string | null>(`subscription_price_${username}`, null);\r\n\r\n    // If we have any legacy data, migrate it\r\n    if (bio !== null || profilePic !== null || subscriptionPrice !== null) {\r\n      const profile: UserProfile = {\r\n        bio: bio || '',\r\n        profilePic: profilePic || null,\r\n        subscriptionPrice: subscriptionPrice || '0',\r\n        lastUpdated: new Date().toISOString()\r\n      };\r\n\r\n      const success = await saveUserProfileData(username, profile);\r\n      \r\n      // Clean up legacy keys after successful migration\r\n      if (success) {\r\n        await storageService.removeItem(`profile_bio_${username}`);\r\n        await storageService.removeItem(`profile_pic_${username}`);\r\n        await storageService.removeItem(`subscription_price_${username}`);\r\n      }\r\n      \r\n      return success;\r\n    }\r\n\r\n    return false;\r\n  } catch (error) {\r\n    console.error('Error migrating profile from legacy:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Batch migrate all legacy profiles\r\n * Useful for one-time migration of all existing profiles\r\n */\r\nexport async function migrateAllLegacyProfiles(): Promise<{ migrated: number; failed: number }> {\r\n  let migrated = 0;\r\n  let failed = 0;\r\n\r\n  try {\r\n    // Get all storage keys\r\n    const allKeys = await storageService.getKeys();\r\n    \r\n    // Find all unique usernames with profile data\r\n    const usernames = new Set<string>();\r\n    \r\n    allKeys.forEach(key => {\r\n      const bioMatch = key.match(/^profile_bio_(.+)$/);\r\n      const picMatch = key.match(/^profile_pic_(.+)$/);\r\n      const priceMatch = key.match(/^subscription_price_(.+)$/);\r\n      \r\n      if (bioMatch) usernames.add(bioMatch[1]);\r\n      if (picMatch) usernames.add(picMatch[1]);\r\n      if (priceMatch) usernames.add(priceMatch[1]);\r\n    });\r\n\r\n    // Migrate each user\r\n    for (const username of usernames) {\r\n      const success = await migrateProfileFromLegacy(username);\r\n      if (success) {\r\n        migrated++;\r\n      } else {\r\n        failed++;\r\n      }\r\n    }\r\n\r\n    console.log(`Profile migration complete: ${migrated} migrated, ${failed} failed`);\r\n    return { migrated, failed };\r\n  } catch (error) {\r\n    console.error('Error during batch migration:', error);\r\n    return { migrated, failed };\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;;;;;;;;;AAE5B;AAAA;;AAaO,eAAe,mBAAmB,QAAgB;IACvD,IAAI,CAAC,YAAY,aAAkB,aAAa,OAAO;IAEvD,IAAI;QACF,sCAAsC;QACtC,MAAM,WAAW,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAA8B,iBAAiB,CAAC;QAE7F,IAAI,QAAQ,CAAC,SAAS,EAAE;YACtB,OAAO,QAAQ,CAAC,SAAS;QAC3B;QAEA,iEAAiE;QACjE,MAAM,YAAY,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAgB,AAAC,eAAuB,OAAT,WAAY;QACzF,MAAM,mBAAmB,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAgB,AAAC,eAAuB,OAAT,WAAY;QAChG,MAAM,0BAA0B,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAgB,AAAC,sBAA8B,OAAT,WAAY;QAE9G,sCAAsC;QACtC,IAAI,cAAc,QAAQ,qBAAqB,QAAQ,4BAA4B,MAAM;YACvF,MAAM,UAAuB;gBAC3B,KAAK,aAAa;gBAClB,YAAY,oBAAoB;gBAChC,mBAAmB,2BAA2B;YAChD;YAEA,qBAAqB;YACrB,MAAM,oBAAoB,UAAU;YAEpC,uBAAuB;YACvB,MAAM,wIAAA,CAAA,iBAAc,CAAC,UAAU,CAAC,AAAC,eAAuB,OAAT;YAC/C,MAAM,wIAAA,CAAA,iBAAc,CAAC,UAAU,CAAC,AAAC,eAAuB,OAAT;YAC/C,MAAM,wIAAA,CAAA,iBAAc,CAAC,UAAU,CAAC,AAAC,sBAA8B,OAAT;YAEtD,OAAO;QACT;QAEA,gCAAgC;QAChC,OAAO;YACL,KAAK;YACL,YAAY;YACZ,mBAAmB;QACrB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO;IACT;AACF;AAMO,eAAe,oBAAoB,QAAgB,EAAE,OAAoB;IAC9E,IAAI,CAAC,YAAY,aAAkB,aAAa,OAAO;IAEvD,IAAI;QACF,iCAAiC;QACjC,MAAM,WAAW,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAA8B,iBAAiB,CAAC;QAE7F,iBAAiB;QACjB,QAAQ,CAAC,SAAS,GAAG;YACnB,GAAG,OAAO;YACV,aAAa,IAAI,OAAO,WAAW;QACrC;QAEA,2BAA2B;QAC3B,MAAM,UAAU,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAC,iBAAiB;QAE9D,IAAI,CAAC,SAAS;YACZ,OAAO;QACT;QAEA,wDAAwD;QACxD,yCAAyC;QACzC,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAC,AAAC,eAAuB,OAAT,WAAY,QAAQ,GAAG;QACnE,IAAI,QAAQ,UAAU,EAAE;YACtB,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAC,AAAC,eAAuB,OAAT,WAAY,QAAQ,UAAU;QAC5E,OAAO;YACL,MAAM,wIAAA,CAAA,iBAAc,CAAC,UAAU,CAAC,AAAC,eAAuB,OAAT;QACjD;QACA,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAC,AAAC,sBAA8B,OAAT,WAAY,QAAQ,iBAAiB;QAExF,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO;IACT;AACF;AAMO,eAAe,kBAAkB,QAAgB;IACtD,MAAM,UAAU,MAAM,mBAAmB;IACzC,OAAO,CAAA,oBAAA,8BAAA,QAAS,UAAU,KAAI;AAChC;AAMO,eAAe,WAAW,QAAgB;IAC/C,MAAM,UAAU,MAAM,mBAAmB;IACzC,OAAO,CAAA,oBAAA,8BAAA,QAAS,GAAG,KAAI;AACzB;AAMO,eAAe,yBAAyB,QAAgB;IAC7D,MAAM,UAAU,MAAM,mBAAmB;IACzC,OAAO,CAAA,oBAAA,8BAAA,QAAS,iBAAiB,KAAI;AACvC;AAMO,eAAe,sBAAsB,QAAgB;IAC1D,IAAI,CAAC,YAAY,aAAkB,aAAa,OAAO;IAEvD,IAAI;QACF,wBAAwB;QACxB,MAAM,WAAW,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAA8B,iBAAiB,CAAC;QAE7F,4BAA4B;QAC5B,OAAO,QAAQ,CAAC,SAAS;QAEzB,wBAAwB;QACxB,MAAM,UAAU,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAC,iBAAiB;QAE9D,IAAI,SAAS;YACX,+BAA+B;YAC/B,MAAM,wIAAA,CAAA,iBAAc,CAAC,UAAU,CAAC,AAAC,eAAuB,OAAT;YAC/C,MAAM,wIAAA,CAAA,iBAAc,CAAC,UAAU,CAAC,AAAC,eAAuB,OAAT;YAC/C,MAAM,wIAAA,CAAA,iBAAc,CAAC,UAAU,CAAC,AAAC,sBAA8B,OAAT;QACxD;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO;IACT;AACF;AAMO,eAAe,eAAe,QAAgB;IACnD,IAAI,CAAC,YAAY,aAAkB,aAAa,OAAO;IAEvD,IAAI;QACF,MAAM,WAAW,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAA8B,iBAAiB,CAAC;QAC7F,OAAO,CAAC,CAAC,QAAQ,CAAC,SAAS;IAC7B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO;IACT;AACF;AAMO,eAAe;IACpB,IAAI;QACF,OAAO,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAA8B,iBAAiB,CAAC;IACrF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oCAAoC;QAClD,OAAO,CAAC;IACV;AACF;AAMO,eAAe,yBAAyB,QAAgB;IAC7D,IAAI,CAAC,YAAY,aAAkB,aAAa,OAAO;IAEvD,IAAI;QACF,4BAA4B;QAC5B,MAAM,aAAa,MAAM,eAAe;QACxC,IAAI,YAAY,OAAO;QAEvB,4BAA4B;QAC5B,MAAM,MAAM,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAgB,AAAC,eAAuB,OAAT,WAAY;QACnF,MAAM,aAAa,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAgB,AAAC,eAAuB,OAAT,WAAY;QAC1F,MAAM,oBAAoB,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO,CAAgB,AAAC,sBAA8B,OAAT,WAAY;QAExG,yCAAyC;QACzC,IAAI,QAAQ,QAAQ,eAAe,QAAQ,sBAAsB,MAAM;YACrE,MAAM,UAAuB;gBAC3B,KAAK,OAAO;gBACZ,YAAY,cAAc;gBAC1B,mBAAmB,qBAAqB;gBACxC,aAAa,IAAI,OAAO,WAAW;YACrC;YAEA,MAAM,UAAU,MAAM,oBAAoB,UAAU;YAEpD,kDAAkD;YAClD,IAAI,SAAS;gBACX,MAAM,wIAAA,CAAA,iBAAc,CAAC,UAAU,CAAC,AAAC,eAAuB,OAAT;gBAC/C,MAAM,wIAAA,CAAA,iBAAc,CAAC,UAAU,CAAC,AAAC,eAAuB,OAAT;gBAC/C,MAAM,wIAAA,CAAA,iBAAc,CAAC,UAAU,CAAC,AAAC,sBAA8B,OAAT;YACxD;YAEA,OAAO;QACT;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wCAAwC;QACtD,OAAO;IACT;AACF;AAMO,eAAe;IACpB,IAAI,WAAW;IACf,IAAI,SAAS;IAEb,IAAI;QACF,uBAAuB;QACvB,MAAM,UAAU,MAAM,wIAAA,CAAA,iBAAc,CAAC,OAAO;QAE5C,8CAA8C;QAC9C,MAAM,YAAY,IAAI;QAEtB,QAAQ,OAAO,CAAC,CAAA;YACd,MAAM,WAAW,IAAI,KAAK,CAAC;YAC3B,MAAM,WAAW,IAAI,KAAK,CAAC;YAC3B,MAAM,aAAa,IAAI,KAAK,CAAC;YAE7B,IAAI,UAAU,UAAU,GAAG,CAAC,QAAQ,CAAC,EAAE;YACvC,IAAI,UAAU,UAAU,GAAG,CAAC,QAAQ,CAAC,EAAE;YACvC,IAAI,YAAY,UAAU,GAAG,CAAC,UAAU,CAAC,EAAE;QAC7C;QAEA,oBAAoB;QACpB,KAAK,MAAM,YAAY,UAAW;YAChC,MAAM,UAAU,MAAM,yBAAyB;YAC/C,IAAI,SAAS;gBACX;YACF,OAAO;gBACL;YACF;QACF;QAEA,QAAQ,GAAG,CAAC,AAAC,+BAAoD,OAAtB,UAAS,eAAoB,OAAP,QAAO;QACxE,OAAO;YAAE;YAAU;QAAO;IAC5B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,OAAO;YAAE;YAAU;QAAO;IAC5B;AACF","debugId":null}},
    {"offset": {"line": 935, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/buyers/my-orders/OrderHeader.tsx"],"sourcesContent":["// src/components/buyers/my-orders/OrderHeader.tsx\r\n'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Settings, Star } from 'lucide-react';\r\nimport { Order } from '@/context/WalletContext';\r\nimport { OrderStyles } from '@/utils/orderUtils';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\ninterface OrderHeaderProps {\r\n  order: Order;\r\n  type: 'auction' | 'direct' | 'custom';\r\n  styles: OrderStyles;\r\n}\r\n\r\nexport default function OrderHeader({ order, type, styles }: OrderHeaderProps) {\r\n  const isCustom = type === 'custom';\r\n  const isAuction = type === 'auction';\r\n\r\n  const [imageSrc, setImageSrc] = useState<string>('');\r\n  const [imageLoaded, setImageLoaded] = useState(false);\r\n  const [imageError, setImageError] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setImageLoaded(false);\r\n    setImageError(false);\r\n\r\n    if (!order.imageUrl || order.imageUrl === 'undefined' || order.imageUrl === 'null') {\r\n      const placeholder = `https://via.placeholder.com/150/1a1a1a/ff950e?text=${encodeURIComponent(\r\n        (order.title || '').substring(0, 10)\r\n      )}`;\r\n      setImageSrc(placeholder);\r\n      setImageLoaded(true);\r\n      return;\r\n    }\r\n\r\n    const imageUrl = order.imageUrl.trim();\r\n\r\n    if (imageUrl.startsWith('data:image/')) {\r\n      setImageSrc(imageUrl);\r\n      setImageLoaded(true);\r\n      return;\r\n    }\r\n\r\n    if (imageUrl.includes('cloudinary.com') || imageUrl.includes('res.cloudinary.com')) {\r\n      setImageSrc(imageUrl);\r\n      return;\r\n    }\r\n\r\n    if (imageUrl.startsWith('http://') || imageUrl.startsWith('https://')) {\r\n      setImageSrc(imageUrl);\r\n      return;\r\n    }\r\n\r\n    if (imageUrl.startsWith('/')) {\r\n      setImageSrc(imageUrl);\r\n      return;\r\n    }\r\n\r\n    setImageSrc(imageUrl);\r\n  }, [order.imageUrl, order.title]);\r\n\r\n  const handleImageLoad = () => {\r\n    setImageLoaded(true);\r\n    setImageError(false);\r\n  };\r\n\r\n  const handleImageError = () => {\r\n    setImageError(true);\r\n    const fallbackUrl = `https://via.placeholder.com/150/1a1a1a/ff950e?text=${encodeURIComponent(\r\n      (order.title || '').substring(0, 10)\r\n    )}`;\r\n    if (imageSrc !== fallbackUrl) {\r\n      setImageSrc(fallbackUrl);\r\n      setImageLoaded(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col lg:flex-row gap-6 items-start\">\r\n      {/* Product Image or Custom Request Icon */}\r\n      <div className=\"relative\">\r\n        {isCustom ? (\r\n          <div className=\"w-24 h-24 bg-gradient-to-br from-blue-900/30 to-cyan-900/30 rounded-xl border-2 border-blue-500/30 flex items-center justify-center shadow-lg\">\r\n            <Settings className=\"w-10 h-10 text-blue-400\" />\r\n          </div>\r\n        ) : (\r\n          <div className=\"relative w-24 h-24\">\r\n            {!imageLoaded && !imageError && imageSrc && !imageSrc.startsWith('data:') && (\r\n              <div className=\"absolute inset-0 bg-gray-700 rounded-xl border-2 border-gray-600 animate-pulse\" />\r\n            )}\r\n            {imageSrc && (\r\n              <img\r\n                src={imageSrc}\r\n                alt={order.title}\r\n                className={`w-24 h-24 object-cover rounded-xl border-2 border-gray-600 shadow-lg transition-opacity duration-200 ${\r\n                  imageLoaded || imageSrc.startsWith('data:') ? 'opacity-100' : 'opacity-0'\r\n                }`}\r\n                onLoad={handleImageLoad}\r\n                onError={handleImageError}\r\n              />\r\n            )}\r\n            {!imageSrc && (\r\n              <div className=\"w-24 h-24 bg-gradient-to-br from-gray-800 to-gray-700 rounded-xl border-2 border-gray-600 flex items-center justify-center shadow-lg\">\r\n                <div className=\"text-center\">\r\n                  <div className=\"text-3xl font-bold text-gray-500 mb-1\">\r\n                    {(order.title || '?').charAt(0).toUpperCase()}\r\n                  </div>\r\n                  <div className=\"text-xs text-gray-500\">No Image</div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n        {styles.badgeContent}\r\n      </div>\r\n\r\n      {/* Order Title and Price */}\r\n      <div className=\"flex-1 min-w-0\">\r\n        <div className=\"flex items-start justify-between mb-3\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <h3 className=\"font-bold text-xl text-white truncate\">\r\n              <SecureMessageDisplay content={order.title} allowBasicFormatting={false} as=\"span\" />\r\n            </h3>\r\n            {isAuction && <Star className=\"w-5 h-5 text-purple-400 flex-shrink-0\" />}\r\n            {isCustom && <Settings className=\"w-5 h-5 text-blue-400 flex-shrink-0\" />}\r\n          </div>\r\n\r\n          <div className=\"bg-[#ff950e]/10 border border-[#ff950e]/30 rounded-lg px-3 py-2 ml-4\">\r\n            <div className=\"text-xs text-[#ff950e]/80 font-medium text-center\">Total Paid</div>\r\n            <div className=\"text-[#ff950e] font-bold text-lg text-center\">\r\n              ${(order.markedUpPrice || order.price).toFixed(2)}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"text-gray-300 text-sm mb-4 line-clamp-2\">\r\n          <SecureMessageDisplay content={order.description} allowBasicFormatting={false} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1209, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/utils/orderUtils.tsx"],"sourcesContent":["// src/utils/orderUtils.tsx\r\nimport React from 'react';\r\nimport { \r\n  Clock, \r\n  Package, \r\n  Truck, \r\n  CheckCircle,\r\n  Gavel,\r\n  Settings,\r\n  Star\r\n} from 'lucide-react';\r\n\r\nexport interface OrderStyles {\r\n  borderStyle: string;\r\n  gradientStyle: string;\r\n  badgeContent: React.ReactNode | null;\r\n  accentColor: string;\r\n}\r\n\r\nexport function getOrderStyles(type: 'auction' | 'direct' | 'custom'): OrderStyles {\r\n  switch (type) {\r\n    case 'auction':\r\n      return {\r\n        borderStyle: 'border-purple-500/30 hover:border-purple-400/50',\r\n        gradientStyle: 'from-purple-900/10 via-gray-900/50 to-blue-900/10',\r\n        accentColor: '#a855f7',\r\n        badgeContent: (\r\n          <span className=\"absolute -top-2 -right-2 bg-gradient-to-r from-purple-500 to-purple-400 text-white text-xs px-2 py-1 rounded-full font-bold shadow-lg flex items-center\">\r\n            <Gavel className=\"w-3 h-3 mr-1\" />\r\n            Auction\r\n          </span>\r\n        ),\r\n      };\r\n    case 'custom':\r\n      return {\r\n        borderStyle: 'border-blue-500/30 hover:border-blue-400/50',\r\n        gradientStyle: 'from-blue-900/10 via-gray-900/50 to-cyan-900/10',\r\n        accentColor: '#3b82f6',\r\n        badgeContent: (\r\n          <span className=\"absolute -top-2 -right-2 bg-gradient-to-r from-blue-500 to-cyan-400 text-white text-xs px-2 py-1 rounded-full font-bold shadow-lg flex items-center\">\r\n            <Settings className=\"w-3 h-3 mr-1\" />\r\n            Custom\r\n          </span>\r\n        ),\r\n      };\r\n    default:\r\n      return {\r\n        borderStyle: 'border-gray-700 hover:border-[#ff950e]/50',\r\n        gradientStyle: 'from-gray-900/50 via-black/30 to-gray-800/50',\r\n        accentColor: '#ff950e',\r\n        badgeContent: null,\r\n      };\r\n  }\r\n}\r\n\r\nexport function formatOrderDate(dateString: string): string {\r\n  return new Date(dateString).toLocaleDateString('en-US', {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: 'numeric'\r\n  });\r\n}\r\n\r\nexport function getShippingStatusBadge(status?: string) {\r\n  if (!status || status === 'pending') {\r\n    return (\r\n      <div className=\"inline-flex items-center px-3 py-1.5 rounded-lg text-xs font-bold bg-yellow-500/20 text-yellow-300 border border-yellow-500/30\">\r\n        <Clock className=\"w-3 h-3 mr-1\" />\r\n        Awaiting Shipment\r\n      </div>\r\n    );\r\n  } else if (status === 'processing') {\r\n    return (\r\n      <div className=\"inline-flex items-center px-3 py-1.5 rounded-lg text-xs font-bold bg-blue-500/20 text-blue-300 border border-blue-500/30\">\r\n        <Package className=\"w-3 h-3 mr-1\" />\r\n        Preparing\r\n      </div>\r\n    );\r\n  } else if (status === 'shipped') {\r\n    return (\r\n      <div className=\"inline-flex items-center px-3 py-1.5 rounded-lg text-xs font-bold bg-green-500/20 text-green-300 border border-green-500/30\">\r\n        <Truck className=\"w-3 h-3 mr-1\" />\r\n        Shipped\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  // Add default return\r\n  return null;\r\n}\r\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;;;;AAE3B;AAAA;AAAA;AAAA;AAAA;;;AAiBO,SAAS,eAAe,IAAqC;IAClE,OAAQ;QACN,KAAK;YACH,OAAO;gBACL,aAAa;gBACb,eAAe;gBACf,aAAa;gBACb,4BACE,6LAAC;oBAAK,WAAU;;sCACd,6LAAC,uMAAA,CAAA,QAAK;4BAAC,WAAU;;;;;;wBAAiB;;;;;;;YAIxC;QACF,KAAK;YACH,OAAO;gBACL,aAAa;gBACb,eAAe;gBACf,aAAa;gBACb,4BACE,6LAAC;oBAAK,WAAU;;sCACd,6LAAC,6MAAA,CAAA,WAAQ;4BAAC,WAAU;;;;;;wBAAiB;;;;;;;YAI3C;QACF;YACE,OAAO;gBACL,aAAa;gBACb,eAAe;gBACf,aAAa;gBACb,cAAc;YAChB;IACJ;AACF;AAEO,SAAS,gBAAgB,UAAkB;IAChD,OAAO,IAAI,KAAK,YAAY,kBAAkB,CAAC,SAAS;QACtD,MAAM;QACN,OAAO;QACP,KAAK;IACP;AACF;AAEO,SAAS,uBAAuB,MAAe;IACpD,IAAI,CAAC,UAAU,WAAW,WAAW;QACnC,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC,uMAAA,CAAA,QAAK;oBAAC,WAAU;;;;;;gBAAiB;;;;;;;IAIxC,OAAO,IAAI,WAAW,cAAc;QAClC,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC,2MAAA,CAAA,UAAO;oBAAC,WAAU;;;;;;gBAAiB;;;;;;;IAI1C,OAAO,IAAI,WAAW,WAAW;QAC/B,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC,uMAAA,CAAA,QAAK;oBAAC,WAAU;;;;;;gBAAiB;;;;;;;IAIxC;IAEA,qBAAqB;IACrB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 1355, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/buyers/my-orders/OrderDetails.tsx"],"sourcesContent":["// src/components/buyers/my-orders/OrderDetails.tsx\r\n'use client';\r\n\r\nimport React from 'react';\r\nimport { Calendar, Tag, MapPin, CheckCircle, Eye, ChevronUp, Settings } from 'lucide-react';\r\nimport { Order } from '@/context/WalletContext';\r\nimport { formatOrderDate, getShippingStatusBadge } from '@/utils/orderUtils';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\ninterface OrderDetailsProps {\r\n  order: Order;\r\n  type: 'auction' | 'direct' | 'custom';\r\n  hasDeliveryAddress: boolean;\r\n  isExpanded: boolean;\r\n  onOpenAddressModal: (orderId: string) => void;\r\n  onToggleExpanded: (orderId: string | null) => void;\r\n}\r\n\r\nexport default function OrderDetails({\r\n  order,\r\n  type,\r\n  hasDeliveryAddress,\r\n  isExpanded,\r\n  onOpenAddressModal,\r\n  onToggleExpanded,\r\n}: OrderDetailsProps) {\r\n  const isAuction = type === 'auction';\r\n  const isCustom = type === 'custom';\r\n\r\n  return (\r\n    <>\r\n      {/* Order Meta Info */}\r\n      <div className=\"flex flex-wrap items-center gap-4 mb-4\">\r\n        <div className=\"flex items-center gap-2 text-sm text-gray-400\">\r\n          <Calendar className=\"w-4 h-4\" />\r\n          <span>{formatOrderDate(order.date)}</span>\r\n        </div>\r\n        \r\n        {order.tags && order.tags.length > 0 && (\r\n          <div className=\"flex items-center gap-1\">\r\n            <Tag className=\"w-4 h-4 text-gray-400\" />\r\n            <div className=\"text-xs text-gray-400\">\r\n              {order.tags.slice(0, 2).map((tag, index) => (\r\n                <span key={index}>\r\n                  {index > 0 && ', '}\r\n                  <SecureMessageDisplay \r\n                    content={tag}\r\n                    allowBasicFormatting={false}\r\n                    as=\"span\"\r\n                    className=\"inline\"\r\n                  />\r\n                </span>\r\n              ))}\r\n              {order.tags.length > 2 && '...'}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Order Type Specific Information */}\r\n      {isAuction && (\r\n        <div className=\"bg-purple-900/30 p-3 rounded-lg mb-4 border border-purple-700/50\">\r\n          <p className=\"text-sm font-semibold text-purple-300 mb-1\">\r\n            🏆 Winning bid: ${order.finalBid?.toFixed(2) || order.price.toFixed(2)}\r\n          </p>\r\n          <p className=\"text-xs text-purple-400/80\">\r\n            Auction won on {formatOrderDate(order.date)}\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      {isCustom && (\r\n        <div className=\"bg-blue-900/30 p-3 rounded-lg mb-4 border border-blue-700/50\">\r\n          <div className=\"flex items-center gap-2 mb-2\">\r\n            <Settings className=\"w-4 h-4 text-blue-400\" />\r\n            <p className=\"text-sm font-semibold text-blue-300\">Custom Request Order</p>\r\n          </div>\r\n          <p className=\"text-xs text-blue-400/80\">\r\n            Fulfilled on {formatOrderDate(order.date)}\r\n          </p>\r\n          {order.originalRequestId && (\r\n            <p className=\"text-xs text-blue-400 mt-1 font-mono\">\r\n              ID: {order.originalRequestId.slice(0, 8)}...\r\n            </p>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Bottom Row - Status and Actions */}\r\n      <div className=\"flex flex-wrap items-center justify-between gap-3\">\r\n        <div className=\"flex flex-wrap items-center gap-3\">\r\n          {getShippingStatusBadge(order.shippingStatus)}\r\n          \r\n          {hasDeliveryAddress ? (\r\n            <div className=\"flex items-center gap-2 bg-green-900/30 px-3 py-1.5 rounded-lg border border-green-700/50\">\r\n              <CheckCircle className=\"w-4 h-4 text-green-400\" />\r\n              <span className=\"text-green-300 text-xs font-medium\">Address confirmed</span>\r\n            </div>\r\n          ) : (\r\n            <button\r\n              onClick={() => onOpenAddressModal(order.id)}\r\n              className=\"flex items-center gap-2 bg-yellow-900/30 hover:bg-yellow-800/50 px-3 py-1.5 rounded-lg border border-yellow-700/50 hover:border-yellow-600 text-yellow-300 hover:text-yellow-200 transition-all text-xs font-medium\"\r\n            >\r\n              <MapPin className=\"w-4 h-4\" />\r\n              Add Address\r\n            </button>\r\n          )}\r\n        </div>\r\n        \r\n        <button\r\n          className=\"flex items-center gap-2 text-[#ff950e] bg-[#ff950e]/10 hover:bg-[#ff950e]/20 border border-[#ff950e]/30 hover:border-[#ff950e]/50 font-semibold px-4 py-2 rounded-lg transition-all text-sm\"\r\n          onClick={() => onToggleExpanded(isExpanded ? null : order.id)}\r\n        >\r\n          {isExpanded ? (\r\n            <>\r\n              <ChevronUp className=\"w-4 h-4\" />\r\n              Hide Details\r\n            </>\r\n          ) : (\r\n            <>\r\n              <Eye className=\"w-4 h-4\" />\r\n              View Details\r\n            </>\r\n          )}\r\n        </button>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,mDAAmD;;;;;AAInD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AANA;;;;;AAiBe,SAAS,aAAa,KAOjB;QAPiB,EACnC,KAAK,EACL,IAAI,EACJ,kBAAkB,EAClB,UAAU,EACV,kBAAkB,EAClB,gBAAgB,EACE,GAPiB;QA6CP;IArC5B,MAAM,YAAY,SAAS;IAC3B,MAAM,WAAW,SAAS;IAE1B,qBACE;;0BAEE,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,6MAAA,CAAA,WAAQ;gCAAC,WAAU;;;;;;0CACpB,6LAAC;0CAAM,CAAA,GAAA,8HAAA,CAAA,kBAAe,AAAD,EAAE,MAAM,IAAI;;;;;;;;;;;;oBAGlC,MAAM,IAAI,IAAI,MAAM,IAAI,CAAC,MAAM,GAAG,mBACjC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,mMAAA,CAAA,MAAG;gCAAC,WAAU;;;;;;0CACf,6LAAC;gCAAI,WAAU;;oCACZ,MAAM,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK,sBAChC,6LAAC;;gDACE,QAAQ,KAAK;8DACd,6LAAC,mJAAA,CAAA,uBAAoB;oDACnB,SAAS;oDACT,sBAAsB;oDACtB,IAAG;oDACH,WAAU;;;;;;;2CANH;;;;;oCAUZ,MAAM,IAAI,CAAC,MAAM,GAAG,KAAK;;;;;;;;;;;;;;;;;;;YAOjC,2BACC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAE,WAAU;;4BAA6C;4BACtC,EAAA,kBAAA,MAAM,QAAQ,cAAd,sCAAA,gBAAgB,OAAO,CAAC,OAAM,MAAM,KAAK,CAAC,OAAO,CAAC;;;;;;;kCAEtE,6LAAC;wBAAE,WAAU;;4BAA6B;4BACxB,CAAA,GAAA,8HAAA,CAAA,kBAAe,AAAD,EAAE,MAAM,IAAI;;;;;;;;;;;;;YAK/C,0BACC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,6MAAA,CAAA,WAAQ;gCAAC,WAAU;;;;;;0CACpB,6LAAC;gCAAE,WAAU;0CAAsC;;;;;;;;;;;;kCAErD,6LAAC;wBAAE,WAAU;;4BAA2B;4BACxB,CAAA,GAAA,8HAAA,CAAA,kBAAe,AAAD,EAAE,MAAM,IAAI;;;;;;;oBAEzC,MAAM,iBAAiB,kBACtB,6LAAC;wBAAE,WAAU;;4BAAuC;4BAC7C,MAAM,iBAAiB,CAAC,KAAK,CAAC,GAAG;4BAAG;;;;;;;;;;;;;0BAOjD,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;4BACZ,CAAA,GAAA,8HAAA,CAAA,yBAAsB,AAAD,EAAE,MAAM,cAAc;4BAE3C,mCACC,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,8NAAA,CAAA,cAAW;wCAAC,WAAU;;;;;;kDACvB,6LAAC;wCAAK,WAAU;kDAAqC;;;;;;;;;;;qDAGvD,6LAAC;gCACC,SAAS,IAAM,mBAAmB,MAAM,EAAE;gCAC1C,WAAU;;kDAEV,6LAAC,6MAAA,CAAA,SAAM;wCAAC,WAAU;;;;;;oCAAY;;;;;;;;;;;;;kCAMpC,6LAAC;wBACC,WAAU;wBACV,SAAS,IAAM,iBAAiB,aAAa,OAAO,MAAM,EAAE;kCAE3D,2BACC;;8CACE,6LAAC,mNAAA,CAAA,YAAS;oCAAC,WAAU;;;;;;gCAAY;;yDAInC;;8CACE,6LAAC,mMAAA,CAAA,MAAG;oCAAC,WAAU;;;;;;gCAAY;;;;;;;;;;;;;;;;AAQzC;KA9GwB","debugId":null}},
    {"offset": {"line": 1651, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/StarRating.tsx"],"sourcesContent":["// src/components/StarRating.tsx\r\n'use client';\r\n\r\nimport { Star } from 'lucide-react';\r\nimport { useCallback, useState } from 'react';\r\nimport { sanitizeNumber } from '@/utils/security/sanitization';\r\n\r\ninterface StarRatingProps {\r\n  rating: number;\r\n  onRatingChange?: (rating: number) => void;\r\n  interactive?: boolean;\r\n  size?: 'sm' | 'md' | 'lg';\r\n}\r\n\r\nconst MIN_RATING = 0;\r\nconst MAX_RATING = 5;\r\nconst VALID_STARS = [1, 2, 3, 4, 5] as const;\r\n\r\nexport default function StarRating({\r\n  rating,\r\n  onRatingChange,\r\n  interactive = false,\r\n  size = 'md',\r\n}: StarRatingProps) {\r\n  // Validate and sanitize the rating\r\n  const sanitizedRating = sanitizeNumber(rating, MIN_RATING, MAX_RATING, 0);\r\n\r\n  // Prevent rapid clicks\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n  const sizeClasses = {\r\n    sm: 'w-4 h-4',\r\n    md: 'w-5 h-5',\r\n    lg: 'w-6 h-6',\r\n  } as const;\r\n\r\n  const containerClasses = {\r\n    sm: 'gap-0.5',\r\n    md: 'gap-1',\r\n    lg: 'gap-1.5',\r\n  } as const;\r\n\r\n  const safeSize = (['sm', 'md', 'lg'] as const).includes(size) ? size : 'md';\r\n\r\n  const handleRatingChange = useCallback(\r\n    (star: number) => {\r\n      if (!interactive || !onRatingChange || isProcessing) return;\r\n\r\n      // Validate star value\r\n      if (!(VALID_STARS as readonly number[]).includes(star)) {\r\n        if (process.env.NODE_ENV === 'development') {\r\n          console.error('Invalid star rating:', star);\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Prevent rapid clicks\r\n      setIsProcessing(true);\r\n\r\n      try {\r\n        onRatingChange(star);\r\n      } catch (error) {\r\n        if (process.env.NODE_ENV === 'development') {\r\n          console.error('Error updating rating:', error);\r\n        }\r\n      } finally {\r\n        // Reset processing state after a short delay\r\n        setTimeout(() => setIsProcessing(false), 300);\r\n      }\r\n    },\r\n    [interactive, onRatingChange, isProcessing]\r\n  );\r\n\r\n  return (\r\n    <div className={`flex ${containerClasses[safeSize]}`} role=\"radiogroup\" aria-label=\"Star rating\">\r\n      {VALID_STARS.map((star) => (\r\n        <button\r\n          key={star}\r\n          type=\"button\"\r\n          onClick={() => handleRatingChange(star)}\r\n          disabled={!interactive || isProcessing}\r\n          className={`${\r\n            interactive && !isProcessing ? 'cursor-pointer' : 'cursor-default'\r\n          } focus:outline-none focus:ring-2 focus:ring-[#ff950e] focus:ring-opacity-50 rounded`}\r\n          aria-label={`Rate ${star} star${star !== 1 ? 's' : ''}`}\r\n          aria-pressed={star <= sanitizedRating}\r\n          role=\"radio\"\r\n          aria-checked={star === Math.round(sanitizedRating)}\r\n        >\r\n          <Star\r\n            className={`${sizeClasses[safeSize]} ${\r\n              star <= sanitizedRating ? 'fill-[#ff950e] text-[#ff950e]' : 'fill-gray-300 text-gray-300'\r\n            } ${interactive && !isProcessing ? 'hover:fill-[#ff950e] hover:text-[#ff950e] transition-colors' : ''}`}\r\n          />\r\n        </button>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,gCAAgC;;;;AA8DpB;;AA3DZ;AACA;AACA;;;AAJA;;;;AAaA,MAAM,aAAa;AACnB,MAAM,aAAa;AACnB,MAAM,cAAc;IAAC;IAAG;IAAG;IAAG;IAAG;CAAE;AAEpB,SAAS,WAAW,KAKjB;QALiB,EACjC,MAAM,EACN,cAAc,EACd,cAAc,KAAK,EACnB,OAAO,IAAI,EACK,GALiB;;IAMjC,mCAAmC;IACnC,MAAM,kBAAkB,CAAA,GAAA,2IAAA,CAAA,iBAAc,AAAD,EAAE,QAAQ,YAAY,YAAY;IAEvE,uBAAuB;IACvB,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,MAAM,cAAc;QAClB,IAAI;QACJ,IAAI;QACJ,IAAI;IACN;IAEA,MAAM,mBAAmB;QACvB,IAAI;QACJ,IAAI;QACJ,IAAI;IACN;IAEA,MAAM,WAAW,AAAC;QAAC;QAAM;QAAM;KAAK,CAAW,QAAQ,CAAC,QAAQ,OAAO;IAEvE,MAAM,qBAAqB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;sDACnC,CAAC;YACC,IAAI,CAAC,eAAe,CAAC,kBAAkB,cAAc;YAErD,sBAAsB;YACtB,IAAI,CAAC,AAAC,YAAkC,QAAQ,CAAC,OAAO;gBACtD,wCAA4C;oBAC1C,QAAQ,KAAK,CAAC,wBAAwB;gBACxC;gBACA;YACF;YAEA,uBAAuB;YACvB,gBAAgB;YAEhB,IAAI;gBACF,eAAe;YACjB,EAAE,OAAO,OAAO;gBACd,wCAA4C;oBAC1C,QAAQ,KAAK,CAAC,0BAA0B;gBAC1C;YACF,SAAU;gBACR,6CAA6C;gBAC7C;kEAAW,IAAM,gBAAgB;iEAAQ;YAC3C;QACF;qDACA;QAAC;QAAa;QAAgB;KAAa;IAG7C,qBACE,6LAAC;QAAI,WAAW,AAAC,QAAkC,OAA3B,gBAAgB,CAAC,SAAS;QAAI,MAAK;QAAa,cAAW;kBAChF,YAAY,GAAG,CAAC,CAAC,qBAChB,6LAAC;gBAEC,MAAK;gBACL,SAAS,IAAM,mBAAmB;gBAClC,UAAU,CAAC,eAAe;gBAC1B,WAAW,AAAC,GAEX,OADC,eAAe,CAAC,eAAe,mBAAmB,kBACnD;gBACD,cAAY,AAAC,QAAmB,OAAZ,MAAK,SAA6B,OAAtB,SAAS,IAAI,MAAM;gBACnD,gBAAc,QAAQ;gBACtB,MAAK;gBACL,gBAAc,SAAS,KAAK,KAAK,CAAC;0BAElC,cAAA,6LAAC,qMAAA,CAAA,OAAI;oBACH,WAAW,AAAC,GACV,OADY,WAAW,CAAC,SAAS,EAAC,KAEhC,OADF,QAAQ,kBAAkB,kCAAkC,+BAC7D,KAAqG,OAAlG,eAAe,CAAC,eAAe,gEAAgE;;;;;;eAfhG;;;;;;;;;;AAqBf;GAhFwB;KAAA","debugId":null}},
    {"offset": {"line": 1771, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/buyers/my-orders/ReviewSection.tsx"],"sourcesContent":["// src/components/buyers/my-orders/ReviewSection.tsx\r\n'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { Star, Check, AlertCircle, ChevronDown, ChevronUp } from 'lucide-react';\r\nimport { useReviews } from '@/context/ReviewContext';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useToast } from '@/context/ToastContext';\r\nimport { SecureTextarea } from '@/components/ui/SecureInput';\r\nimport StarRating from '@/components/StarRating';\r\nimport { sanitizeStrict } from '@/utils/security/sanitization';\r\nimport { Order } from '@/context/WalletContext';\r\n\r\ninterface ReviewSectionProps {\r\n  order: Order;\r\n}\r\n\r\nexport default function ReviewSection({ order }: ReviewSectionProps) {\r\n  const { user } = useAuth();\r\n  const { addReview, hasReviewed, isLoading } = useReviews();\r\n  const { showToast } = useToast();\r\n  \r\n  const [showReviewForm, setShowReviewForm] = useState(false);\r\n  const [hasBeenReviewed, setHasBeenReviewed] = useState(false);\r\n  const [canReview, setCanReview] = useState(false);\r\n  const [rating, setRating] = useState(5);\r\n  const [comment, setComment] = useState('');\r\n  const [asDescribed, setAsDescribed] = useState(true);\r\n  const [fastShipping, setFastShipping] = useState(true);\r\n  const [wouldBuyAgain, setWouldBuyAgain] = useState(true);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [validationError, setValidationError] = useState<string | undefined>();\r\n\r\n  // Check if order can be reviewed\r\n  useEffect(() => {\r\n    const checkReviewStatus = async () => {\r\n      // Only buyers can review\r\n      if (!user || order.buyer !== user.username) {\r\n        setCanReview(false);\r\n        return;\r\n      }\r\n\r\n      // Generate order ID if not present (for compatibility)\r\n      const orderId = order.id || `order_${order.buyer}_${order.seller}_${Date.now()}`;\r\n\r\n      // Check if already reviewed\r\n      const reviewed = await hasReviewed(orderId);\r\n      setHasBeenReviewed(reviewed);\r\n\r\n      // Can review if order is shipped or delivered and not already reviewed\r\n      // FIXED: Cast to any to handle the delivered status that might not be in the type definition\r\n      const canDoReview = (order.shippingStatus === 'shipped' || (order.shippingStatus as any) === 'delivered') && !reviewed;\r\n      setCanReview(canDoReview);\r\n    };\r\n\r\n    checkReviewStatus();\r\n  }, [order, user, hasReviewed]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    // Validate\r\n    if (!comment || comment.trim().length < 10) {\r\n      setValidationError('Review must be at least 10 characters');\r\n      return;\r\n    }\r\n\r\n    if (comment.length > 500) {\r\n      setValidationError('Review must be less than 500 characters');\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    setValidationError(undefined);\r\n\r\n    try {\r\n      // Generate order ID if not present\r\n      const orderId = order.id || `order_${order.buyer}_${order.seller}_${Date.now()}`;\r\n      \r\n      const success = await addReview(order.seller, orderId, {\r\n        rating,\r\n        comment: comment.trim(),\r\n        asDescribed,\r\n        fastShipping,\r\n        wouldBuyAgain,\r\n      });\r\n\r\n      if (success) {\r\n        showToast({\r\n          type: 'success',\r\n          title: 'Review submitted successfully!',\r\n        });\r\n        setHasBeenReviewed(true);\r\n        setShowReviewForm(false);\r\n      } else {\r\n        setValidationError('Failed to submit review. Please try again.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error submitting review:', error);\r\n      setValidationError('An error occurred. Please try again.');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // Don't show anything if not the buyer\r\n  if (!user || order.buyer !== user.username) {\r\n    return null;\r\n  }\r\n\r\n  // Show review submitted state\r\n  if (hasBeenReviewed) {\r\n    return (\r\n      <div className=\"mt-4 p-4 bg-green-900/20 border border-green-600/50 rounded-lg\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <Check className=\"w-5 h-5 text-green-500\" />\r\n          <span className=\"text-green-400 font-semibold\">Review Submitted</span>\r\n        </div>\r\n        <p className=\"text-xs text-green-300/80 mt-1\">\r\n          Thank you for reviewing this seller!\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Show review button or form\r\n  if (!canReview) {\r\n    // Order not eligible for review yet\r\n    if (order.shippingStatus === 'pending' || order.shippingStatus === 'processing') {\r\n      return (\r\n        <div className=\"mt-4 p-3 bg-gray-800/30 border border-gray-700/50 rounded-lg\">\r\n          <div className=\"flex items-center gap-2 text-gray-500\">\r\n            <AlertCircle className=\"w-4 h-4\" />\r\n            <span className=\"text-xs\">You can review this order after it's shipped</span>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    return null;\r\n  }\r\n\r\n  if (!showReviewForm) {\r\n    return (\r\n      <div className=\"mt-4\">\r\n        <button\r\n          onClick={() => setShowReviewForm(true)}\r\n          className=\"w-full bg-gradient-to-r from-purple-600/20 to-purple-500/20 hover:from-purple-600/30 hover:to-purple-500/30 text-purple-300 py-2.5 px-4 rounded-lg font-medium transition flex items-center justify-center gap-2 border border-purple-600/30 hover:border-purple-500/50\"\r\n        >\r\n          <Star className=\"w-4 h-4\" />\r\n          Write a Review\r\n          <ChevronDown className=\"w-4 h-4\" />\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"mt-4 p-5 bg-purple-900/10 border border-purple-700/30 rounded-lg\">\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <h3 className=\"text-base font-bold text-white flex items-center gap-2\">\r\n          <Star className=\"w-4 h-4 text-yellow-500\" />\r\n          Write a Review\r\n        </h3>\r\n        <button\r\n          onClick={() => setShowReviewForm(false)}\r\n          className=\"text-gray-400 hover:text-white transition p-1\"\r\n          aria-label=\"Close review form\"\r\n        >\r\n          <ChevronUp className=\"w-4 h-4\" />\r\n        </button>\r\n      </div>\r\n\r\n      <form onSubmit={handleSubmit} className=\"space-y-3\">\r\n        {/* Rating */}\r\n        <div>\r\n          <label className=\"block text-xs font-medium text-gray-300 mb-1.5\">\r\n            Overall Rating\r\n          </label>\r\n          <div className=\"flex items-center gap-3\">\r\n            <select\r\n              value={rating}\r\n              onChange={(e) => setRating(Number(e.target.value))}\r\n              className=\"bg-black/50 border border-gray-700 rounded-lg px-2.5 py-1.5 text-white text-sm focus:outline-none focus:ring-2 focus:ring-purple-500\"\r\n              disabled={isSubmitting}\r\n            >\r\n              {[5, 4, 3, 2, 1].map((r) => (\r\n                <option key={r} value={r}>\r\n                  {r} Star{r > 1 ? 's' : ''}\r\n                </option>\r\n              ))}\r\n            </select>\r\n            <StarRating rating={rating} size=\"sm\" />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Comment */}\r\n        <div>\r\n          <SecureTextarea\r\n            label=\"Your Review\"\r\n            value={comment}\r\n            onChange={(value) => setComment(sanitizeStrict(value))}\r\n            placeholder=\"Share your experience...\"\r\n            rows={3}\r\n            maxLength={500}\r\n            characterCount={true}\r\n            sanitize={true}\r\n            sanitizer={sanitizeStrict}\r\n            disabled={isSubmitting}\r\n            error={validationError}\r\n            className=\"!text-sm\"\r\n          />\r\n        </div>\r\n\r\n        {/* Additional options */}\r\n        <div className=\"flex flex-wrap gap-3\">\r\n          <label className=\"flex items-center gap-1.5 cursor-pointer\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={asDescribed}\r\n              onChange={(e) => setAsDescribed(e.target.checked)}\r\n              disabled={isSubmitting}\r\n              className=\"w-3.5 h-3.5 text-purple-600 bg-black border-gray-600 rounded focus:ring-purple-500\"\r\n            />\r\n            <span className=\"text-xs text-gray-300\">As described</span>\r\n          </label>\r\n          \r\n          <label className=\"flex items-center gap-1.5 cursor-pointer\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={fastShipping}\r\n              onChange={(e) => setFastShipping(e.target.checked)}\r\n              disabled={isSubmitting}\r\n              className=\"w-3.5 h-3.5 text-purple-600 bg-black border-gray-600 rounded focus:ring-purple-500\"\r\n            />\r\n            <span className=\"text-xs text-gray-300\">Fast shipping</span>\r\n          </label>\r\n          \r\n          <label className=\"flex items-center gap-1.5 cursor-pointer\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={wouldBuyAgain}\r\n              onChange={(e) => setWouldBuyAgain(e.target.checked)}\r\n              disabled={isSubmitting}\r\n              className=\"w-3.5 h-3.5 text-purple-600 bg-black border-gray-600 rounded focus:ring-purple-500\"\r\n            />\r\n            <span className=\"text-xs text-gray-300\">Would buy again</span>\r\n          </label>\r\n        </div>\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex gap-2 pt-2\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setShowReviewForm(false)}\r\n            disabled={isSubmitting}\r\n            className=\"flex-1 bg-gray-700/50 hover:bg-gray-700/70 text-white py-2 px-3 rounded-lg font-medium transition disabled:opacity-50 text-sm\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            type=\"submit\"\r\n            disabled={isSubmitting || !comment || comment.trim().length < 10}\r\n            className=\"flex-1 bg-gradient-to-r from-purple-600 to-purple-500 hover:from-purple-500 hover:to-purple-400 text-white py-2 px-3 rounded-lg font-semibold transition disabled:opacity-50 disabled:cursor-not-allowed text-sm\"\r\n          >\r\n            {isSubmitting ? 'Submitting...' : 'Submit Review'}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,oDAAoD;;;;;AAGpD;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;AATA;;;;;;;;;AAgBe,SAAS,cAAc,KAA6B;QAA7B,EAAE,KAAK,EAAsB,GAA7B;;IACpC,MAAM,EAAE,IAAI,EAAE,GAAG,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;IACvB,MAAM,EAAE,SAAS,EAAE,WAAW,EAAE,SAAS,EAAE,GAAG,CAAA,GAAA,mIAAA,CAAA,aAAU,AAAD;IACvD,MAAM,EAAE,SAAS,EAAE,GAAG,CAAA,GAAA,kIAAA,CAAA,WAAQ,AAAD;IAE7B,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACrD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACnD,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD;IAErD,iCAAiC;IACjC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;mCAAE;YACR,MAAM;6DAAoB;oBACxB,yBAAyB;oBACzB,IAAI,CAAC,QAAQ,MAAM,KAAK,KAAK,KAAK,QAAQ,EAAE;wBAC1C,aAAa;wBACb;oBACF;oBAEA,uDAAuD;oBACvD,MAAM,UAAU,MAAM,EAAE,IAAI,AAAC,SAAuB,OAAf,MAAM,KAAK,EAAC,KAAmB,OAAhB,MAAM,MAAM,EAAC,KAAc,OAAX,KAAK,GAAG;oBAE5E,4BAA4B;oBAC5B,MAAM,WAAW,MAAM,YAAY;oBACnC,mBAAmB;oBAEnB,uEAAuE;oBACvE,6FAA6F;oBAC7F,MAAM,cAAc,CAAC,MAAM,cAAc,KAAK,aAAa,AAAC,MAAM,cAAc,KAAa,WAAW,KAAK,CAAC;oBAC9G,aAAa;gBACf;;YAEA;QACF;kCAAG;QAAC;QAAO;QAAM;KAAY;IAE7B,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAEhB,WAAW;QACX,IAAI,CAAC,WAAW,QAAQ,IAAI,GAAG,MAAM,GAAG,IAAI;YAC1C,mBAAmB;YACnB;QACF;QAEA,IAAI,QAAQ,MAAM,GAAG,KAAK;YACxB,mBAAmB;YACnB;QACF;QAEA,gBAAgB;QAChB,mBAAmB;QAEnB,IAAI;YACF,mCAAmC;YACnC,MAAM,UAAU,MAAM,EAAE,IAAI,AAAC,SAAuB,OAAf,MAAM,KAAK,EAAC,KAAmB,OAAhB,MAAM,MAAM,EAAC,KAAc,OAAX,KAAK,GAAG;YAE5E,MAAM,UAAU,MAAM,UAAU,MAAM,MAAM,EAAE,SAAS;gBACrD;gBACA,SAAS,QAAQ,IAAI;gBACrB;gBACA;gBACA;YACF;YAEA,IAAI,SAAS;gBACX,UAAU;oBACR,MAAM;oBACN,OAAO;gBACT;gBACA,mBAAmB;gBACnB,kBAAkB;YACpB,OAAO;gBACL,mBAAmB;YACrB;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,mBAAmB;QACrB,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,uCAAuC;IACvC,IAAI,CAAC,QAAQ,MAAM,KAAK,KAAK,KAAK,QAAQ,EAAE;QAC1C,OAAO;IACT;IAEA,8BAA8B;IAC9B,IAAI,iBAAiB;QACnB,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,uMAAA,CAAA,QAAK;4BAAC,WAAU;;;;;;sCACjB,6LAAC;4BAAK,WAAU;sCAA+B;;;;;;;;;;;;8BAEjD,6LAAC;oBAAE,WAAU;8BAAiC;;;;;;;;;;;;IAKpD;IAEA,6BAA6B;IAC7B,IAAI,CAAC,WAAW;QACd,oCAAoC;QACpC,IAAI,MAAM,cAAc,KAAK,aAAa,MAAM,cAAc,KAAK,cAAc;YAC/E,qBACE,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC,uNAAA,CAAA,cAAW;4BAAC,WAAU;;;;;;sCACvB,6LAAC;4BAAK,WAAU;sCAAU;;;;;;;;;;;;;;;;;QAIlC;QACA,OAAO;IACT;IAEA,IAAI,CAAC,gBAAgB;QACnB,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBACC,SAAS,IAAM,kBAAkB;gBACjC,WAAU;;kCAEV,6LAAC,qMAAA,CAAA,OAAI;wBAAC,WAAU;;;;;;oBAAY;kCAE5B,6LAAC,uNAAA,CAAA,cAAW;wBAAC,WAAU;;;;;;;;;;;;;;;;;IAI/B;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;;0CACZ,6LAAC,qMAAA,CAAA,OAAI;gCAAC,WAAU;;;;;;4BAA4B;;;;;;;kCAG9C,6LAAC;wBACC,SAAS,IAAM,kBAAkB;wBACjC,WAAU;wBACV,cAAW;kCAEX,cAAA,6LAAC,mNAAA,CAAA,YAAS;4BAAC,WAAU;;;;;;;;;;;;;;;;;0BAIzB,6LAAC;gBAAK,UAAU;gBAAc,WAAU;;kCAEtC,6LAAC;;0CACC,6LAAC;gCAAM,WAAU;0CAAiD;;;;;;0CAGlE,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCACC,OAAO;wCACP,UAAU,CAAC,IAAM,UAAU,OAAO,EAAE,MAAM,CAAC,KAAK;wCAChD,WAAU;wCACV,UAAU;kDAET;4CAAC;4CAAG;4CAAG;4CAAG;4CAAG;yCAAE,CAAC,GAAG,CAAC,CAAC,kBACpB,6LAAC;gDAAe,OAAO;;oDACpB;oDAAE;oDAAM,IAAI,IAAI,MAAM;;+CADZ;;;;;;;;;;kDAKjB,6LAAC,mIAAA,CAAA,UAAU;wCAAC,QAAQ;wCAAQ,MAAK;;;;;;;;;;;;;;;;;;kCAKrC,6LAAC;kCACC,cAAA,6LAAC,0IAAA,CAAA,iBAAc;4BACb,OAAM;4BACN,OAAO;4BACP,UAAU,CAAC,QAAU,WAAW,CAAA,GAAA,2IAAA,CAAA,iBAAc,AAAD,EAAE;4BAC/C,aAAY;4BACZ,MAAM;4BACN,WAAW;4BACX,gBAAgB;4BAChB,UAAU;4BACV,WAAW,2IAAA,CAAA,iBAAc;4BACzB,UAAU;4BACV,OAAO;4BACP,WAAU;;;;;;;;;;;kCAKd,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAM,WAAU;;kDACf,6LAAC;wCACC,MAAK;wCACL,SAAS;wCACT,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,OAAO;wCAChD,UAAU;wCACV,WAAU;;;;;;kDAEZ,6LAAC;wCAAK,WAAU;kDAAwB;;;;;;;;;;;;0CAG1C,6LAAC;gCAAM,WAAU;;kDACf,6LAAC;wCACC,MAAK;wCACL,SAAS;wCACT,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,OAAO;wCACjD,UAAU;wCACV,WAAU;;;;;;kDAEZ,6LAAC;wCAAK,WAAU;kDAAwB;;;;;;;;;;;;0CAG1C,6LAAC;gCAAM,WAAU;;kDACf,6LAAC;wCACC,MAAK;wCACL,SAAS;wCACT,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,OAAO;wCAClD,UAAU;wCACV,WAAU;;;;;;kDAEZ,6LAAC;wCAAK,WAAU;kDAAwB;;;;;;;;;;;;;;;;;;kCAK5C,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCACC,MAAK;gCACL,SAAS,IAAM,kBAAkB;gCACjC,UAAU;gCACV,WAAU;0CACX;;;;;;0CAGD,6LAAC;gCACC,MAAK;gCACL,UAAU,gBAAgB,CAAC,WAAW,QAAQ,IAAI,GAAG,MAAM,GAAG;gCAC9D,WAAU;0CAET,eAAe,kBAAkB;;;;;;;;;;;;;;;;;;;;;;;;AAM9C;GA7PwB;;QACL,iIAAA,CAAA,UAAO;QACsB,mIAAA,CAAA,aAAU;QAClC,kIAAA,CAAA,WAAQ;;;KAHR","debugId":null}},
    {"offset": {"line": 2292, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/buyers/my-orders/ExpandedOrderContent.tsx"],"sourcesContent":["// src/components/buyers/my-orders/ExpandedOrderContent.tsx\r\n'use client';\r\n\r\nimport React from 'react';\r\nimport Link from 'next/link';\r\nimport { MessageCircle, DollarSign, Tag, ExternalLink } from 'lucide-react';\r\nimport { Order } from '@/context/WalletContext';\r\nimport { SecureMessageDisplay, SecureImage } from '@/components/ui/SecureMessageDisplay';\r\nimport { sanitizeUsername } from '@/utils/security/sanitization';\r\nimport ReviewSection from './ReviewSection';\r\n\r\ninterface ExpandedOrderContentProps {\r\n  order: Order;\r\n  type: 'auction' | 'direct' | 'custom';\r\n  sellerProfilePic: string | null;\r\n  isSellerVerified: boolean;\r\n}\r\n\r\nexport default function ExpandedOrderContent({\r\n  order,\r\n  type,\r\n  sellerProfilePic,\r\n  isSellerVerified,\r\n}: ExpandedOrderContentProps) {\r\n  const isCustom = type === 'custom';\r\n  const sanitizedUsername = sanitizeUsername(order.seller);\r\n\r\n  return (\r\n    <div className=\"border-t border-gray-700 bg-black/20 p-6\">\r\n      {/* Seller Info */}\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <Link\r\n          href={`/sellers/${sanitizedUsername}`}\r\n          className=\"flex items-center gap-3 text-white hover:text-[#ff950e] group transition-colors\"\r\n        >\r\n          {sellerProfilePic ? (\r\n            <SecureImage\r\n              src={sellerProfilePic}\r\n              alt={order.seller}\r\n              className=\"w-10 h-10 rounded-full object-cover border-2 border-gray-600 group-hover:border-[#ff950e] transition-colors\"\r\n              fallbackSrc=\"/placeholder-avatar.png\"\r\n            />\r\n          ) : (\r\n            <div className=\"w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center text-white font-bold border-2 border-gray-600 group-hover:border-[#ff950e] transition-colors\">\r\n              {order.seller ? order.seller.charAt(0).toUpperCase() : '?'}\r\n            </div>\r\n          )}\r\n          <div>\r\n            <div className=\"font-semibold\">\r\n              <SecureMessageDisplay \r\n                content={order.seller}\r\n                allowBasicFormatting={false}\r\n                as=\"span\"\r\n              />\r\n            </div>\r\n            <div className=\"text-xs text-gray-400\">View seller profile</div>\r\n          </div>\r\n          \r\n          {isSellerVerified && (\r\n            <div className=\"ml-2\">\r\n              <img src=\"/verification_badge.png\" alt=\"Verified\" className=\"w-5 h-5\" />\r\n            </div>\r\n          )}\r\n          \r\n          <ExternalLink className=\"w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n        </Link>\r\n        \r\n        <Link\r\n          href={`/buyers/messages?thread=${sanitizedUsername}`}\r\n          className=\"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white font-bold px-4 py-2 rounded-lg transition-all shadow-lg\"\r\n        >\r\n          <MessageCircle className=\"w-4 h-4\" />\r\n          Message Seller\r\n        </Link>\r\n      </div>\r\n\r\n      {/* Price Breakdown */}\r\n      <div className=\"bg-gray-800/50 p-4 rounded-xl border border-gray-700\">\r\n        <h4 className=\"font-semibold text-white mb-3 flex items-center\">\r\n          <DollarSign className=\"w-5 h-5 mr-2 text-[#ff950e]\" />\r\n          Payment Details\r\n        </h4>\r\n        \r\n        <div className=\"space-y-2\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <span className=\"text-gray-300\">Item Price:</span>\r\n            <span className=\"text-white font-semibold\">${order.price.toFixed(2)}</span>\r\n          </div>\r\n          \r\n          <div className=\"flex justify-between items-center\">\r\n            <span className=\"text-gray-300\">Platform Fee (10%):</span>\r\n            <span className=\"text-gray-300\">${((order.markedUpPrice || order.price) - order.price).toFixed(2)}</span>\r\n          </div>\r\n          \r\n          {order.tierCreditAmount && order.tierCreditAmount > 0 && (\r\n            <div className=\"flex justify-between items-center text-green-400\">\r\n              <span>Seller Tier Bonus:</span>\r\n              <span>+${order.tierCreditAmount.toFixed(2)}</span>\r\n            </div>\r\n          )}\r\n          \r\n          <div className=\"border-t border-gray-600 pt-2 mt-2\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-white font-semibold\">Total Paid:</span>\r\n              <span className=\"text-[#ff950e] font-bold text-lg\">\r\n                ${(order.markedUpPrice || order.price).toFixed(2)}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Custom Request Tags */}\r\n      {isCustom && order.tags && order.tags.length > 0 && (\r\n        <div className=\"mt-4\">\r\n          <h4 className=\"font-semibold text-white mb-2 flex items-center\">\r\n            <Tag className=\"w-4 h-4 mr-2 text-blue-400\" />\r\n            Request Tags\r\n          </h4>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {order.tags.map((tag: string, idx: number) => (\r\n              <span\r\n                key={idx}\r\n                className=\"bg-blue-900/30 text-blue-200 text-xs px-3 py-1 rounded-full border border-blue-700/50\"\r\n              >\r\n                <SecureMessageDisplay \r\n                  content={tag}\r\n                  allowBasicFormatting={false}\r\n                  as=\"span\"\r\n                />\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Review Section - NEW */}\r\n      <ReviewSection order={order} />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2655, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/buyers/my-orders/OrderCard.tsx"],"sourcesContent":["// src/components/buyers/my-orders/OrderCard.tsx\r\n'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport { Order } from '@/types/order'; // Use the existing Order type from your types\r\nimport { useListings } from '@/context/ListingContext';\r\nimport { getUserProfilePic } from '@/utils/profileUtils';\r\nimport OrderHeader from './OrderHeader';\r\nimport OrderDetails from './OrderDetails';\r\nimport ExpandedOrderContent from './ExpandedOrderContent';\r\nimport { formatOrderDate, getOrderStyles } from '@/utils/orderUtils';\r\n\r\ninterface OrderCardProps {\r\n  order: Order;\r\n  type: 'auction' | 'direct' | 'custom';\r\n  isExpanded: boolean;\r\n  onToggleExpanded: (orderId: string | null) => void;\r\n  onOpenAddressModal: (orderId: string) => void;\r\n}\r\n\r\nexport default function OrderCard({\r\n  order,\r\n  type,\r\n  isExpanded,\r\n  onToggleExpanded,\r\n  onOpenAddressModal,\r\n}: OrderCardProps) {\r\n  const { users } = useListings();\r\n  const styles = getOrderStyles(type);\r\n  \r\n  // State for async profile pic\r\n  const [sellerProfilePic, setSellerProfilePic] = useState<string | null>(null);\r\n  \r\n  // Get seller info\r\n  const sellerUser = users?.[order.seller ?? ''];\r\n  const isSellerVerified = sellerUser?.verified || sellerUser?.verificationStatus === 'verified';\r\n  const hasDeliveryAddress = !!order.deliveryAddress;\r\n\r\n  // Load seller profile pic asynchronously\r\n  useEffect(() => {\r\n    const loadProfilePic = async () => {\r\n      if (order.seller) {\r\n        const pic = await getUserProfilePic(order.seller);\r\n        setSellerProfilePic(pic);\r\n      }\r\n    };\r\n    loadProfilePic();\r\n  }, [order.seller]);\r\n\r\n  // CRITICAL FIX: Ensure order has an ID (handle both _id and id fields from backend)\r\n  const orderId = order.id || (order as any)._id || `order-${Date.now()}`;\r\n\r\n  // Show special status for auction orders without address\r\n  const needsAddress = order.wasAuction && !hasDeliveryAddress;\r\n\r\n  return (\r\n    <div\r\n      className={`relative border rounded-2xl bg-gradient-to-br overflow-hidden shadow-xl hover:shadow-2xl transition-all duration-300 ${styles.gradientStyle} ${styles.borderStyle}`}\r\n    >\r\n      {/* Auction Won Badge */}\r\n      {order.wasAuction && needsAddress && (\r\n        <div className=\"absolute top-4 right-4 z-10\">\r\n          <div className=\"bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold animate-pulse\">\r\n            🏆 Won! Add Address\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Order Header */}\r\n      <div className=\"p-6\">\r\n        <OrderHeader\r\n          order={order}\r\n          type={type}\r\n          styles={styles}\r\n        />\r\n        \r\n        <OrderDetails\r\n          order={order}\r\n          type={type}\r\n          hasDeliveryAddress={hasDeliveryAddress}\r\n          isExpanded={isExpanded}\r\n          onOpenAddressModal={onOpenAddressModal}\r\n          onToggleExpanded={() => onToggleExpanded(orderId)}\r\n        />\r\n      </div>\r\n\r\n      {/* Expanded Content */}\r\n      {isExpanded && (\r\n        <ExpandedOrderContent\r\n          order={order}\r\n          type={type}\r\n          sellerProfilePic={sellerProfilePic}\r\n          isSellerVerified={isSellerVerified}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,gDAAgD;;;;;AAGhD;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAVA;;;;;;;;AAoBe,SAAS,UAAU,KAMjB;QANiB,EAChC,KAAK,EACL,IAAI,EACJ,UAAU,EACV,gBAAgB,EAChB,kBAAkB,EACH,GANiB;;IAOhC,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,oIAAA,CAAA,cAAW,AAAD;IAC5B,MAAM,SAAS,CAAA,GAAA,8HAAA,CAAA,iBAAc,AAAD,EAAE;IAE9B,8BAA8B;IAC9B,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;QAG7C;IAD3B,kBAAkB;IAClB,MAAM,aAAa,kBAAA,4BAAA,KAAO,CAAC,CAAA,gBAAA,MAAM,MAAM,cAAZ,2BAAA,gBAAgB,GAAG;IAC9C,MAAM,mBAAmB,CAAA,uBAAA,iCAAA,WAAY,QAAQ,KAAI,CAAA,uBAAA,iCAAA,WAAY,kBAAkB,MAAK;IACpF,MAAM,qBAAqB,CAAC,CAAC,MAAM,eAAe;IAElD,yCAAyC;IACzC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;+BAAE;YACR,MAAM;sDAAiB;oBACrB,IAAI,MAAM,MAAM,EAAE;wBAChB,MAAM,MAAM,MAAM,CAAA,GAAA,+HAAA,CAAA,oBAAiB,AAAD,EAAE,MAAM,MAAM;wBAChD,oBAAoB;oBACtB;gBACF;;YACA;QACF;8BAAG;QAAC,MAAM,MAAM;KAAC;IAEjB,oFAAoF;IACpF,MAAM,UAAU,MAAM,EAAE,IAAI,AAAC,MAAc,GAAG,IAAI,AAAC,SAAmB,OAAX,KAAK,GAAG;IAEnE,yDAAyD;IACzD,MAAM,eAAe,MAAM,UAAU,IAAI,CAAC;IAE1C,qBACE,6LAAC;QACC,WAAW,AAAC,wHAA+I,OAAxB,OAAO,aAAa,EAAC,KAAsB,OAAnB,OAAO,WAAW;;YAG5K,MAAM,UAAU,IAAI,8BACnB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;8BAAiF;;;;;;;;;;;0BAOpG,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,8JAAA,CAAA,UAAW;wBACV,OAAO;wBACP,MAAM;wBACN,QAAQ;;;;;;kCAGV,6LAAC,+JAAA,CAAA,UAAY;wBACX,OAAO;wBACP,MAAM;wBACN,oBAAoB;wBACpB,YAAY;wBACZ,oBAAoB;wBACpB,kBAAkB,IAAM,iBAAiB;;;;;;;;;;;;YAK5C,4BACC,6LAAC,uKAAA,CAAA,UAAoB;gBACnB,OAAO;gBACP,MAAM;gBACN,kBAAkB;gBAClB,kBAAkB;;;;;;;;;;;;AAK5B;GA7EwB;;QAOJ,oIAAA,CAAA,cAAW;;;KAPP","debugId":null}},
    {"offset": {"line": 2791, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/buyers/my-orders/OrderSections.tsx"],"sourcesContent":["// src/components/buyers/my-orders/OrderSections.tsx\r\n'use client';\r\n\r\nimport React from 'react';\r\nimport { ShoppingBag, Settings, Gavel } from 'lucide-react';\r\nimport OrderCard from './OrderCard';\r\nimport { Order } from '@/context/WalletContext';\r\n\r\ninterface OrderSectionsProps {\r\n  directOrders: Order[];\r\n  customRequestOrders: Order[];\r\n  auctionOrders: Order[];\r\n  expandedOrder: string | null;\r\n  onToggleExpanded: (orderId: string | null) => void;\r\n  onOpenAddressModal: (orderId: string) => void;\r\n}\r\n\r\nexport default function OrderSections({\r\n  directOrders,\r\n  customRequestOrders,\r\n  auctionOrders,\r\n  expandedOrder,\r\n  onToggleExpanded,\r\n  onOpenAddressModal,\r\n}: OrderSectionsProps) {\r\n  return (\r\n    <>\r\n      {/* Direct Purchases - TOP PRIORITY */}\r\n      <section className=\"mb-12\">\r\n        <h2 className=\"text-2xl font-bold mb-6 flex items-center text-white\">\r\n          <div className=\"bg-gradient-to-r from-[#ff950e] to-[#e0850d] p-2 rounded-lg mr-3 shadow-lg\">\r\n            <ShoppingBag className=\"w-6 h-6 text-black\" />\r\n          </div>\r\n          Direct Purchases ({directOrders.length})\r\n        </h2>\r\n        {directOrders.length === 0 ? (\r\n          <div className=\"text-center py-16 bg-gray-900/30 rounded-2xl border border-gray-700\">\r\n            <ShoppingBag className=\"w-16 h-16 text-gray-600 mx-auto mb-4\" />\r\n            <p className=\"text-gray-400 text-xl mb-2\">No direct purchases yet</p>\r\n            <p className=\"text-gray-500\">Items you buy directly from the browse page will appear here</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-6\">\r\n            {directOrders.map((order) => (\r\n              <OrderCard\r\n                key={`${order.id}-${order.date}`}\r\n                order={order}\r\n                type=\"direct\"\r\n                isExpanded={expandedOrder === order.id}\r\n                onToggleExpanded={onToggleExpanded}\r\n                onOpenAddressModal={onOpenAddressModal}\r\n              />\r\n            ))}\r\n          </div>\r\n        )}\r\n      </section>\r\n\r\n      {/* Custom Request Orders Section - SECOND */}\r\n      {customRequestOrders.length > 0 && (\r\n        <section className=\"mb-12\">\r\n          <h2 className=\"text-2xl font-bold mb-6 flex items-center text-white\">\r\n            <div className=\"bg-gradient-to-r from-blue-600 to-cyan-500 p-2 rounded-lg mr-3 shadow-lg\">\r\n              <Settings className=\"w-6 h-6 text-white\" />\r\n            </div>\r\n            Custom Request Orders ({customRequestOrders.length})\r\n          </h2>\r\n          <div className=\"space-y-6\">\r\n            {customRequestOrders.map((order) => (\r\n              <OrderCard\r\n                key={`${order.id}-${order.date}`}\r\n                order={order}\r\n                type=\"custom\"\r\n                isExpanded={expandedOrder === order.id}\r\n                onToggleExpanded={onToggleExpanded}\r\n                onOpenAddressModal={onOpenAddressModal}\r\n              />\r\n            ))}\r\n          </div>\r\n        </section>\r\n      )}\r\n\r\n      {/* Auction Purchases Section - LAST */}\r\n      {auctionOrders.length > 0 && (\r\n        <section className=\"mb-12\">\r\n          <h2 className=\"text-2xl font-bold mb-6 flex items-center text-white\">\r\n            <div className=\"bg-gradient-to-r from-purple-600 to-purple-500 p-2 rounded-lg mr-3 shadow-lg\">\r\n              <Gavel className=\"w-6 h-6 text-white\" />\r\n            </div>\r\n            Auction Purchases ({auctionOrders.length})\r\n          </h2>\r\n          <div className=\"space-y-6\">\r\n            {auctionOrders.map((order) => (\r\n              <OrderCard\r\n                key={`${order.id}-${order.date}`}\r\n                order={order}\r\n                type=\"auction\"\r\n                isExpanded={expandedOrder === order.id}\r\n                onToggleExpanded={onToggleExpanded}\r\n                onOpenAddressModal={onOpenAddressModal}\r\n              />\r\n            ))}\r\n          </div>\r\n        </section>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,oDAAoD;;;;;AAIpD;AAAA;AAAA;AACA;AAJA;;;;AAgBe,SAAS,cAAc,KAOjB;QAPiB,EACpC,YAAY,EACZ,mBAAmB,EACnB,aAAa,EACb,aAAa,EACb,gBAAgB,EAChB,kBAAkB,EACC,GAPiB;IAQpC,qBACE;;0BAEE,6LAAC;gBAAQ,WAAU;;kCACjB,6LAAC;wBAAG,WAAU;;0CACZ,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,uNAAA,CAAA,cAAW;oCAAC,WAAU;;;;;;;;;;;4BACnB;4BACa,aAAa,MAAM;4BAAC;;;;;;;oBAExC,aAAa,MAAM,KAAK,kBACvB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,uNAAA,CAAA,cAAW;gCAAC,WAAU;;;;;;0CACvB,6LAAC;gCAAE,WAAU;0CAA6B;;;;;;0CAC1C,6LAAC;gCAAE,WAAU;0CAAgB;;;;;;;;;;;6CAG/B,6LAAC;wBAAI,WAAU;kCACZ,aAAa,GAAG,CAAC,CAAC,sBACjB,6LAAC,4JAAA,CAAA,UAAS;gCAER,OAAO;gCACP,MAAK;gCACL,YAAY,kBAAkB,MAAM,EAAE;gCACtC,kBAAkB;gCAClB,oBAAoB;+BALf,AAAC,GAAc,OAAZ,MAAM,EAAE,EAAC,KAAc,OAAX,MAAM,IAAI;;;;;;;;;;;;;;;;YAavC,oBAAoB,MAAM,GAAG,mBAC5B,6LAAC;gBAAQ,WAAU;;kCACjB,6LAAC;wBAAG,WAAU;;0CACZ,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,6MAAA,CAAA,WAAQ;oCAAC,WAAU;;;;;;;;;;;4BAChB;4BACkB,oBAAoB,MAAM;4BAAC;;;;;;;kCAErD,6LAAC;wBAAI,WAAU;kCACZ,oBAAoB,GAAG,CAAC,CAAC,sBACxB,6LAAC,4JAAA,CAAA,UAAS;gCAER,OAAO;gCACP,MAAK;gCACL,YAAY,kBAAkB,MAAM,EAAE;gCACtC,kBAAkB;gCAClB,oBAAoB;+BALf,AAAC,GAAc,OAAZ,MAAM,EAAE,EAAC,KAAc,OAAX,MAAM,IAAI;;;;;;;;;;;;;;;;YAavC,cAAc,MAAM,GAAG,mBACtB,6LAAC;gBAAQ,WAAU;;kCACjB,6LAAC;wBAAG,WAAU;;0CACZ,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,uMAAA,CAAA,QAAK;oCAAC,WAAU;;;;;;;;;;;4BACb;4BACc,cAAc,MAAM;4BAAC;;;;;;;kCAE3C,6LAAC;wBAAI,WAAU;kCACZ,cAAc,GAAG,CAAC,CAAC,sBAClB,6LAAC,4JAAA,CAAA,UAAS;gCAER,OAAO;gCACP,MAAK;gCACL,YAAY,kBAAkB,MAAM,EAAE;gCACtC,kBAAkB;gCAClB,oBAAoB;+BALf,AAAC,GAAc,OAAZ,MAAM,EAAE,EAAC,KAAc,OAAX,MAAM,IAAI;;;;;;;;;;;;;;;;;;AAa9C;KAzFwB","debugId":null}},
    {"offset": {"line": 3013, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/buyers/my-orders/EmptyOrdersState.tsx"],"sourcesContent":["// src/components/buyers/my-orders/EmptyOrdersState.tsx\r\n'use client';\r\n\r\nimport React from 'react';\r\nimport Link from 'next/link';\r\nimport { Package, MessageCircle } from 'lucide-react';\r\n\r\nexport default function EmptyOrdersState() {\r\n  return (\r\n    <div className=\"text-center py-20 bg-[#1a1a1a] rounded-2xl border border-gray-800\">\r\n      <Package className=\"w-24 h-24 text-gray-600 mx-auto mb-8\" />\r\n      <h3 className=\"text-2xl font-bold text-gray-400 mb-4\">No orders yet</h3>\r\n      <p className=\"text-gray-500 text-lg mb-8 max-w-md mx-auto\">\r\n        Your purchases from direct sales, auctions, and custom requests will appear here once you start shopping.\r\n      </p>\r\n      <div className=\"flex flex-wrap justify-center gap-4\">\r\n        <Link\r\n          href=\"/browse\"\r\n          className=\"group relative inline-flex items-center gap-2 bg-transparent text-[#ff950e] font-semibold px-8 py-3 rounded-xl transition-all duration-300 border-2 border-[#ff950e]/70 hover:border-[#ff950e] hover:bg-[#ff950e]/10 hover:-translate-y-1 shadow-[0_4px_0_0] shadow-[#ff950e]/50 hover:shadow-[0_6px_0_0] hover:shadow-[#ff950e]/70\"\r\n        >\r\n          <Package className=\"w-5 h-5 transition-transform duration-300 group-hover:scale-110\" />\r\n          <span className=\"relative\">\r\n            Browse Listings\r\n            <span className=\"absolute -bottom-1 left-0 w-0 h-0.5 bg-[#ff950e] transition-all duration-300 group-hover:w-full\"></span>\r\n          </span>\r\n        </Link>\r\n        \r\n        <Link\r\n          href=\"/buyers/messages\"\r\n          className=\"group relative inline-flex items-center gap-2 bg-transparent text-[#ff950e] font-semibold px-8 py-3 rounded-xl transition-all duration-300 border-2 border-[#ff950e]/70 hover:border-[#ff950e] hover:bg-[#ff950e]/10 hover:-translate-y-1 shadow-[0_4px_0_0] shadow-[#ff950e]/50 hover:shadow-[0_6px_0_0] hover:shadow-[#ff950e]/70\"\r\n        >\r\n          <MessageCircle className=\"w-5 h-5 transition-transform duration-300 group-hover:rotate-12\" />\r\n          <span className=\"relative\">\r\n            Send Custom Requests\r\n            <span className=\"absolute -bottom-1 left-0 w-0 h-0.5 bg-[#ff950e] transition-all duration-300 group-hover:w-full\"></span>\r\n          </span>\r\n        </Link>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,uDAAuD;;;;;AAIvD;AACA;AAAA;AAJA;;;;AAMe,SAAS;IACtB,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,2MAAA,CAAA,UAAO;gBAAC,WAAU;;;;;;0BACnB,6LAAC;gBAAG,WAAU;0BAAwC;;;;;;0BACtD,6LAAC;gBAAE,WAAU;0BAA8C;;;;;;0BAG3D,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,+JAAA,CAAA,UAAI;wBACH,MAAK;wBACL,WAAU;;0CAEV,6LAAC,2MAAA,CAAA,UAAO;gCAAC,WAAU;;;;;;0CACnB,6LAAC;gCAAK,WAAU;;oCAAW;kDAEzB,6LAAC;wCAAK,WAAU;;;;;;;;;;;;;;;;;;kCAIpB,6LAAC,+JAAA,CAAA,UAAI;wBACH,MAAK;wBACL,WAAU;;0CAEV,6LAAC,2NAAA,CAAA,gBAAa;gCAAC,WAAU;;;;;;0CACzB,6LAAC;gCAAK,WAAU;;oCAAW;kDAEzB,6LAAC;wCAAK,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM5B;KAjCwB","debugId":null}},
    {"offset": {"line": 3148, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/ui/SecureForm.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { FormEvent, useState, useEffect } from 'react';\r\nimport { AlertCircle, ShieldCheck, Loader2 } from 'lucide-react';\r\nimport { getRateLimiter, getRateLimitMessage } from '@/utils/security/rate-limiter';\r\n\r\ninterface SecureFormProps {\r\n  children: React.ReactNode;\r\n  onSubmit: (e: FormEvent) => Promise<void> | void;\r\n  className?: string;\r\n  rateLimitKey?: string;\r\n  rateLimitConfig?: { maxAttempts: number; windowMs: number };\r\n  showSecurityBadge?: boolean;\r\n  csrfProtection?: boolean;\r\n  isRateLimited?: boolean;\r\n  rateLimitWaitTime?: number;\r\n}\r\n\r\n/**\r\n * Secure form wrapper with CSRF protection and rate limiting\r\n */\r\nexport const SecureForm: React.FC<SecureFormProps> = ({\r\n  children,\r\n  onSubmit,\r\n  className = '',\r\n  rateLimitKey,\r\n  rateLimitConfig,\r\n  showSecurityBadge = false,\r\n  csrfProtection = true,\r\n  isRateLimited = false,\r\n  rateLimitWaitTime = 0,\r\n}) => {\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [rateLimitError, setRateLimitError] = useState<string | null>(null);\r\n  const [csrfToken, setCsrfToken] = useState<string>('');\r\n\r\n  // Initialize CSRF token\r\n  useEffect(() => {\r\n    if (csrfProtection && typeof window !== 'undefined') {\r\n      const tokenManager = new CSRFTokenManager();\r\n      const token = tokenManager.generateToken();\r\n      setCsrfToken(token);\r\n    }\r\n  }, [csrfProtection]);\r\n\r\n  // Update rate limit error when props change\r\n  useEffect(() => {\r\n    if (isRateLimited && rateLimitWaitTime > 0) {\r\n      setRateLimitError(\r\n        `Too many attempts. Please wait ${rateLimitWaitTime} seconds before trying again.`\r\n      );\r\n    } else {\r\n      setRateLimitError(null);\r\n    }\r\n  }, [isRateLimited, rateLimitWaitTime]);\r\n\r\n  const handleSubmit = async (e: FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    // Don't submit if externally rate limited\r\n    if (isRateLimited) {\r\n      return;\r\n    }\r\n\r\n    // Clear previous errors\r\n    setRateLimitError(null);\r\n\r\n    // Check rate limit if configured and not already checked externally\r\n    if (rateLimitKey && rateLimitConfig && !isRateLimited) {\r\n      const limiter = getRateLimiter();\r\n      const result = limiter.check(rateLimitKey, rateLimitConfig);\r\n\r\n      if (!result.allowed) {\r\n        setRateLimitError(getRateLimitMessage(result));\r\n        return;\r\n      }\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    try {\r\n      await onSubmit(e);\r\n    } catch (error) {\r\n      console.error('Form submission error:', error);\r\n\r\n      // If it's a rate limit error, reset the attempt\r\n      if (rateLimitKey && error instanceof Error && error.message.includes('Rate limit')) {\r\n        const limiter = getRateLimiter();\r\n        limiter.reset(rateLimitKey);\r\n      }\r\n\r\n      throw error;\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className={className} noValidate>\r\n      {/* CSRF Token (hidden) */}\r\n      {csrfProtection && csrfToken && <input type=\"hidden\" name=\"_csrf\" value={csrfToken} />}\r\n\r\n      {/* Security Badge */}\r\n      {showSecurityBadge && (\r\n        <div className=\"mb-4 flex items-center gap-2 text-xs text-gray-500\">\r\n          <ShieldCheck className=\"w-4 h-4\" />\r\n          <span>Secure form with protection against attacks</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Rate Limit Error - only show if not handled externally */}\r\n      {rateLimitError && !isRateLimited && (\r\n        <div className=\"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg\">\r\n          <div className=\"flex items-center gap-2 text-sm text-red-400\">\r\n            <AlertCircle className=\"w-4 h-4 flex-shrink-0\" />\r\n            <span>{rateLimitError}</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Form Content */}\r\n      {children}\r\n    </form>\r\n  );\r\n};\r\n\r\n/**\r\n * Field wrapper for consistent styling and error handling\r\n */\r\ninterface SecureFieldWrapperProps {\r\n  children: React.ReactNode;\r\n  error?: string;\r\n  touched?: boolean;\r\n  className?: string;\r\n}\r\n\r\nexport const SecureFieldWrapper: React.FC<SecureFieldWrapperProps> = ({\r\n  children,\r\n  error,\r\n  touched,\r\n  className = '',\r\n}) => (\r\n  <div className={className}>\r\n    {children}\r\n    {touched && error && (\r\n      <div className=\"mt-1 flex items-center gap-1 text-xs text-red-400\">\r\n        <AlertCircle className=\"w-3 h-3 flex-shrink-0\" />\r\n        <span>{error}</span>\r\n      </div>\r\n    )}\r\n  </div>\r\n);\r\n\r\n/**\r\n * Secure submit button with loading state\r\n */\r\ninterface SecureSubmitButtonProps {\r\n  children: React.ReactNode;\r\n  isLoading?: boolean;\r\n  isDisabled?: boolean;\r\n  className?: string;\r\n  loadingText?: string;\r\n  type?: 'submit' | 'button';\r\n  disabled?: boolean;\r\n}\r\n\r\nexport const SecureSubmitButton: React.FC<SecureSubmitButtonProps> = ({\r\n  children,\r\n  isLoading = false,\r\n  isDisabled = false,\r\n  disabled = false,\r\n  className = '',\r\n  loadingText = 'Processing...',\r\n  type = 'submit',\r\n}) => (\r\n  <button\r\n    type={type}\r\n    disabled={isLoading || isDisabled || disabled}\r\n    className={`relative ${className} ${\r\n      isLoading || isDisabled || disabled ? 'opacity-50 cursor-not-allowed' : ''\r\n    }`}\r\n  >\r\n    {isLoading ? (\r\n      <span className=\"flex items-center justify-center gap-2\">\r\n        <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n        {loadingText}\r\n      </span>\r\n    ) : (\r\n      children\r\n    )}\r\n  </button>\r\n);\r\n\r\n/**\r\n * CSRF Token Manager for form protection\r\n */\r\nclass CSRFTokenManager {\r\n  private tokenKey = 'csrf_token';\r\n  private tokenExpiry = 60 * 60 * 1000; // 1 hour\r\n\r\n  generateToken(): string {\r\n    const token = this.createSecureToken();\r\n    const expiry = Date.now() + this.tokenExpiry;\r\n\r\n    if (typeof window !== 'undefined') {\r\n      sessionStorage.setItem(this.tokenKey, JSON.stringify({ token, expiry }));\r\n    }\r\n\r\n    return token;\r\n  }\r\n\r\n  validateToken(token: string): boolean {\r\n    if (typeof window === 'undefined') return false;\r\n\r\n    try {\r\n      const stored = sessionStorage.getItem(this.tokenKey);\r\n      if (!stored) return false;\r\n\r\n      const { token: storedToken, expiry } = JSON.parse(stored);\r\n\r\n      if (Date.now() > expiry) {\r\n        sessionStorage.removeItem(this.tokenKey);\r\n        return false;\r\n      }\r\n\r\n      return token === storedToken;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private createSecureToken(): string {\r\n    const array = new Uint8Array(32);\r\n    crypto.getRandomValues(array);\r\n    return Array.from(array, (byte) => byte.toString(16).padStart(2, '0')).join('');\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3427, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/AddressConfirmationModal.tsx"],"sourcesContent":["// src/components/AddressConfirmationModal.tsx\r\n'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { X, MapPin, CheckCircle } from 'lucide-react';\r\nimport { SecureInput, SecureTextarea } from '@/components/ui/SecureInput';\r\nimport { SecureForm } from '@/components/ui/SecureForm';\r\nimport type { DeliveryAddress } from '@/types/order';\r\n\r\n// Re-export for backward compatibility\r\nexport type { DeliveryAddress };\r\n\r\ntype AddressConfirmationModalProps = {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onConfirm: (address: DeliveryAddress) => void;\r\n  existingAddress?: DeliveryAddress | null;\r\n  orderId: string;\r\n};\r\n\r\n// Validation function for postal codes\r\nconst isValidPostalCode = (postalCode: string, country: string): boolean => {\r\n  const patterns: { [key: string]: RegExp } = {\r\n    'United States': /^\\d{5}(-\\d{4})?$/,\r\n    Canada: /^[A-Za-z]\\d[A-Za-z][ -]?\\d[A-Za-z]\\d$/,\r\n    'United Kingdom': /^[A-Za-z]{1,2}\\d{1,2}[A-Za-z]?\\s?\\d[A-Za-z]{2}$/,\r\n    Australia: /^\\d{4}$/,\r\n    Default: /^[\\w\\s-]{3,10}$/,\r\n  };\r\n\r\n  const pattern = patterns[country] || patterns.Default;\r\n  return pattern.test(postalCode);\r\n};\r\n\r\n// Validation function for names and city/country\r\nconst isValidName = (name: string): boolean => {\r\n  const validNamePattern = /^[a-zA-Z\\s\\-'.]{2,100}$/;\r\n  return validNamePattern.test(name);\r\n};\r\n\r\nexport default function AddressConfirmationModal({\r\n  isOpen,\r\n  onClose,\r\n  onConfirm,\r\n  existingAddress,\r\n  orderId,\r\n}: AddressConfirmationModalProps): React.ReactElement | null {\r\n  const [address, setAddress] = useState<DeliveryAddress>({\r\n    fullName: '',\r\n    addressLine1: '',\r\n    addressLine2: '',\r\n    city: '',\r\n    state: '',\r\n    postalCode: '',\r\n    country: '',\r\n    specialInstructions: '',\r\n  });\r\n\r\n  const [errors, setErrors] = useState<Record<string, string>>({});\r\n  const [touched, setTouched] = useState<Record<string, boolean>>({});\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [submitSuccess, setSubmitSuccess] = useState(false);\r\n\r\n  // Load existing address if available\r\n  useEffect(() => {\r\n    if (existingAddress) {\r\n      setAddress({\r\n        fullName: existingAddress.fullName || '',\r\n        addressLine1: existingAddress.addressLine1 || '',\r\n        addressLine2: existingAddress.addressLine2 || '',\r\n        city: existingAddress.city || '',\r\n        state: existingAddress.state || '',\r\n        postalCode: existingAddress.postalCode || '',\r\n        country: existingAddress.country || '',\r\n        specialInstructions: existingAddress.specialInstructions || '',\r\n      });\r\n    }\r\n  }, [existingAddress]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const validateForm = (): boolean => {\r\n    const newErrors: Record<string, string> = {};\r\n\r\n    // Validate full name\r\n    if (!address.fullName.trim()) {\r\n      newErrors.fullName = 'Full name is required';\r\n    } else if (!isValidName(address.fullName)) {\r\n      newErrors.fullName = 'Please enter a valid name (letters, spaces, hyphens, and apostrophes only)';\r\n    }\r\n\r\n    // Validate address line 1\r\n    if (!address.addressLine1.trim()) {\r\n      newErrors.addressLine1 = 'Address line 1 is required';\r\n    } else if (address.addressLine1.length < 5) {\r\n      newErrors.addressLine1 = 'Address must be at least 5 characters long';\r\n    }\r\n\r\n    // Validate city\r\n    if (!address.city.trim()) {\r\n      newErrors.city = 'City is required';\r\n    } else if (!isValidName(address.city)) {\r\n      newErrors.city = 'Please enter a valid city name';\r\n    }\r\n\r\n    // Validate state/province\r\n    if (!address.state.trim()) {\r\n      newErrors.state = 'State/Province is required';\r\n    }\r\n\r\n    // Validate postal code\r\n    if (!address.postalCode.trim()) {\r\n      newErrors.postalCode = 'Postal/ZIP code is required';\r\n    } else if (!isValidPostalCode(address.postalCode, address.country)) {\r\n      newErrors.postalCode = 'Please enter a valid postal/ZIP code for your country';\r\n    }\r\n\r\n    // Validate country\r\n    if (!address.country.trim()) {\r\n      newErrors.country = 'Country is required';\r\n    } else if (!isValidName(address.country)) {\r\n      newErrors.country = 'Please enter a valid country name';\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    // Mark all fields as touched\r\n    setTouched({\r\n      fullName: true,\r\n      addressLine1: true,\r\n      city: true,\r\n      state: true,\r\n      postalCode: true,\r\n      country: true,\r\n    });\r\n\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n\r\n    if (validateForm()) {\r\n      setIsSubmitting(true);\r\n\r\n      // Create address object for submission (SecureInput already sanitizes)\r\n      const submissionAddress: DeliveryAddress = {\r\n        fullName: address.fullName,\r\n        addressLine1: address.addressLine1,\r\n        addressLine2: address.addressLine2 || undefined,\r\n        city: address.city,\r\n        state: address.state,\r\n        postalCode: address.postalCode,\r\n        country: address.country,\r\n        specialInstructions: address.specialInstructions || undefined,\r\n      };\r\n\r\n      // Simulate a slight delay for better UX\r\n      setTimeout(() => {\r\n        onConfirm(submissionAddress);\r\n        setSubmitSuccess(true);\r\n\r\n        setTimeout(() => {\r\n          onClose();\r\n          setIsSubmitting(false);\r\n          setSubmitSuccess(false);\r\n          setTouched({});\r\n        }, 1000);\r\n      }, 800);\r\n    }\r\n  };\r\n\r\n  const handleChange =\r\n    (field: keyof DeliveryAddress) =>\r\n    (value: string): void => {\r\n      setAddress((prev) => ({\r\n        ...prev,\r\n        [field]: value,\r\n      }));\r\n\r\n      // Clear error for this field if it exists\r\n      if (errors[field as string]) {\r\n        setErrors((prev) => {\r\n          const newErrors = { ...prev };\r\n          delete newErrors[field as string];\r\n          return newErrors;\r\n        });\r\n      }\r\n    };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-50 p-4\">\r\n      <div className=\"bg-[#1a1a1a] rounded-xl w-full max-w-lg shadow-2xl p-6 border border-gray-800 max-h-[90vh] overflow-y-auto\">\r\n        {submitSuccess ? (\r\n          <div className=\"text-center py-10\">\r\n            <CheckCircle size={64} className=\"text-green-500 mx-auto mb-4\" />\r\n            <h2 className=\"text-2xl font-bold text-white mb-2\">Address Confirmed!</h2>\r\n            <p className=\"text-gray-400\">Your delivery information has been saved.</p>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n              <h2 className=\"text-xl font-bold text-white flex items-center\">\r\n                <MapPin className=\"mr-2 text-[#ff950e]\" />\r\n                Confirm Delivery Address\r\n              </h2>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-400 hover:text-white transition-colors\"\r\n                aria-label=\"Close modal\"\r\n              >\r\n                <X size={20} />\r\n              </button>\r\n            </div>\r\n\r\n            <SecureForm\r\n              onSubmit={handleSubmit}\r\n              rateLimitKey=\"address_confirmation\"\r\n              rateLimitConfig={{ maxAttempts: 10, windowMs: 60 * 1000 }}\r\n            >\r\n              <div className=\"space-y-4\">\r\n                {/* Full Name */}\r\n                <SecureInput\r\n                  label=\"Full Name\"\r\n                  type=\"text\"\r\n                  value={address.fullName}\r\n                  onChange={handleChange('fullName')}\r\n                  onBlur={() => setTouched((prev) => ({ ...prev, fullName: true }))}\r\n                  error={errors.fullName}\r\n                  touched={touched.fullName}\r\n                  placeholder=\"John Doe\"\r\n                  maxLength={100}\r\n                  required\r\n                />\r\n\r\n                {/* Address Line 1 */}\r\n                <SecureInput\r\n                  label=\"Address Line 1\"\r\n                  type=\"text\"\r\n                  value={address.addressLine1}\r\n                  onChange={handleChange('addressLine1')}\r\n                  onBlur={() => setTouched((prev) => ({ ...prev, addressLine1: true }))}\r\n                  error={errors.addressLine1}\r\n                  touched={touched.addressLine1}\r\n                  placeholder=\"123 Main Street\"\r\n                  maxLength={200}\r\n                  required\r\n                />\r\n\r\n                {/* Address Line 2 */}\r\n                <SecureInput\r\n                  label=\"Address Line 2\"\r\n                  type=\"text\"\r\n                  value={address.addressLine2 || ''}\r\n                  onChange={handleChange('addressLine2')}\r\n                  placeholder=\"Apartment, suite, etc. (optional)\"\r\n                  maxLength={200}\r\n                />\r\n\r\n                {/* City and State */}\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                  <SecureInput\r\n                    label=\"City\"\r\n                    type=\"text\"\r\n                    value={address.city}\r\n                    onChange={handleChange('city')}\r\n                    onBlur={() => setTouched((prev) => ({ ...prev, city: true }))}\r\n                    error={errors.city}\r\n                    touched={touched.city}\r\n                    placeholder=\"New York\"\r\n                    maxLength={100}\r\n                    required\r\n                  />\r\n\r\n                  <SecureInput\r\n                    label=\"State/Province\"\r\n                    type=\"text\"\r\n                    value={address.state}\r\n                    onChange={handleChange('state')}\r\n                    onBlur={() => setTouched((prev) => ({ ...prev, state: true }))}\r\n                    error={errors.state}\r\n                    touched={touched.state}\r\n                    placeholder=\"NY\"\r\n                    maxLength={100}\r\n                    required\r\n                  />\r\n                </div>\r\n\r\n                {/* Postal Code and Country */}\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                  <SecureInput\r\n                    label=\"Postal/ZIP Code\"\r\n                    type=\"text\"\r\n                    value={address.postalCode}\r\n                    onChange={handleChange('postalCode')}\r\n                    onBlur={() => setTouched((prev) => ({ ...prev, postalCode: true }))}\r\n                    error={errors.postalCode}\r\n                    touched={touched.postalCode}\r\n                    placeholder=\"10001\"\r\n                    maxLength={20}\r\n                    required\r\n                  />\r\n\r\n                  <SecureInput\r\n                    label=\"Country\"\r\n                    type=\"text\"\r\n                    value={address.country}\r\n                    onChange={handleChange('country')}\r\n                    onBlur={() => setTouched((prev) => ({ ...prev, country: true }))}\r\n                    error={errors.country}\r\n                    touched={touched.country}\r\n                    placeholder=\"United States\"\r\n                    maxLength={100}\r\n                    required\r\n                  />\r\n                </div>\r\n\r\n                {/* Special Instructions */}\r\n                <SecureTextarea\r\n                  label=\"Special Instructions\"\r\n                  value={address.specialInstructions || ''}\r\n                  onChange={handleChange('specialInstructions')}\r\n                  className=\"w-full p-3 rounded-lg bg-[#222] border border-gray-700 text-white focus:outline-none focus:ring-1 focus:ring-[#ff950e] h-20 resize-none\"\r\n                  placeholder=\"Delivery instructions, gate codes, etc.\"\r\n                  maxLength={500}\r\n                  characterCount={true}\r\n                  helpText=\"Optional\"\r\n                />\r\n\r\n                <div className=\"mt-6 flex flex-col-reverse sm:flex-row sm:justify-end gap-3\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={onClose}\r\n                    className=\"px-5 py-2.5 bg-[#333] text-white rounded-lg hover:bg-[#444] transition-colors\"\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={isSubmitting}\r\n                    className=\"px-5 py-2.5 bg-[#ff950e] text-black font-bold rounded-lg hover:bg-[#e88800] transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  >\r\n                    {isSubmitting ? (\r\n                      <>\r\n                        <div className=\"w-4 h-4 border-2 border-black border-t-transparent rounded-full animate-spin mr-2\"></div>\r\n                        Processing...\r\n                      </>\r\n                    ) : (\r\n                      'Confirm Address'\r\n                    )}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </SecureForm>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3916, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/hooks/useMyOrders.ts"],"sourcesContent":["// src/hooks/useMyOrders.ts\r\n\r\nimport { useState, useMemo, useCallback, useEffect } from 'react';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useWebSocket } from '@/context/WebSocketContext';\r\nimport { ordersService } from '@/services/orders.service';\r\nimport type { Order } from '@/types/order';\r\nimport { useListings } from '@/context/ListingContext';\r\nimport type { DeliveryAddress } from '@/types/order';\r\nimport { sanitizeStrict, sanitizeSearchQuery, sanitizeNumber } from '@/utils/security/sanitization';\r\nimport { z } from 'zod';\r\n\r\n// ✅ FIXED: Updated validation schema to match backend response format\r\nconst OrderSchema = z.object({\r\n  // Backend uses _id (MongoDB) or id, so handle both\r\n  _id: z.string().optional(),\r\n  id: z.string().optional(),\r\n  title: z.string(),\r\n  description: z.string(),\r\n  price: z.number().positive(),\r\n  markedUpPrice: z.number().positive().optional(),\r\n  // ✅ FIXED: Backend returns imageUrl (string), not imageUrls (array)\r\n  imageUrl: z.string().optional(),\r\n  seller: z.string(),\r\n  buyer: z.string(),\r\n  date: z.string(),\r\n  shippingStatus: z.enum(['pending', 'processing', 'shipped', 'delivered', 'cancelled']).optional(),\r\n  wasAuction: z.boolean().optional(),\r\n  deliveryAddress: z.object({\r\n    fullName: z.string(),\r\n    addressLine1: z.string(),\r\n    addressLine2: z.string().optional(),\r\n    city: z.string(),\r\n    state: z.string(),\r\n    postalCode: z.string(),\r\n    country: z.string()\r\n  }).optional(),\r\n  listingId: z.string().optional(),\r\n  trackingNumber: z.string().optional(),\r\n  shippedDate: z.string().optional(),\r\n  deliveredDate: z.string().optional(),\r\n  tags: z.array(z.string()).optional(),\r\n  finalBid: z.number().optional(),\r\n  tierCreditAmount: z.number().optional(),\r\n  platformFee: z.number().optional(),\r\n  sellerEarnings: z.number().optional(),\r\n  paymentStatus: z.enum(['pending', 'completed', 'failed', 'refunded']).optional(),\r\n  paymentCompletedAt: z.string().optional(),\r\n  isCustomRequest: z.boolean().optional(),\r\n  originalRequestId: z.string().optional(),\r\n}).transform((data) => ({\r\n  // ✅ CRITICAL: Ensure we always have an id field\r\n  id: data.id || data._id || `order-${Date.now()}-${Math.random()}`,\r\n  title: data.title,\r\n  description: data.description,\r\n  price: data.price,\r\n  markedUpPrice: data.markedUpPrice || data.price,\r\n  imageUrl: data.imageUrl || '',\r\n  seller: data.seller,\r\n  buyer: data.buyer,\r\n  date: data.date,\r\n  shippingStatus: data.shippingStatus || 'pending',\r\n  wasAuction: data.wasAuction || false,\r\n  deliveryAddress: data.deliveryAddress,\r\n  listingId: data.listingId,\r\n  trackingNumber: data.trackingNumber,\r\n  shippedDate: data.shippedDate,\r\n  deliveredDate: data.deliveredDate,\r\n  tags: data.tags || [],\r\n  finalBid: data.finalBid,\r\n  tierCreditAmount: data.tierCreditAmount,\r\n  platformFee: data.platformFee,\r\n  sellerEarnings: data.sellerEarnings,\r\n  paymentStatus: data.paymentStatus,\r\n  paymentCompletedAt: data.paymentCompletedAt,\r\n  isCustomRequest: data.isCustomRequest || false,\r\n  originalRequestId: data.originalRequestId,\r\n}));\r\n\r\ntype ValidatedOrder = z.infer<typeof OrderSchema>;\r\n\r\nexport interface OrderStats {\r\n  totalSpent: number;\r\n  pendingOrders: number;\r\n  shippedOrders: number;\r\n}\r\n\r\n// ✅ IMPROVED: Better error handling in sanitization\r\nfunction sanitizeOrder(order: any): ValidatedOrder | null {\r\n  try {\r\n    console.log('[useMyOrders] Sanitizing order:', order);\r\n    \r\n    // ✅ FIXED: Add required defaults for missing fields\r\n    const orderWithDefaults = {\r\n      ...order,\r\n      // Ensure we have an ID from either _id or id field\r\n      id: order.id || order._id || `order-${Date.now()}-${Math.random()}`,\r\n      description: order.description || order.title || 'No description available',\r\n      shippingStatus: order.shippingStatus || 'pending',\r\n      date: order.date || order.createdAt || new Date().toISOString(),\r\n    };\r\n    \r\n    // Validate order structure\r\n    const validated = OrderSchema.parse(orderWithDefaults);\r\n    \r\n    // ✅ FIXED: Type-safe sanitization that preserves the correct types\r\n    const sanitizedMarkedUpPrice = validated.markedUpPrice \r\n      ? sanitizeNumber(validated.markedUpPrice, 0.01, 100000) \r\n      : validated.markedUpPrice; // This keeps it as undefined if it was undefined\r\n\r\n    // ✅ ADDITIONAL: Sanitize string fields\r\n    return {\r\n      ...validated,\r\n      title: sanitizeStrict(validated.title),\r\n      description: sanitizeStrict(validated.description),\r\n      seller: sanitizeStrict(validated.seller),\r\n      buyer: sanitizeStrict(validated.buyer),\r\n      price: sanitizeNumber(validated.price, 0.01, 100000),\r\n      markedUpPrice: sanitizedMarkedUpPrice,\r\n      trackingNumber: validated.trackingNumber ? sanitizeStrict(validated.trackingNumber) : undefined,\r\n    };\r\n  } catch (error) {\r\n    console.error('[useMyOrders] Invalid order data:', error);\r\n    console.error('[useMyOrders] Raw order data that failed:', order);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function useMyOrders() {\r\n  const { user } = useAuth();\r\n  const { users } = useListings();\r\n  \r\n  // FIXED: Add WebSocket context\r\n  const wsContext = useWebSocket();\r\n  const subscribe = wsContext?.subscribe || (() => () => {});\r\n  const isConnected = wsContext?.isConnected || false;\r\n  \r\n  // ✅ SIMPLIFIED: Single source of truth for orders\r\n  const [orders, setOrders] = useState<Order[]>([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [errors, setErrors] = useState<string[]>([]);\r\n  \r\n  // UI State\r\n  const [addressModalOpen, setAddressModalOpen] = useState(false);\r\n  const [selectedOrder, setSelectedOrder] = useState<string | null>(null);\r\n  const [sortBy, setSortBy] = useState<'date' | 'price' | 'status'>('date');\r\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');\r\n  const [filterStatus, setFilterStatus] = useState<'all' | 'pending' | 'processing' | 'shipped'>('all');\r\n  const [expandedOrder, setExpandedOrder] = useState<string | null>(null);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  \r\n  // ✅ PRIMARY: Load orders from API only\r\n  const loadOrders = useCallback(async () => {\r\n    if (!user?.username || isLoading) return;\r\n    \r\n    setIsLoading(true);\r\n    setErrors([]);\r\n    \r\n    try {\r\n      console.log('[useMyOrders] Loading orders from API for buyer:', user.username);\r\n      \r\n      const result = await ordersService.getOrders({ buyer: user.username });\r\n      \r\n      console.log('[useMyOrders] API response:', result);\r\n      \r\n      if (result.success && result.data) {\r\n        console.log('[useMyOrders] Raw orders from API:', result.data);\r\n        \r\n        // ✅ CRITICAL: Sanitize each order and filter out invalid ones\r\n        const validOrders: Order[] = [];\r\n        const invalidOrders: any[] = [];\r\n        \r\n        result.data.forEach((rawOrder, index) => {\r\n          const sanitized = sanitizeOrder(rawOrder);\r\n          if (sanitized) {\r\n            validOrders.push(sanitized as Order);\r\n          } else {\r\n            invalidOrders.push(rawOrder);\r\n            console.warn(`[useMyOrders] Order ${index} failed validation:`, rawOrder);\r\n          }\r\n        });\r\n        \r\n        console.log('[useMyOrders] Successfully validated', validOrders.length, 'orders');\r\n        if (invalidOrders.length > 0) {\r\n          console.warn('[useMyOrders]', invalidOrders.length, 'orders failed validation');\r\n        }\r\n        \r\n        setOrders(validOrders);\r\n        setErrors([]);\r\n      } else {\r\n        console.error('[useMyOrders] Failed to load orders:', result.error);\r\n        setErrors([result.error?.message || 'Failed to load orders from server']);\r\n        setOrders([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('[useMyOrders] Error loading orders:', error);\r\n      setErrors(['Failed to load orders from server']);\r\n      setOrders([]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [user?.username]);\r\n  \r\n  // ✅ AUTOMATIC: Load orders on mount and when user changes\r\n  useEffect(() => {\r\n    if (user?.username) {\r\n      loadOrders();\r\n    } else {\r\n      setOrders([]);\r\n      setErrors([]);\r\n    }\r\n  }, [user?.username]);\r\n\r\n  // CRITICAL FIX: Poll for new orders after auction win\r\n  useEffect(() => {\r\n    if (!user?.username) return;\r\n    \r\n    let pollInterval: NodeJS.Timeout | undefined;\r\n    \r\n    // Check for auction win indicator in URL or session\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const fromAuction = urlParams.get('from') === 'auction' || \r\n                       sessionStorage.getItem('recent_auction_win') === 'true';\r\n    \r\n    if (fromAuction) {\r\n      console.log('[useMyOrders] Detected auction win, polling for order');\r\n      \r\n      // Poll every 2 seconds for up to 20 seconds\r\n      let attempts = 0;\r\n      const maxAttempts = 10;\r\n      \r\n      pollInterval = setInterval(async () => {\r\n        attempts++;\r\n        console.log(`[useMyOrders] Polling attempt ${attempts}/${maxAttempts}`);\r\n        \r\n        await loadOrders();\r\n        \r\n        // Check if we have any auction orders\r\n        const hasAuctionOrder = orders.some(o => o.wasAuction);\r\n        \r\n        if (hasAuctionOrder || attempts >= maxAttempts) {\r\n          clearInterval(pollInterval);\r\n          sessionStorage.removeItem('recent_auction_win');\r\n          \r\n          // Clear URL param\r\n          const url = new URL(window.location.href);\r\n          url.searchParams.delete('from');\r\n          window.history.replaceState({}, '', url.toString());\r\n        }\r\n      }, 2000);\r\n    }\r\n    \r\n    return () => {\r\n      if (pollInterval) {\r\n        clearInterval(pollInterval);\r\n      }\r\n    };\r\n  }, [user?.username, loadOrders, orders]);\r\n\r\n  // CRITICAL FIX: Enhanced WebSocket event handling for orders\r\n  useEffect(() => {\r\n    if (!isConnected || !subscribe || !user?.username) return;\r\n\r\n    console.log('[useMyOrders] Setting up WebSocket subscriptions for order events');\r\n\r\n    const unsubscribers: (() => void)[] = [];\r\n\r\n    // Listen for new orders created (including auction wins)\r\n    unsubscribers.push(\r\n      subscribe('order:created' as any, (data: any) => {\r\n        console.log('[useMyOrders] Received order:created event:', data);\r\n        \r\n        // Extract order from different possible data structures\r\n        const order = data.order || data;\r\n        \r\n        // Check if this order is for the current user\r\n        if (order && (order.buyer === user.username || order.seller === user.username)) {\r\n          console.log('[useMyOrders] New order is for current user, refreshing orders');\r\n          // Add a small delay to ensure backend has saved the order\r\n          setTimeout(() => {\r\n            loadOrders();\r\n          }, 500);\r\n        }\r\n      })\r\n    );\r\n\r\n    // Also listen for order:new event (some backends use this)\r\n    unsubscribers.push(\r\n      subscribe('order:new' as any, (data: any) => {\r\n        console.log('[useMyOrders] Received order:new event:', data);\r\n        \r\n        const order = data.order || data;\r\n        if (order && order.buyer === user.username) {\r\n          console.log('[useMyOrders] New order for current user, refreshing');\r\n          setTimeout(() => {\r\n            loadOrders();\r\n          }, 500);\r\n        }\r\n      })\r\n    );\r\n\r\n    // Listen for order updates\r\n    unsubscribers.push(\r\n      subscribe('order:updated' as any, (data: any) => {\r\n        console.log('[useMyOrders] Received order:updated event:', data);\r\n        \r\n        const order = data.order || data;\r\n        if (order && (order.buyer === user.username || order.seller === user.username)) {\r\n          console.log('[useMyOrders] Order update is for current user, refreshing orders');\r\n          loadOrders();\r\n        }\r\n      })\r\n    );\r\n\r\n    // Listen for auction ended events (which create orders)\r\n    unsubscribers.push(\r\n      subscribe('auction:ended' as any, (data: any) => {\r\n        console.log('[useMyOrders] Received auction:ended event:', data);\r\n        \r\n        // If there's a winner and it's the current user, refresh orders\r\n        if (data.winner === user.username || data.winnerId === user.username) {\r\n          console.log('[useMyOrders] Current user won the auction, refreshing orders');\r\n          // Add delay to ensure order is created\r\n          setTimeout(() => {\r\n            loadOrders();\r\n          }, 2000);\r\n        }\r\n      })\r\n    );\r\n\r\n    // Listen specifically for auction won events\r\n    unsubscribers.push(\r\n      subscribe('auction:won' as any, (data: any) => {\r\n        console.log('[useMyOrders] Received auction:won event:', data);\r\n        \r\n        // If the data includes an order, add it directly\r\n        if (data.order) {\r\n          const sanitized = sanitizeOrder(data.order);\r\n          if (sanitized) {\r\n            setOrders(prev => {\r\n              // Check if order already exists\r\n              const exists = prev.some(o => o.id === sanitized.id);\r\n              if (!exists) {\r\n                console.log('[useMyOrders] Adding auction order directly from event');\r\n                return [sanitized as Order, ...prev];\r\n              }\r\n              return prev;\r\n            });\r\n          }\r\n        } else {\r\n          // Otherwise refresh from API\r\n          console.log('[useMyOrders] User won auction, refreshing orders from API');\r\n          setTimeout(() => {\r\n            loadOrders();\r\n          }, 1500);\r\n        }\r\n      })\r\n    );\r\n\r\n    // Listen for custom request paid events\r\n    unsubscribers.push(\r\n      subscribe('custom_request:paid' as any, (data: any) => {\r\n        console.log('[useMyOrders] Received custom_request:paid event:', data);\r\n        \r\n        if (data.buyer === user.username || data.seller === user.username) {\r\n          console.log('[useMyOrders] Custom request is for current user, refreshing orders');\r\n          loadOrders();\r\n        }\r\n      })\r\n    );\r\n\r\n    // Listen for address update events\r\n    unsubscribers.push(\r\n      subscribe('order:address-updated' as any, (data: any) => {\r\n        console.log('[useMyOrders] Received order:address-updated event:', data);\r\n        \r\n        if (data.buyer === user.username || data.seller === user.username) {\r\n          loadOrders();\r\n        }\r\n      })\r\n    );\r\n\r\n    return () => {\r\n      unsubscribers.forEach(unsub => unsub());\r\n    };\r\n  }, [isConnected, subscribe, user?.username, loadOrders]);\r\n\r\n  // FIXED: Also listen for custom events from ListingContext and other sources\r\n  useEffect(() => {\r\n    if (!user?.username) return;\r\n\r\n    const handleOrderCreated = (event: CustomEvent) => {\r\n      console.log('[useMyOrders] Received order:created custom event:', event.detail);\r\n      const order = event.detail?.order || event.detail;\r\n      if (order && (order.buyer === user.username || order.seller === user.username)) {\r\n        console.log('[useMyOrders] New order is for current user, refreshing');\r\n        setTimeout(() => {\r\n          loadOrders();\r\n        }, 500);\r\n      }\r\n    };\r\n\r\n    const handleAuctionWon = (event: CustomEvent) => {\r\n      console.log('[useMyOrders] Received auction:won custom event:', event.detail);\r\n      // Always refresh when auction is won\r\n      setTimeout(() => {\r\n        loadOrders();\r\n      }, 1500);\r\n    };\r\n\r\n    const handleListingRemoved = (event: CustomEvent) => {\r\n      console.log('[useMyOrders] Received listing:removed custom event:', event.detail);\r\n      // If a listing was removed due to auction sale, refresh orders\r\n      if (event.detail?.reason === 'auction-sold') {\r\n        console.log('[useMyOrders] Listing removed due to auction sale, refreshing orders');\r\n        setTimeout(() => {\r\n          loadOrders();\r\n        }, 2000);\r\n      }\r\n    };\r\n\r\n    if (typeof window !== 'undefined') {\r\n      window.addEventListener('order:created', handleOrderCreated as EventListener);\r\n      window.addEventListener('auction:won', handleAuctionWon as EventListener);\r\n      window.addEventListener('listing:removed', handleListingRemoved as EventListener);\r\n    }\r\n\r\n    return () => {\r\n      if (typeof window !== 'undefined') {\r\n        window.removeEventListener('order:created', handleOrderCreated as EventListener);\r\n        window.removeEventListener('auction:won', handleAuctionWon as EventListener);\r\n        window.removeEventListener('listing:removed', handleListingRemoved as EventListener);\r\n      }\r\n    };\r\n  }, [user?.username, loadOrders]);\r\n\r\n  // ✅ SIMPLIFIED: Use single orders array\r\n  const orderHistory = useMemo(() => orders, [orders]);\r\n\r\n  // ✅ IMPROVED: Update order address via API\r\n  const updateOrderAddress = useCallback(async (orderId: string, address: DeliveryAddress) => {\r\n    if (!orderId || !address) {\r\n      console.error('[useMyOrders] Invalid order ID or address');\r\n      setErrors(['Invalid order ID or address']);\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      console.log('[useMyOrders] Updating order address via API:', { orderId, address });\r\n      \r\n      const success = await ordersService.updateOrderAddress(orderId, address);\r\n      \r\n      if (success) {\r\n        // Reload orders to get updated data\r\n        await loadOrders();\r\n        setErrors([]);\r\n        console.log('[useMyOrders] Address updated successfully');\r\n      } else {\r\n        console.error('[useMyOrders] Failed to update address');\r\n        setErrors(['Failed to update delivery address']);\r\n      }\r\n    } catch (error) {\r\n      console.error('[useMyOrders] Error updating order address:', error);\r\n      setErrors(['Failed to update address - please try again']);\r\n    }\r\n  }, [loadOrders]);\r\n\r\n  // Sanitized search query setter\r\n  const handleSearchQueryChange = useCallback((query: string) => {\r\n    const sanitized = sanitizeSearchQuery(query);\r\n    setSearchQuery(sanitized);\r\n  }, []);\r\n\r\n  // ✅ ENHANCED: Filter and sort orders\r\n  const userOrders = useMemo(() => {\r\n    if (!user?.username) return [];\r\n    \r\n    let filtered = orderHistory.filter(order => order.buyer === user.username);\r\n    \r\n    // Apply search filter\r\n    if (searchQuery.trim()) {\r\n      const lowerQuery = searchQuery.toLowerCase().trim();\r\n      filtered = filtered.filter(order => \r\n        order.title.toLowerCase().includes(lowerQuery) ||\r\n        order.seller.toLowerCase().includes(lowerQuery) ||\r\n        order.description.toLowerCase().includes(lowerQuery)\r\n      );\r\n    }\r\n    \r\n    // Apply status filter\r\n    if (filterStatus !== 'all') {\r\n      filtered = filtered.filter(order => {\r\n        const status = order.shippingStatus || 'pending';\r\n        \r\n        if (filterStatus === 'pending') {\r\n          return status === 'pending' || status === 'pending-auction';\r\n        }\r\n        return status === filterStatus;\r\n      });\r\n    }\r\n    \r\n    // Sort orders\r\n    filtered.sort((a, b) => {\r\n      let aValue: any, bValue: any;\r\n      \r\n      switch (sortBy) {\r\n        case 'date':\r\n          try {\r\n            aValue = new Date(a.date).getTime();\r\n            bValue = new Date(b.date).getTime();\r\n          } catch {\r\n            aValue = 0;\r\n            bValue = 0;\r\n          }\r\n          break;\r\n        case 'price':\r\n          aValue = a.markedUpPrice || a.price || 0;\r\n          bValue = b.markedUpPrice || b.price || 0;\r\n          break;\r\n        case 'status':\r\n          const statusOrder: Record<string, number> = { \r\n            'pending': 0,\r\n            'processing': 1,\r\n            'shipped': 2,\r\n            'delivered': 3,\r\n            'cancelled': 4\r\n          };\r\n          aValue = statusOrder[a.shippingStatus || 'pending'] || 0;\r\n          bValue = statusOrder[b.shippingStatus || 'pending'] || 0;\r\n          break;\r\n        default:\r\n          return 0;\r\n      }\r\n      \r\n      if (sortOrder === 'asc') {\r\n        return aValue < bValue ? -1 : aValue > bValue ? 1 : 0;\r\n      } else {\r\n        return aValue > bValue ? -1 : aValue < bValue ? 1 : 0;\r\n      }\r\n    });\r\n    \r\n    return filtered;\r\n  }, [user?.username, orderHistory, searchQuery, filterStatus, sortBy, sortOrder]);\r\n\r\n  // ✅ ENHANCED: Separate orders by type\r\n  const directOrders = useMemo(() => \r\n    userOrders.filter(order => !order.wasAuction && !order.isCustomRequest),\r\n    [userOrders]\r\n  );\r\n  \r\n  const customRequestOrders = useMemo(() => \r\n    userOrders.filter(order => Boolean(order.isCustomRequest)),\r\n    [userOrders]\r\n  );\r\n  \r\n  const auctionOrders = useMemo(() => \r\n    userOrders.filter(order => Boolean(order.wasAuction)),\r\n    [userOrders]\r\n  );\r\n\r\n  // ✅ IMPROVED: Calculate stats with proper validation\r\n  const stats: OrderStats = useMemo(() => {\r\n    const totalSpent = userOrders.reduce((sum, order) => {\r\n      const price = order.markedUpPrice || order.price || 0;\r\n      if (typeof price === 'number' && price > 0) {\r\n        return sum + price;\r\n      }\r\n      return sum;\r\n    }, 0);\r\n\r\n    const pendingCount = userOrders.filter(order => {\r\n      const status = order.shippingStatus || 'pending';\r\n      return status === 'pending' || status === 'processing';\r\n    }).length;\r\n\r\n    const shippedCount = userOrders.filter(order => \r\n      order.shippingStatus === 'shipped'\r\n    ).length;\r\n\r\n    return {\r\n      totalSpent: Math.max(0, totalSpent),\r\n      pendingOrders: Math.max(0, pendingCount),\r\n      shippedOrders: Math.max(0, shippedCount),\r\n    };\r\n  }, [userOrders]);\r\n\r\n  // ✅ ENHANCED: Event handlers with proper validation\r\n  const handleOpenAddressModal = useCallback((orderId: string) => {\r\n    const orderExists = orderHistory.some(order => order.id === orderId);\r\n    if (!orderExists) {\r\n      setErrors(['Invalid order selected']);\r\n      return;\r\n    }\r\n    \r\n    setSelectedOrder(orderId);\r\n    setAddressModalOpen(true);\r\n    setErrors([]);\r\n  }, [orderHistory]);\r\n\r\n  const handleConfirmAddress = useCallback(async (address: DeliveryAddress) => {\r\n    if (!selectedOrder) {\r\n      setErrors(['No order selected']);\r\n      return;\r\n    }\r\n    \r\n    if (!address || typeof address !== 'object' || !address.fullName || !address.addressLine1) {\r\n      setErrors(['Please fill in all required address fields']);\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      await updateOrderAddress(selectedOrder, address);\r\n      setAddressModalOpen(false);\r\n      setSelectedOrder(null);\r\n      setErrors([]);\r\n    } catch (error) {\r\n      console.error('[useMyOrders] Error updating address:', error);\r\n    }\r\n  }, [selectedOrder, updateOrderAddress]);\r\n\r\n  const getSelectedOrderAddress = useCallback((): DeliveryAddress | null => {\r\n    if (!selectedOrder) return null;\r\n    \r\n    const order = orderHistory.find(order => order.id === selectedOrder);\r\n    return order?.deliveryAddress || null;\r\n  }, [selectedOrder, orderHistory]);\r\n\r\n  const toggleSort = useCallback((field: 'date' | 'price' | 'status') => {\r\n    if (sortBy === field) {\r\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\r\n    } else {\r\n      setSortBy(field);\r\n      setSortOrder('desc');\r\n    }\r\n  }, [sortBy, sortOrder]);\r\n\r\n  const handleToggleExpanded = useCallback((orderId: string | null) => {\r\n    if (orderId === null) {\r\n      setExpandedOrder(null);\r\n      return;\r\n    }\r\n    \r\n    const orderExists = orderHistory.some(order => order.id === orderId);\r\n    if (!orderExists) {\r\n      setErrors(['Invalid order']);\r\n      return;\r\n    }\r\n    \r\n    setExpandedOrder(prev => prev === orderId ? null : orderId);\r\n    setErrors([]);\r\n  }, [orderHistory]);\r\n\r\n  const handleFilterStatusChange = useCallback((status: 'all' | 'pending' | 'processing' | 'shipped') => {\r\n    const validStatuses = ['all', 'pending', 'processing', 'shipped'];\r\n    if (validStatuses.includes(status)) {\r\n      setFilterStatus(status);\r\n      setErrors([]);\r\n    }\r\n  }, []);\r\n\r\n  // ✅ PUBLIC: Refresh method\r\n  const refreshOrders = useCallback(async () => {\r\n    console.log('[useMyOrders] Manual refresh requested');\r\n    await loadOrders();\r\n  }, [loadOrders]);\r\n\r\n  // ✅ PUBLIC: Clear errors\r\n  const clearErrors = useCallback(() => {\r\n    setErrors([]);\r\n  }, []);\r\n\r\n  return {\r\n    // Data\r\n    user,\r\n    users,\r\n    userOrders,\r\n    directOrders,\r\n    customRequestOrders,\r\n    auctionOrders,\r\n    stats,\r\n    \r\n    // Loading and error state\r\n    isLoading,\r\n    errors,\r\n    \r\n    // UI State\r\n    searchQuery,\r\n    setSearchQuery: handleSearchQueryChange,\r\n    sortBy,\r\n    setSortBy,\r\n    sortOrder,\r\n    filterStatus,\r\n    setFilterStatus: handleFilterStatusChange,\r\n    expandedOrder,\r\n    setExpandedOrder: handleToggleExpanded,\r\n    addressModalOpen,\r\n    setAddressModalOpen,\r\n    selectedOrder,\r\n    \r\n    // Actions\r\n    handleOpenAddressModal,\r\n    handleConfirmAddress,\r\n    toggleSort,\r\n    getSelectedOrderAddress,\r\n    refreshOrders,\r\n    clearErrors,\r\n  };\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4733, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/app/buyers/my-orders/page.tsx"],"sourcesContent":["// src/app/buyers/my-orders/page.tsx\r\n'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport RequireAuth from '@/components/RequireAuth';\r\nimport BanCheck from '@/components/BanCheck';\r\nimport OrdersHeader from '@/components/buyers/my-orders/OrdersHeader';\r\nimport OrderStats from '@/components/buyers/my-orders/OrderStats';\r\nimport OrderFilters from '@/components/buyers/my-orders/OrderFilters';\r\nimport OrderSections from '@/components/buyers/my-orders/OrderSections';\r\nimport EmptyOrdersState from '@/components/buyers/my-orders/EmptyOrdersState';\r\nimport AddressConfirmationModal from '@/components/AddressConfirmationModal';\r\nimport { useMyOrders } from '@/hooks/useMyOrders';\r\nimport { AlertCircle, Loader2 } from 'lucide-react';\r\n\r\n// Error component\r\nfunction OrdersError({ error, onRetry }: { error: string; onRetry: () => void }) {\r\n  return (\r\n    <div className=\"min-h-screen bg-black p-4 md:p-10\">\r\n      <div className=\"max-w-md mx-auto text-center pt-20\">\r\n        <AlertCircle className=\"w-16 h-16 text-red-500 mx-auto mb-4\" />\r\n        <h1 className=\"text-2xl font-bold text-white mb-2\">Error Loading Orders</h1>\r\n        <p className=\"text-gray-400 mb-6\">{error}</p>\r\n        <button\r\n          onClick={onRetry}\r\n          className=\"px-6 py-3 bg-[#ff950e] text-black rounded-lg hover:bg-[#ff7a00] transition-colors font-medium\"\r\n        >\r\n          Try Again\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Loading component\r\nfunction OrdersLoading() {\r\n  return (\r\n    <div className=\"min-h-screen bg-black p-4 md:p-10\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        <div className=\"text-center py-20\">\r\n          <Loader2 className=\"w-8 h-8 text-[#ff950e] animate-spin mx-auto mb-4\" />\r\n          <p className=\"text-gray-400\">Loading your orders...</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Inner component that uses the hooks after providers are ready\r\nfunction MyOrdersContent() {\r\n  const {\r\n    // Data\r\n    user,\r\n    userOrders,\r\n    directOrders,\r\n    customRequestOrders,\r\n    auctionOrders,\r\n    stats,\r\n\r\n    // UI State\r\n    searchQuery,\r\n    setSearchQuery,\r\n    sortBy,\r\n    setSortBy,\r\n    sortOrder,\r\n    filterStatus,\r\n    setFilterStatus,\r\n    expandedOrder,\r\n    setExpandedOrder,\r\n    addressModalOpen,\r\n    setAddressModalOpen,\r\n    selectedOrder,\r\n\r\n    // Handlers\r\n    handleOpenAddressModal,\r\n    handleConfirmAddress,\r\n    toggleSort,\r\n    getSelectedOrderAddress,\r\n  } = useMyOrders();\r\n\r\n  // Safe arrays to avoid undefined checks everywhere\r\n  const safeUserOrders = userOrders ?? [];\r\n  const safeDirectOrders = directOrders ?? [];\r\n  const safeCustomRequestOrders = customRequestOrders ?? [];\r\n  const safeAuctionOrders = auctionOrders ?? [];\r\n\r\n  // Safe default values for stats\r\n  const safeStats = {\r\n    totalSpent: stats?.totalSpent ?? 0,\r\n    pendingOrders: stats?.pendingOrders ?? 0,\r\n    shippedOrders: stats?.shippedOrders ?? 0,\r\n  };\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-black p-4 md:p-10\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        <OrdersHeader />\r\n\r\n        <OrderStats stats={safeStats} />\r\n\r\n        <OrderFilters\r\n          searchQuery={searchQuery}\r\n          onSearchChange={setSearchQuery}\r\n          filterStatus={filterStatus}\r\n          onFilterStatusChange={setFilterStatus}\r\n          sortBy={sortBy}\r\n          sortOrder={sortOrder}\r\n          onToggleSort={toggleSort}\r\n        />\r\n\r\n        {safeUserOrders.length === 0 ? (\r\n          <EmptyOrdersState />\r\n        ) : (\r\n          <OrderSections\r\n            directOrders={safeDirectOrders}\r\n            customRequestOrders={safeCustomRequestOrders}\r\n            auctionOrders={safeAuctionOrders}\r\n            expandedOrder={expandedOrder}\r\n            onToggleExpanded={setExpandedOrder}\r\n            onOpenAddressModal={handleOpenAddressModal}\r\n          />\r\n        )}\r\n\r\n        <AddressConfirmationModal\r\n          isOpen={addressModalOpen}\r\n          onClose={() => {\r\n            setAddressModalOpen(false);\r\n          }}\r\n          onConfirm={handleConfirmAddress}\r\n          existingAddress={getSelectedOrderAddress()}\r\n          orderId={selectedOrder || ''}\r\n        />\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n\r\n// Main page component with provider readiness check and error boundary\r\nexport default function MyOrdersPage() {\r\n  const [mounted, setMounted] = useState(false);\r\n  const [hasError, setHasError] = useState(false);\r\n  const [error, setError] = useState<Error | null>(null);\r\n\r\n  useEffect(() => {\r\n    setMounted(true);\r\n  }, []);\r\n\r\n  // Reset error state on mount\r\n  useEffect(() => {\r\n    if (hasError) {\r\n      setHasError(false);\r\n      setError(null);\r\n    }\r\n  }, [hasError]);\r\n\r\n  // Simple error boundary behavior\r\n  useEffect(() => {\r\n    const handleError = (event: ErrorEvent) => {\r\n      console.error('Orders page error:', event.error);\r\n      setHasError(true);\r\n      setError(event.error);\r\n    };\r\n\r\n    window.addEventListener('error', handleError);\r\n\r\n    return () => {\r\n      window.removeEventListener('error', handleError);\r\n    };\r\n  }, []);\r\n\r\n  if (hasError && error) {\r\n    return (\r\n      <BanCheck>\r\n        <RequireAuth role=\"buyer\">\r\n          <OrdersError\r\n            error={error.message || 'An unexpected error occurred'}\r\n            onRetry={() => {\r\n              setHasError(false);\r\n              setError(null);\r\n              window.location.reload();\r\n            }}\r\n          />\r\n        </RequireAuth>\r\n      </BanCheck>\r\n    );\r\n  }\r\n\r\n  if (!mounted) {\r\n    return (\r\n      <BanCheck>\r\n        <RequireAuth role=\"buyer\">\r\n          <OrdersLoading />\r\n        </RequireAuth>\r\n      </BanCheck>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <BanCheck>\r\n      <RequireAuth role=\"buyer\">\r\n        <MyOrdersContent />\r\n      </RequireAuth>\r\n    </BanCheck>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}