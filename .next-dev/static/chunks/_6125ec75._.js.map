{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/utils/banUtils.tsx"],"sourcesContent":["// src/utils/banUtils.tsx\r\nimport { \r\n  AlertTriangle, \r\n  MessageSquare, \r\n  AlertCircle, \r\n  UserCheck, \r\n  Info \r\n} from 'lucide-react';\r\nimport { BanEntry, BanReason } from '@/types/ban';\r\nimport { sanitizeStrict } from '@/utils/security/sanitization';\r\n\r\nexport const getBanReasonDisplay = (reason: string, customReason?: string) => {\r\n  if (!reason || typeof reason !== 'string') {\r\n    return 'Unknown Reason';\r\n  }\r\n\r\n  const reasonMap: Record<string, { label: string, icon: any, color: string }> = {\r\n    harassment: { label: 'Harassment', icon: AlertTriangle, color: 'text-red-400' },\r\n    spam: { label: 'Spam', icon: MessageSquare, color: 'text-yellow-400' },\r\n    inappropriate_content: { label: 'Inappropriate Content', icon: AlertCircle, color: 'text-orange-400' },\r\n    scam: { label: 'Scam/Fraud', icon: AlertTriangle, color: 'text-red-500' },\r\n    underage: { label: 'Underage', icon: UserCheck, color: 'text-purple-400' },\r\n    payment_fraud: { label: 'Payment Fraud', icon: AlertTriangle, color: 'text-red-600' },\r\n    other: { label: 'Other', icon: Info, color: 'text-gray-400' }\r\n  };\r\n\r\n  const reasonInfo = reasonMap[reason.toLowerCase()] || { label: reason, icon: Info, color: 'text-gray-400' };\r\n  const Icon = reasonInfo.icon;\r\n\r\n  // Sanitize customReason before display to prevent XSS\r\n  const sanitizedCustomReason = customReason ? sanitizeStrict(customReason) : undefined;\r\n\r\n  return (\r\n    <span className={`flex items-center gap-1 ${reasonInfo.color}`}>\r\n      <Icon size={14} />\r\n      {reasonInfo.label}\r\n      {sanitizedCustomReason && <span className=\"text-gray-400 ml-1\">- {sanitizedCustomReason}</span>}\r\n    </span>\r\n  );\r\n};\r\n\r\nexport const isValidBan = (ban: any): ban is BanEntry => {\r\n  return ban && \r\n         typeof ban === 'object' && \r\n         ban.id && \r\n         ban.username && \r\n         typeof ban.username === 'string' &&\r\n         ban.banType &&\r\n         ban.reason &&\r\n         ban.startTime &&\r\n         typeof ban.bannedBy === 'string'; // Changed to check type instead of truthiness\r\n};\r\n"],"names":[],"mappings":"AAAA,yBAAyB;;;;;;AACzB;AAAA;AAAA;AAAA;AAAA;AAQA;;;;AAEO,MAAM,sBAAsB,CAAC,QAAgB;IAClD,IAAI,CAAC,UAAU,OAAO,WAAW,UAAU;QACzC,OAAO;IACT;IAEA,MAAM,YAAyE;QAC7E,YAAY;YAAE,OAAO;YAAc,MAAM,2NAAA,CAAA,gBAAa;YAAE,OAAO;QAAe;QAC9E,MAAM;YAAE,OAAO;YAAQ,MAAM,2NAAA,CAAA,gBAAa;YAAE,OAAO;QAAkB;QACrE,uBAAuB;YAAE,OAAO;YAAyB,MAAM,uNAAA,CAAA,cAAW;YAAE,OAAO;QAAkB;QACrG,MAAM;YAAE,OAAO;YAAc,MAAM,2NAAA,CAAA,gBAAa;YAAE,OAAO;QAAe;QACxE,UAAU;YAAE,OAAO;YAAY,MAAM,mNAAA,CAAA,YAAS;YAAE,OAAO;QAAkB;QACzE,eAAe;YAAE,OAAO;YAAiB,MAAM,2NAAA,CAAA,gBAAa;YAAE,OAAO;QAAe;QACpF,OAAO;YAAE,OAAO;YAAS,MAAM,qMAAA,CAAA,OAAI;YAAE,OAAO;QAAgB;IAC9D;IAEA,MAAM,aAAa,SAAS,CAAC,OAAO,WAAW,GAAG,IAAI;QAAE,OAAO;QAAQ,MAAM,qMAAA,CAAA,OAAI;QAAE,OAAO;IAAgB;IAC1G,MAAM,OAAO,WAAW,IAAI;IAE5B,sDAAsD;IACtD,MAAM,wBAAwB,eAAe,CAAA,GAAA,2IAAA,CAAA,iBAAc,AAAD,EAAE,gBAAgB;IAE5E,qBACE,6LAAC;QAAK,WAAW,AAAC,2BAA2C,OAAjB,WAAW,KAAK;;0BAC1D,6LAAC;gBAAK,MAAM;;;;;;YACX,WAAW,KAAK;YAChB,uCAAyB,6LAAC;gBAAK,WAAU;;oBAAqB;oBAAG;;;;;;;;;;;;;AAGxE;AAEO,MAAM,aAAa,CAAC;IACzB,OAAO,OACA,OAAO,QAAQ,YACf,IAAI,EAAE,IACN,IAAI,QAAQ,IACZ,OAAO,IAAI,QAAQ,KAAK,YACxB,IAAI,OAAO,IACX,IAAI,MAAM,IACV,IAAI,SAAS,IACb,OAAO,IAAI,QAAQ,KAAK,UAAU,8CAA8C;AACzF","debugId":null}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/admin/bans/ExpiredBansContent.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { Clock } from 'lucide-react';\r\nimport { BanEntry, FilterOptions } from '@/types/ban';\r\nimport { isValidBan, getBanReasonDisplay } from '@/utils/banUtils';\r\nimport { sanitizeSearchQuery } from '@/utils/security/sanitization';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\ninterface ExpiredBansContentProps {\r\n  expiredBans: BanEntry[];\r\n  filters: FilterOptions;\r\n}\r\n\r\nconst filterAndSortBans = (bans: BanEntry[], filters: FilterOptions): BanEntry[] => {\r\n  if (!Array.isArray(bans)) return [];\r\n\r\n  const sanitizedSearchTerm = filters.searchTerm ? sanitizeSearchQuery(filters.searchTerm).toLowerCase() : '';\r\n  const sortOrder = (filters.sortOrder === 'asc' || filters.sortOrder === 'desc') ? filters.sortOrder : 'desc';\r\n  const filterBy = ['all', 'temporary', 'permanent'].includes(filters.filterBy as string) ? filters.filterBy : 'all';\r\n\r\n  const filtered = bans.filter((ban) => {\r\n    if (!isValidBan(ban)) return false;\r\n\r\n    const matchesSearch = sanitizedSearchTerm\r\n      ? ban.username.toLowerCase().includes(sanitizedSearchTerm) ||\r\n        (ban.reason && ban.reason.toLowerCase().includes(sanitizedSearchTerm)) ||\r\n        (ban.customReason && ban.customReason.toLowerCase().includes(sanitizedSearchTerm))\r\n      : true;\r\n\r\n    const matchesFilter =\r\n      filterBy === 'all' ? true : filterBy === 'temporary' ? ban.banType === 'temporary' : ban.banType === 'permanent';\r\n\r\n    return matchesSearch && matchesFilter;\r\n  });\r\n\r\n  filtered.sort((a, b) => {\r\n    const comparison = new Date(a.startTime || 0).getTime() - new Date(b.startTime || 0).getTime();\r\n    return sortOrder === 'asc' ? comparison : -comparison;\r\n  });\r\n\r\n  return filtered;\r\n};\r\n\r\nexport default function ExpiredBansContent({ expiredBans, filters }: ExpiredBansContentProps) {\r\n  const filteredBans = filterAndSortBans(expiredBans || [], filters);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <h2 className=\"text-xl font-semibold text-white mb-4\">Expired Bans ({(expiredBans || []).length})</h2>\r\n      {filteredBans.length === 0 ? (\r\n        <div className=\"bg-[#1a1a1a] border border-gray-800 rounded-lg p-8 text-center\">\r\n          <Clock size={48} className=\"mx-auto text-gray-600 mb-4\" />\r\n          <p className=\"text-gray-400 text-lg\">No expired bans found</p>\r\n          {filters.searchTerm && <p className=\"text-gray-500 text-sm mt-2\">Try adjusting your search terms or filters</p>}\r\n        </div>\r\n      ) : (\r\n        <div className=\"space-y-4\">\r\n          {filteredBans\r\n            .map((ban) => {\r\n              if (!isValidBan(ban)) return null;\r\n\r\n              const hours =\r\n                ban.banType === 'permanent' || !ban.endTime || !ban.startTime\r\n                  ? null\r\n                  : Math.ceil((new Date(ban.endTime).getTime() - new Date(ban.startTime).getTime()) / (1000 * 60 * 60));\r\n\r\n              return (\r\n                <div key={ban.id} className=\"bg-[#1a1a1a] border border-gray-800 rounded-lg p-6 opacity-75\">\r\n                  <div className=\"flex justify-between items-start\">\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center gap-3 mb-2\">\r\n                        <h3 className=\"text-lg font-semibold text-white\">\r\n                          <SecureMessageDisplay content={ban.username} allowBasicFormatting={false} />\r\n                        </h3>\r\n                        <span className=\"px-2 py-1 bg-gray-900/20 text-gray-400 text-xs rounded font-medium\">Expired/Lifted</span>\r\n                      </div>\r\n\r\n                      <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                        <div>\r\n                          <span className=\"text-gray-400\">Reason:</span>\r\n                          <span className=\"text-gray-300 ml-2\">{getBanReasonDisplay(ban.reason, ban.customReason)}</span>\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"text-gray-400\">Duration:</span>\r\n                          <span className=\"text-gray-300 ml-2\">\r\n                            {ban.banType === 'permanent' ? 'Permanent' : hours !== null ? `${hours} hours` : 'Unknown'}\r\n                          </span>\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"text-gray-400\">Start:</span>\r\n                          <span className=\"text-gray-300 ml-2\">{ban.startTime ? new Date(ban.startTime).toLocaleString() : 'Unknown'}</span>\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"text-gray-400\">End:</span>\r\n                          <span className=\"text-gray-300 ml-2\">{ban.endTime ? new Date(ban.endTime).toLocaleString() : 'Manually lifted'}</span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })\r\n            .filter((ban) => ban !== null)}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 385, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/user-check.js","sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/node_modules/lucide-react/src/icons/user-check.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2', key: '1yyitq' }],\n  ['circle', { cx: '9', cy: '7', r: '4', key: 'nufk8' }],\n  ['polyline', { points: '16 11 18 13 22 9', key: '1pwet4' }],\n];\n\n/**\n * @component @name UserCheck\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMjF2LTJhNCA0IDAgMCAwLTQtNEg2YTQgNCAwIDAgMC00IDR2MiIgLz4KICA8Y2lyY2xlIGN4PSI5IiBjeT0iNyIgcj0iNCIgLz4KICA8cG9seWxpbmUgcG9pbnRzPSIxNiAxMSAxOCAxMyAyMiA5IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/user-check\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst UserCheck = createLucideIcon('user-check', __iconNode);\n\nexport default UserCheck;\n"],"names":[],"mappings":";;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAuB,CAAA,CAAA,CAAA,CAAA;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA;QAAA,CAAA;YAAE,GAAG,CAA6C,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAA,CAAA,CAAA,CAAA,CAAA,CAAK;QAAA,CAAU;KAAA,CAAA;IAC1E;QAAC,QAAU,CAAA;QAAA,CAAA;YAAE,EAAI,CAAA,CAAA,CAAA,CAAA,CAAA;YAAK,CAAI,CAAA,CAAA,CAAA,GAAA,CAAK;YAAA,CAAG,EAAA,CAAA,CAAA,CAAA,CAAA;YAAK,GAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAS;KAAA,CAAA;IACrD;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAY,CAAA;QAAA,CAAA;YAAE,QAAQ,CAAoB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAA,CAAA,CAAA,CAAA,CAAA,CAAK;QAAA,CAAU;KAAA;CAC5D,CAAA;AAaM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,SAAA,CAAY,CAAA,2KAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAiB,AAAjB,CAAA,CAAA,AAAiB,CAAjB,AAAiB,CAAjB,AAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAc,CAAU,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA","debugId":null}}]
}