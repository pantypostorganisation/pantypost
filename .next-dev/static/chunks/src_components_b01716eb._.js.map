{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/AppInitializationProvider.tsx"],"sourcesContent":["// src/components/AppInitializationProvider.tsx\r\n'use client';\r\n\r\nimport React, {\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n  ReactNode,\r\n  useRef,\r\n  useCallback,\r\n} from 'react';\r\n\r\ninterface HealthStatus {\r\n  wallet_service: boolean;\r\n  storage_service: boolean;\r\n  auth_service: boolean;\r\n  websocket_service: boolean;\r\n  [key: string]: boolean | undefined;\r\n}\r\n\r\ninterface AppInitializationContextType {\r\n  isInitialized: boolean;\r\n  isInitializing: boolean;\r\n  healthStatus: HealthStatus | null;\r\n  error: Error | null;\r\n  warnings: string[];\r\n  reinitialize: () => Promise<void>;\r\n}\r\n\r\nconst AppInitializationContext = createContext<AppInitializationContextType | undefined>(undefined);\r\n\r\n// ---------- Helpers ----------\r\nconst DEFAULT_BASE = 'http://localhost:5000';\r\nconst DEFAULT_TIMEOUT_MS = Number(process.env.NEXT_PUBLIC_API_TIMEOUT ?? 10000);\r\n\r\nfunction normalizeBaseUrl(url?: string | null) {\r\n  const s = (url ?? '').trim();\r\n  if (!s) return DEFAULT_BASE;\r\n  return s.replace(/\\/+$/, ''); // strip trailing slash(es)\r\n}\r\n\r\n/**\r\n * Build the health URL robustly regardless of whether the env contains '/api' already.\r\n * Priority: NEXT_PUBLIC_API_URL (kept for backward-compat), then NEXT_PUBLIC_API_BASE_URL.\r\n */\r\nfunction buildHealthUrl() {\r\n  const rawApiUrl = (process.env.NEXT_PUBLIC_API_URL ?? '').trim();\r\n  const rawApiBase = (process.env.NEXT_PUBLIC_API_BASE_URL ?? '').trim();\r\n\r\n  // Prefer API_URL if provided; otherwise fallback to API_BASE_URL; otherwise default.\r\n  const base = normalizeBaseUrl(rawApiUrl || rawApiBase || DEFAULT_BASE);\r\n\r\n  // If base already ends with '/api', just add '/health'; otherwise add '/api/health'.\r\n  if (base.toLowerCase().endsWith('/api')) {\r\n    return `${base}/health`;\r\n  }\r\n  return `${base}/api/health`;\r\n}\r\n\r\nasync function fetchWithTimeout(input: RequestInfo, init: RequestInit = {}, timeoutMs = DEFAULT_TIMEOUT_MS) {\r\n  const controller = new AbortController();\r\n  const id = setTimeout(() => controller.abort(), Math.max(3000, timeoutMs)); // minimum 3s\r\n  try {\r\n    const res = await fetch(input, { ...init, signal: controller.signal, credentials: 'omit', mode: 'cors' });\r\n    return res;\r\n  } finally {\r\n    clearTimeout(id);\r\n  }\r\n}\r\n\r\n// Loading component\r\nfunction InitializationLoader(): React.ReactElement {\r\n  return (\r\n    <div className=\"min-h-screen bg-black text-white flex items-center justify-center\">\r\n      <div className=\"text-center\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4\"></div>\r\n        <p className=\"text-gray-400\">Initializing PantyPost...</p>\r\n        <p className=\"text-xs text-gray-600 mt-2\">Connecting to server...</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Error component\r\nfunction InitializationError({ error, onRetry }: { error: Error; onRetry: () => void }): React.ReactElement {\r\n  return (\r\n    <div className=\"min-h-screen bg-black text-white flex items-center justify-center p-4\">\r\n      <div className=\"max-w-md w-full bg-gray-900 rounded-lg p-8 text-center\">\r\n        <div className=\"text-red-500 mb-4\">\r\n          <svg className=\"w-16 h-16 mx-auto\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n          </svg>\r\n        </div>\r\n        <h1 className=\"text-2xl font-bold mb-2\">Connection Error</h1>\r\n        <p className=\"text-gray-400 mb-4\">{error.message || 'Failed to connect to the server'}</p>\r\n        <button onClick={onRetry} className=\"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors\">\r\n          Retry Connection\r\n        </button>\r\n        {process.env.NODE_ENV === 'development' && (\r\n          <details className=\"mt-4 text-left\">\r\n            <summary className=\"cursor-pointer text-sm text-gray-500 hover:text-gray-300\">Technical details</summary>\r\n            <pre className=\"mt-2 text-xs bg-black/50 p-3 rounded overflow-auto max-h-48\">{error.stack}</pre>\r\n          </details>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function AppInitializationProvider({ children }: { children: ReactNode }): React.ReactElement {\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n  const [isInitializing, setIsInitializing] = useState(true);\r\n  const [healthStatus, setHealthStatus] = useState<HealthStatus | null>(null);\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const [warnings, setWarnings] = useState<string[]>([]);\r\n  const hasInitializedRef = useRef(false);\r\n\r\n  const initializeApp = useCallback(async () => {\r\n    // Use cached session state if available and we haven't initialized in-memory yet\r\n    if (typeof window !== 'undefined') {\r\n      const sessionInit = sessionStorage.getItem('app_initialized');\r\n      const sessionHealth = sessionStorage.getItem('app_health_status');\r\n\r\n      if (sessionInit === 'true' && !hasInitializedRef.current) {\r\n        console.log('[AppInitializer] Using cached initialization state');\r\n        setIsInitialized(true);\r\n        setIsInitializing(false);\r\n\r\n        if (sessionHealth) {\r\n          try {\r\n            setHealthStatus(JSON.parse(sessionHealth));\r\n          } catch (e) {\r\n            console.error('[AppInitializer] Failed to parse cached health status:', e);\r\n          }\r\n        }\r\n\r\n        hasInitializedRef.current = true;\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Prevent duplicate concurrent inits\r\n    if (hasInitializedRef.current) {\r\n      console.log('[AppInitializer] Initialization already in-flight; skipping duplicate call');\r\n      return;\r\n    }\r\n\r\n    hasInitializedRef.current = true;\r\n    setIsInitializing(true);\r\n    setError(null);\r\n    setWarnings([]);\r\n\r\n    try {\r\n      const healthUrl = buildHealthUrl();\r\n      console.log('[AppInitializer] Checking API health at:', healthUrl);\r\n\r\n      const res = await fetchWithTimeout(\r\n        healthUrl,\r\n        {\r\n          method: 'GET',\r\n          headers: { Accept: 'application/json' },\r\n        },\r\n        DEFAULT_TIMEOUT_MS\r\n      ).catch((err) => {\r\n        console.error('[AppInitializer] Health check fetch failed:', err);\r\n        throw new Error('Cannot connect to backend server. Please ensure the API is running.');\r\n      });\r\n\r\n      if (!res || !res.ok) {\r\n        const statusText = res ? `${res.status} ${res.statusText}` : 'no response';\r\n        throw new Error(`Backend server is not responding correctly (${statusText})`);\r\n      }\r\n\r\n      let data: any = null;\r\n      try {\r\n        data = await res.json();\r\n      } catch {\r\n        throw new Error('Backend server is not responding correctly (invalid JSON)');\r\n      }\r\n\r\n      console.log('[AppInitializer] API health check response:', data);\r\n\r\n      // Accept either data.services or data.features as service map\r\n      const services = (data?.services ?? data?.features ?? {}) as Record<string, any>;\r\n\r\n      const health: HealthStatus = {\r\n        wallet_service: services.wallet ?? true,\r\n        storage_service: services.storage ?? true,\r\n        auth_service: services.auth ?? true,\r\n        websocket_service: services.websocket ?? true,\r\n        // keep any extra flags the backend may add:\r\n        ...Object.fromEntries(Object.entries(services).map(([k, v]) => [k, Boolean(v)])),\r\n      };\r\n\r\n      setHealthStatus(health);\r\n      setIsInitialized(true);\r\n\r\n      if (typeof window !== 'undefined') {\r\n        sessionStorage.setItem('app_initialized', 'true');\r\n        sessionStorage.setItem('app_health_status', JSON.stringify(health));\r\n      }\r\n\r\n      console.log('[AppInitializer] Initialization complete:', { initialized: true, health });\r\n    } catch (err) {\r\n      console.error('[AppInitializer] Initialization failed:', err);\r\n      setError(err instanceof Error ? err : new Error('Initialization failed'));\r\n      setIsInitialized(false);\r\n      hasInitializedRef.current = false;\r\n\r\n      if (typeof window !== 'undefined') {\r\n        sessionStorage.removeItem('app_initialized');\r\n        sessionStorage.removeItem('app_health_status');\r\n      }\r\n    } finally {\r\n      setIsInitializing(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    void initializeApp();\r\n  }, [initializeApp]);\r\n\r\n  const reinitialize = async () => {\r\n    if (typeof window !== 'undefined') {\r\n      sessionStorage.removeItem('app_initialized');\r\n      sessionStorage.removeItem('app_health_status');\r\n    }\r\n    hasInitializedRef.current = false;\r\n    await initializeApp();\r\n  };\r\n\r\n  if (error && !isInitializing) {\r\n    return (\r\n      <AppInitializationContext.Provider\r\n        value={{\r\n          isInitialized,\r\n          isInitializing,\r\n          healthStatus,\r\n          error,\r\n          warnings,\r\n          reinitialize,\r\n        }}\r\n      >\r\n        <InitializationError error={error} onRetry={reinitialize} />\r\n      </AppInitializationContext.Provider>\r\n    );\r\n  }\r\n\r\n  if (isInitializing && !isInitialized) {\r\n    return (\r\n      <AppInitializationContext.Provider\r\n        value={{\r\n          isInitialized,\r\n          isInitializing,\r\n          healthStatus,\r\n          error,\r\n          warnings,\r\n          reinitialize,\r\n        }}\r\n      >\r\n        <InitializationLoader />\r\n      </AppInitializationContext.Provider>\r\n    );\r\n  }\r\n\r\n  if (process.env.NODE_ENV === 'development' && warnings.length > 0 && isInitialized) {\r\n    console.warn('🚧 Initialization completed with warnings:', warnings);\r\n  }\r\n\r\n  return (\r\n    <AppInitializationContext.Provider\r\n      value={{\r\n        isInitialized,\r\n        isInitializing,\r\n        healthStatus,\r\n        error,\r\n        warnings,\r\n        reinitialize,\r\n      }}\r\n    >\r\n      {children}\r\n    </AppInitializationContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAppInitialization(): AppInitializationContextType {\r\n  const context = useContext(AppInitializationContext);\r\n  if (!context) {\r\n    throw new Error('useAppInitialization must be used within AppInitializationProvider');\r\n  }\r\n  return context;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 413, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/Providers.tsx"],"sourcesContent":["// src/components/Providers.tsx\r\n'use client';\r\n\r\nimport React, { Component, ReactNode } from 'react';\r\nimport { AuthProvider } from '@/context/AuthContext';\r\nimport { ToastProvider } from '@/context/ToastContext';\r\nimport { BanProvider } from '@/context/BanContext';\r\nimport { WalletProvider } from '@/context/WalletContext';\r\nimport { AuctionProvider } from '@/context/AuctionContext';\r\nimport { ListingProvider } from '@/context/ListingContext';\r\nimport { MessageProvider } from '@/context/MessageContext';\r\nimport { ReviewProvider } from '@/context/ReviewContext';\r\nimport { RequestProvider } from '@/context/RequestContext';\r\nimport { LoadingProvider } from '@/context/LoadingContext';\r\nimport { WebSocketProvider } from '@/context/WebSocketContext';\r\nimport { FavoritesProvider } from '@/context/FavoritesContext';\r\nimport { NotificationProvider } from '@/context/NotificationContext';\r\nimport { AppInitializationProvider } from './AppInitializationProvider';\r\nimport { AlertTriangle, RefreshCw, Home } from 'lucide-react';\r\nimport { sanitizeStrict } from '@/utils/security/sanitization';\r\n\r\ninterface FinancialErrorBoundaryProps {\r\n  children: ReactNode;\r\n}\r\n\r\ninterface FinancialErrorBoundaryState {\r\n  hasError: boolean;\r\n  error: Error | null;\r\n  errorInfo: React.ErrorInfo | null;\r\n  isFinancialError: boolean;\r\n}\r\n\r\nclass FinancialErrorBoundary extends Component<\r\n  FinancialErrorBoundaryProps,\r\n  FinancialErrorBoundaryState\r\n> {\r\n  constructor(props: FinancialErrorBoundaryProps) {\r\n    super(props);\r\n    this.state = {\r\n      hasError: false,\r\n      error: null,\r\n      errorInfo: null,\r\n      isFinancialError: false,\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromError(error: Error): Partial<FinancialErrorBoundaryState> {\r\n    // Sanitize error message to prevent XSS\r\n    const sanitizedMessage = sanitizeStrict(error.message || 'Unknown error');\r\n\r\n    const lower = sanitizedMessage.toLowerCase();\r\n    const isFinancialError =\r\n      lower.includes('wallet') ||\r\n      lower.includes('balance') ||\r\n      lower.includes('payment') ||\r\n      lower.includes('transaction') ||\r\n      lower.includes('auction') ||\r\n      lower.includes('bid');\r\n\r\n    // Create sanitized error object\r\n    const sanitizedError = new Error(sanitizedMessage);\r\n    sanitizedError.name = sanitizeStrict(error.name || 'Error');\r\n\r\n    return {\r\n      hasError: true,\r\n      error: sanitizedError,\r\n      isFinancialError,\r\n    };\r\n  }\r\n\r\n  override componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\r\n    // Log full error details only in development\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.error('Financial Error Boundary caught:', error, errorInfo);\r\n    } else {\r\n      // In production, log sanitized version\r\n      console.error('Application error occurred');\r\n    }\r\n\r\n    this.setState({ errorInfo });\r\n  }\r\n\r\n  handleReset = () => {\r\n    this.setState({\r\n      hasError: false,\r\n      error: null,\r\n      errorInfo: null,\r\n      isFinancialError: false,\r\n    });\r\n\r\n    if (this.state.isFinancialError) {\r\n      // Clear any potentially corrupted data before reload\r\n      try {\r\n        sessionStorage.clear();\r\n      } catch {\r\n        // Ignore storage errors\r\n      }\r\n      window.location.reload();\r\n    }\r\n  };\r\n\r\n  override render() {\r\n    if (this.state.hasError) {\r\n      if (this.state.isFinancialError) {\r\n        return (\r\n          <div className=\"min-h-screen bg-black flex items-center justify-center p-4\">\r\n            <div className=\"max-w-md w-full bg-gray-900 rounded-2xl p-8 text-center\">\r\n              <div className=\"bg-red-500/20 rounded-full p-4 w-20 h-20 mx-auto mb-6 flex items-center justify-center\">\r\n                <AlertTriangle className=\"w-10 h-10 text-red-500\" />\r\n              </div>\r\n\r\n              <h1 className=\"text-2xl font-bold text-white mb-2\">Financial System Error</h1>\r\n              <p className=\"text-gray-400 mb-6\">\r\n                We encountered an error with the wallet or auction system. Your funds are safe, but\r\n                we need to refresh the page.\r\n              </p>\r\n\r\n              <div className=\"space-y-3\">\r\n                <button\r\n                  onClick={this.handleReset}\r\n                  className=\"w-full bg-purple-600 text-white rounded-lg py-3 font-semibold hover:bg-purple-700 transition-colors flex items-center justify-center gap-2\"\r\n                >\r\n                  <RefreshCw className=\"w-5 h-5\" />\r\n                  Refresh Page\r\n                </button>\r\n\r\n                <button\r\n                  onClick={() => (window.location.href = '/')}\r\n                  className=\"w-full bg-gray-800 text-white rounded-lg py-3 font-semibold hover:bg-gray-700 transition-colors flex items-center justify-center gap-2\"\r\n                >\r\n                  <Home className=\"w-5 h-5\" />\r\n                  Go to Homepage\r\n                </button>\r\n              </div>\r\n\r\n              {process.env.NODE_ENV === 'development' && this.state.error && (\r\n                <details className=\"mt-6 text-left\">\r\n                  <summary className=\"cursor-pointer text-sm text-gray-500 hover:text-gray-300\">\r\n                    Error details (dev only)\r\n                  </summary>\r\n                  <div className=\"mt-2 p-3 bg-black/50 rounded-lg overflow-auto\">\r\n                    <p className=\"text-xs text-gray-400 font-mono break-all\">\r\n                      {this.state.error.name}: {this.state.error.message}\r\n                    </p>\r\n                    {this.state.error.stack && (\r\n                      <pre className=\"mt-2 text-xs text-gray-500 whitespace-pre-wrap\">\r\n                        {sanitizeStrict(this.state.error.stack)}\r\n                      </pre>\r\n                    )}\r\n                  </div>\r\n                </details>\r\n              )}\r\n            </div>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      return (\r\n        <div className=\"min-h-screen bg-gray-100 flex items-center justify-center p-4\">\r\n          <div className=\"max-w-md w-full bg-white rounded-lg p-8 text-center shadow-lg\">\r\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Something went wrong</h1>\r\n            <p className=\"text-gray-600 mb-6\">An unexpected error occurred. Please try refreshing the page.</p>\r\n            <button\r\n              onClick={this.handleReset}\r\n              className=\"bg-purple-600 text-white rounded-lg px-6 py-2 font-semibold hover:bg-purple-700 transition-colors\"\r\n            >\r\n              Try Again\r\n            </button>\r\n\r\n            {process.env.NODE_ENV === 'development' && this.state.error && (\r\n              <details className=\"mt-6 text-left\">\r\n                <summary className=\"cursor-pointer text-sm text-gray-500 hover:text-gray-600\">\r\n                  Error details (dev only)\r\n                </summary>\r\n                <div className=\"mt-2 p-3 bg-gray-100 rounded text-xs text-gray-600 overflow-auto\">\r\n                  <p className=\"font-mono break-all\">\r\n                    {this.state.error.name}: {this.state.error.message}\r\n                  </p>\r\n                </div>\r\n              </details>\r\n            )}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\n/**\r\n * Enhanced Providers with proper initialization order\r\n *\r\n * Order matters:\r\n * 1. AppInitialization - Must be first to ensure services are ready\r\n * 2. Auth - Many other providers depend on user state\r\n * 3. Toast - Used by other providers for notifications\r\n * 4. Ban - Needs auth but used by many components\r\n * 5. WebSocket - Needs auth for connection but provides real-time features to others\r\n * 6. Wallet - Depends on auth and initialization\r\n * 7. Auction - Depends on wallet for bid/refund operations\r\n * 8. Favorites - Depends on auth, placed after wallet for consistency\r\n * 9. NotificationProvider - Depends on auth and websocket for real-time updates\r\n * 10. Listing - Depends on auth, wallet, auction, and notifications\r\n * 11. Others - Depend on the above\r\n */\r\nexport function Providers({ children }: { children: ReactNode }) {\r\n  return (\r\n    <AppInitializationProvider>\r\n      <AuthProvider>\r\n        <ToastProvider>\r\n          <BanProvider>\r\n            <WebSocketProvider>\r\n              <FinancialErrorBoundary>\r\n                <WalletProvider>\r\n                  <AuctionProvider>\r\n                    <FavoritesProvider>\r\n                      <NotificationProvider>\r\n                        <ListingProvider>\r\n                          <MessageProvider>\r\n                            <ReviewProvider>\r\n                              <RequestProvider>\r\n                                <LoadingProvider>{children}</LoadingProvider>\r\n                              </RequestProvider>\r\n                            </ReviewProvider>\r\n                          </MessageProvider>\r\n                        </ListingProvider>\r\n                      </NotificationProvider>\r\n                    </FavoritesProvider>\r\n                  </AuctionProvider>\r\n                </WalletProvider>\r\n              </FinancialErrorBoundary>\r\n            </WebSocketProvider>\r\n          </BanProvider>\r\n        </ToastProvider>\r\n      </AuthProvider>\r\n    </AppInitializationProvider>\r\n  );\r\n}\r\n\r\nexport default Providers;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 839, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/ui/SecureMessageDisplay.tsx"],"sourcesContent":["// src/components/ui/SecureMessageDisplay.tsx\r\n\r\nimport React, { useMemo } from 'react';\r\nimport DOMPurify from 'dompurify';\r\nimport { sanitizeHtml, sanitizeMarkdown } from '@/utils/security/sanitization';\r\n\r\ninterface SecureMessageDisplayProps {\r\n  content: string;\r\n  allowBasicFormatting?: boolean;\r\n  allowMarkdown?: boolean;\r\n  className?: string;\r\n  maxLength?: number;\r\n  as?: 'div' | 'span' | 'p';\r\n}\r\n\r\n/**\r\n * Secure component for displaying user-generated content\r\n * Prevents XSS attacks while allowing safe formatting\r\n */\r\nexport const SecureMessageDisplay: React.FC<SecureMessageDisplayProps> = ({\r\n  content,\r\n  allowBasicFormatting = true,\r\n  allowMarkdown = false,\r\n  className = '',\r\n  maxLength,\r\n  as: Component = 'span', // Changed default from 'div' to 'span' for inline usage\r\n}) => {\r\n  const sanitizedContent = useMemo(() => {\r\n    if (!content) return '';\r\n\r\n    let processed = content;\r\n\r\n    // Truncate if needed\r\n    if (maxLength && processed.length > maxLength) {\r\n      processed = processed.substring(0, maxLength) + '...';\r\n    }\r\n\r\n    // Apply appropriate sanitization\r\n    if (allowMarkdown) {\r\n      processed = sanitizeMarkdown(processed);\r\n    } else if (allowBasicFormatting) {\r\n      processed = sanitizeHtml(processed);\r\n    } else {\r\n      // Strip all HTML\r\n      processed = DOMPurify.sanitize(processed, { ALLOWED_TAGS: [] });\r\n    }\r\n\r\n    return processed;\r\n  }, [content, allowBasicFormatting, allowMarkdown, maxLength]);\r\n\r\n  if (!sanitizedContent) {\r\n    return null;\r\n  }\r\n\r\n  // For inline usage or when component is span, never use dangerouslySetInnerHTML\r\n  const isInline = Component === 'span';\r\n  \r\n  // Only use dangerouslySetInnerHTML for block-level elements with formatting\r\n  if ((allowBasicFormatting || allowMarkdown) && !isInline) {\r\n    return (\r\n      <Component\r\n        className={className}\r\n        dangerouslySetInnerHTML={{ __html: sanitizedContent }}\r\n      />\r\n    );\r\n  }\r\n\r\n  // For plain text or inline content, just render normally\r\n  return <Component className={className}>{sanitizedContent}</Component>;\r\n};\r\n\r\n/**\r\n * Secure link component that validates URLs\r\n */\r\ninterface SecureLinkProps {\r\n  href: string;\r\n  children: React.ReactNode;\r\n  className?: string;\r\n  external?: boolean;\r\n  onClick?: (e: React.MouseEvent) => void;\r\n}\r\n\r\nexport const SecureLink: React.FC<SecureLinkProps> = ({\r\n  href,\r\n  children,\r\n  className = '',\r\n  external = true,\r\n  onClick,\r\n}) => {\r\n  const sanitizedHref = useMemo(() => {\r\n    if (!href) return '#';\r\n\r\n    // Check for dangerous protocols\r\n    const dangerousProtocols = ['javascript:', 'data:', 'vbscript:', 'file:'];\r\n    const lowerHref = href.toLowerCase().trim();\r\n    \r\n    if (dangerousProtocols.some(protocol => lowerHref.startsWith(protocol))) {\r\n      console.warn('Blocked dangerous URL:', href);\r\n      return '#';\r\n    }\r\n\r\n    // For relative URLs, ensure they start with /\r\n    if (!lowerHref.startsWith('http://') && !lowerHref.startsWith('https://')) {\r\n      return href.startsWith('/') ? href : `/${href}`;\r\n    }\r\n\r\n    return href;\r\n  }, [href]);\r\n\r\n  const handleClick = (e: React.MouseEvent) => {\r\n    if (sanitizedHref === '#') {\r\n      e.preventDefault();\r\n    }\r\n    onClick?.(e);\r\n  };\r\n\r\n  return (\r\n    <a\r\n      href={sanitizedHref}\r\n      className={className}\r\n      onClick={handleClick}\r\n      {...(external && sanitizedHref !== '#' ? {\r\n        target: '_blank',\r\n        rel: 'noopener noreferrer'\r\n      } : {})}\r\n    >\r\n      {children}\r\n    </a>\r\n  );\r\n};\r\n\r\n/**\r\n * Secure image component with error handling\r\n */\r\ninterface SecureImageProps {\r\n  src: string;\r\n  alt: string;\r\n  className?: string;\r\n  fallbackSrc?: string;\r\n  onError?: () => void;\r\n  onClick?: (e: React.MouseEvent<HTMLImageElement>) => void;\r\n}\r\n\r\nexport const SecureImage: React.FC<SecureImageProps> = ({\r\n  src,\r\n  alt,\r\n  className = '',\r\n  fallbackSrc = '/placeholder-image.png',\r\n  onError,\r\n  onClick,\r\n}) => {\r\n  const [imageSrc, setImageSrc] = React.useState(src);\r\n  const [hasError, setHasError] = React.useState(false);\r\n\r\n  const handleError = () => {\r\n    if (!hasError) {\r\n      setHasError(true);\r\n      setImageSrc(fallbackSrc);\r\n      onError?.();\r\n    }\r\n  };\r\n\r\n  // Validate image URL\r\n  const isValidImageUrl = useMemo(() => {\r\n    if (!imageSrc) return false;\r\n    \r\n    const lower = imageSrc.toLowerCase();\r\n    \r\n    // Check for data URLs (allowed for images)\r\n    if (lower.startsWith('data:image/')) {\r\n      return true;\r\n    }\r\n    \r\n    // Check for dangerous protocols\r\n    if (lower.startsWith('javascript:') || lower.startsWith('vbscript:')) {\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  }, [imageSrc]);\r\n\r\n  if (!isValidImageUrl) {\r\n    return (\r\n      <div className={`${className} bg-gray-800 flex items-center justify-center`}>\r\n        <span className=\"text-gray-500\">Invalid image</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <img\r\n      src={imageSrc}\r\n      alt={alt}\r\n      className={className}\r\n      onError={handleError}\r\n      onClick={onClick}\r\n      loading=\"lazy\"\r\n    />\r\n  );\r\n};\r\n\r\n/**\r\n * Hook for sanitizing form inputs in real-time\r\n */\r\nexport function useSecureInput(\r\n  initialValue: string = '',\r\n  sanitizer?: (value: string) => string\r\n) {\r\n  const [value, setValue] = React.useState(initialValue);\r\n  const [rawValue, setRawValue] = React.useState(initialValue);\r\n\r\n  const handleChange = React.useCallback((newValue: string) => {\r\n    setRawValue(newValue);\r\n    \r\n    const sanitized = sanitizer ? sanitizer(newValue) : newValue;\r\n    setValue(sanitized);\r\n  }, [sanitizer]);\r\n\r\n  return {\r\n    value,\r\n    rawValue,\r\n    setValue: handleChange,\r\n    reset: () => {\r\n      setValue(initialValue);\r\n      setRawValue(initialValue);\r\n    },\r\n  };\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1067, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/Header.tsx"],"sourcesContent":["'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useListings } from '@/context/ListingContext';\r\nimport { useWallet } from '@/context/WalletContext';\r\nimport { useMessages, getReportCount } from '@/context/MessageContext';\r\nimport { useRequests } from '@/context/RequestContext';\r\nimport { useEffect, useRef, useState, useCallback, useMemo } from 'react';\r\nimport {\r\n  Bell,\r\n  ShoppingBag,\r\n  Wallet as WalletIcon,\r\n  MessageSquare,\r\n  Users,\r\n  User,\r\n  LogOut,\r\n  Package,\r\n  ShieldCheck,\r\n  ClipboardCheck,\r\n  DollarSign,\r\n  Crown,\r\n  Shield,\r\n  Heart,\r\n  RotateCcw,\r\n  Trash2,\r\n  Ban,\r\n  Menu,\r\n  X,\r\n} from 'lucide-react';\r\nimport { usePathname } from 'next/navigation';\r\nimport { storageService } from '@/services';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\nimport { sanitizeStrict } from '@/utils/security/sanitization';\r\nimport { isAdmin } from '@/utils/security/permissions';\r\nimport { useNotifications } from '@/context/NotificationContext';\r\n\r\ntype UINotification = {\r\n  id: string;\r\n  message: string;\r\n  timestamp?: string | Date;\r\n  cleared: boolean;\r\n  source: 'legacy' | 'ctx';\r\n};\r\n\r\nconst useClickOutside = (ref: React.RefObject<HTMLElement | null>, callback: () => void) => {\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (ref.current && !ref.current.contains(event.target as Node)) {\r\n        callback();\r\n      }\r\n    };\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, [ref, callback]);\r\n};\r\n\r\nconst useInterval = (callback: () => void, delay: number | null) => {\r\n  const savedCallback = useRef<(() => void) | null>(null);\r\n  const intervalRef = useRef<NodeJS.Timeout | null>(null);\r\n  useEffect(() => {\r\n    savedCallback.current = callback;\r\n  }, [callback]);\r\n  useEffect(() => {\r\n    if (delay === null) return;\r\n    const tick = () => savedCallback.current && savedCallback.current();\r\n    intervalRef.current = setInterval(tick, delay);\r\n    return () => {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n        intervalRef.current = null;\r\n      }\r\n    };\r\n  }, [delay]);\r\n  return () => {\r\n    if (intervalRef.current) {\r\n      clearInterval(intervalRef.current);\r\n      intervalRef.current = null;\r\n    }\r\n  };\r\n};\r\n\r\nexport default function Header(): React.ReactElement | null {\r\n  const pathname = usePathname();\r\n  const { user, logout } = useAuth();\r\n  const { sellerNotifications, clearSellerNotification, restoreSellerNotification, permanentlyDeleteSellerNotification, listings, checkEndedAuctions } =\r\n    useListings();\r\n  const { getBuyerBalance, getSellerBalance, adminBalance, orderHistory, refreshAdminData } = useWallet();\r\n  const { getRequestsForUser } = useRequests();\r\n  const { messages } = useMessages();\r\n\r\n  const {\r\n    activeNotifications: ctxActive,\r\n    clearedNotifications: ctxCleared,\r\n    clearNotification: ctxClearNotification,\r\n    restoreNotification: ctxRestoreNotification,\r\n    deleteNotification: ctxDeleteNotification,\r\n    clearAllNotifications: ctxClearAll,\r\n    deleteAllCleared: ctxDeleteAllCleared,\r\n  } = useNotifications();\r\n\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\r\n  const [reportCount, setReportCount] = useState(0);\r\n  const [showNotifDropdown, setShowNotifDropdown] = useState(false);\r\n  const [activeNotifTab, setActiveNotifTab] = useState<'active' | 'cleared'>('active');\r\n  const [balanceUpdateTrigger, setBalanceUpdateTrigger] = useState(0);\r\n\r\n  const [clearingNotifications, setClearingNotifications] = useState(false);\r\n  const [deletingNotifications, setDeletingNotifications] = useState(false);\r\n\r\n  const notifRef = useRef<HTMLDivElement | null>(null);\r\n  const mobileMenuRef = useRef<HTMLDivElement | null>(null);\r\n  const isMountedRef = useRef(true);\r\n  const lastBalanceUpdate = useRef(0);\r\n  const lastAuctionCheck = useRef(0);\r\n  const hasRefreshedAdminData = useRef(false);\r\n\r\n  const isAdminUser = isAdmin(user);\r\n  const role = user?.role ?? null;\r\n  const username = user?.username ? sanitizeStrict(user.username) : '';\r\n\r\n  useClickOutside(notifRef, () => setShowNotifDropdown(false));\r\n  useClickOutside(mobileMenuRef, () => setMobileMenuOpen(false));\r\n\r\n  useEffect(() => {\r\n    const checkMobile = () => setIsMobile(window.innerWidth < 768);\r\n    checkMobile();\r\n    window.addEventListener('resize', checkMobile);\r\n    return () => window.removeEventListener('resize', checkMobile);\r\n  }, []);\r\n\r\n  // Calculate pending orders count for sellers\r\n  const pendingOrdersCount = useMemo(() => {\r\n    if (!user?.username || user.role !== 'seller') return 0;\r\n    \r\n    try {\r\n      // Filter orders for this seller that are not yet shipped\r\n      const sellerOrders = orderHistory.filter(order => \r\n        order.seller === user.username && \r\n        (!order.shippingStatus || order.shippingStatus === 'pending' || order.shippingStatus === 'processing')\r\n      );\r\n      \r\n      return sellerOrders.length;\r\n    } catch (error) {\r\n      console.error('Error calculating pending orders:', error);\r\n      return 0;\r\n    }\r\n  }, [user?.username, user?.role, orderHistory]);\r\n\r\n  const processedNotifications = useMemo(() => {\r\n    if (!user?.username || user.role !== 'seller') {\r\n      return { active: [] as UINotification[], cleared: [] as UINotification[] };\r\n    }\r\n\r\n    const addNotificationEmojis = (message: string): string => {\r\n      const sanitizedMessage = sanitizeStrict(message);\r\n      \r\n      // Check if the message already starts with emoji characters\r\n      // If it does, return it as-is (backend already added emojis)\r\n      if (sanitizedMessage.match(/^[🎉💸💰🛒🔨⚠️ℹ️🛑🏆🛍️]/)) {\r\n        return sanitizedMessage;\r\n      }\r\n      \r\n      // Only add emojis if they're not already present\r\n      if (sanitizedMessage.includes('subscribed to you')) return `🎉 ${sanitizedMessage}`;\r\n      if (sanitizedMessage.includes('Tip received') || sanitizedMessage.includes('tipped you')) return `💸 ${sanitizedMessage}`;\r\n      if (sanitizedMessage.includes('New custom order')) return `🛒 ${sanitizedMessage}`;\r\n      if (sanitizedMessage.includes('New bid')) return `💰 ${sanitizedMessage}`;\r\n      if (sanitizedMessage.includes('created a new auction')) return `🔨 ${sanitizedMessage}`;\r\n      if (sanitizedMessage.includes('cancelled your auction')) return `🛑 ${sanitizedMessage}`;\r\n      if (sanitizedMessage.includes('Reserve price not met')) return `🔨 ${sanitizedMessage}`;\r\n      if (sanitizedMessage.includes('No bids were placed')) return `🔨 ${sanitizedMessage}`;\r\n      if (sanitizedMessage.includes('insufficient funds') || sanitizedMessage.includes('payment error')) return `⚠️ ${sanitizedMessage}`;\r\n      if (sanitizedMessage.includes('Original highest bidder')) return `ℹ️ ${sanitizedMessage}`;\r\n      \r\n      return sanitizedMessage;\r\n    };\r\n\r\n    const deduplicateNotifications = (notifications: UINotification[]): UINotification[] => {\r\n      const seen = new Map<string, UINotification>();\r\n      const deduped: UINotification[] = [];\r\n\r\n      for (const n of notifications) {\r\n        const cleanMessage = (n.message || '').replace(/^[🎉💸💰🛒🔨⚠️ℹ️🛑🏆🛍️]\\s*/, '').trim();\r\n        const timestamp = new Date(n.timestamp || Date.now());\r\n        const timeWindow = Math.floor(timestamp.getTime() / (60 * 1000)); // 1 minute window\r\n        const key = `${cleanMessage}_${timeWindow}`;\r\n\r\n        if (!seen.has(key)) {\r\n          const withEmoji = { ...n, message: addNotificationEmojis(n.message) };\r\n          seen.set(key, withEmoji);\r\n          deduped.push(withEmoji);\r\n        } else {\r\n          const existing = seen.get(key)!;\r\n          if (timestamp > new Date(existing.timestamp || 0)) {\r\n            const withEmoji = { ...n, message: addNotificationEmojis(n.message) };\r\n            seen.set(key, withEmoji);\r\n            const idx = deduped.findIndex((x) => x.id === existing.id);\r\n            if (idx !== -1) deduped[idx] = withEmoji;\r\n          }\r\n        }\r\n      }\r\n\r\n      return deduped.sort((a, b) => new Date(b.timestamp || 0).getTime() - new Date(a.timestamp || 0).getTime());\r\n    };\r\n\r\n    const legacyActive: UINotification[] = (sellerNotifications || [])\r\n      .filter((n: any) => !n.cleared)\r\n      .map((n: any) => ({ id: n.id, message: n.message, timestamp: n.timestamp, cleared: false, source: 'legacy' as const }));\r\n\r\n    const legacyCleared: UINotification[] = (sellerNotifications || [])\r\n      .filter((n: any) => n.cleared)\r\n      .map((n: any) => ({ id: n.id, message: n.message, timestamp: n.timestamp, cleared: true, source: 'legacy' as const }));\r\n\r\n    const ctxActiveUi: UINotification[] = (ctxActive || []).map((n) => ({\r\n      id: (n._id || n.id) as string,\r\n      message: n.message,\r\n      timestamp: n.createdAt,\r\n      cleared: false,\r\n      source: 'ctx',\r\n    }));\r\n\r\n    const ctxClearedUi: UINotification[] = (ctxCleared || []).map((n) => ({\r\n      id: (n._id || n.id) as string,\r\n      message: n.message,\r\n      timestamp: n.createdAt,\r\n      cleared: true,\r\n      source: 'ctx',\r\n    }));\r\n\r\n    return {\r\n      active: deduplicateNotifications([...legacyActive, ...ctxActiveUi]),\r\n      cleared: deduplicateNotifications([...legacyCleared, ...ctxClearedUi]),\r\n    };\r\n  }, [user?.username, user?.role, sellerNotifications, ctxActive, ctxCleared]);\r\n\r\n  const buyerBalance = useMemo(() => {\r\n    if (!username || typeof getBuyerBalance !== 'function') return 0;\r\n    try {\r\n      const balance = getBuyerBalance(username) || 0;\r\n      return balance;\r\n    } catch (error) {\r\n      console.error('Error getting buyer balance:', error);\r\n      return 0;\r\n    }\r\n  }, [getBuyerBalance, username, balanceUpdateTrigger]);\r\n\r\n  const sellerBalance = useMemo(() => {\r\n    if (!username || typeof getSellerBalance !== 'function') return 0;\r\n    try {\r\n      const balance = getSellerBalance(username) || 0;\r\n      return balance;\r\n    } catch (error) {\r\n      console.error('Error getting seller balance:', error);\r\n      return 0;\r\n    }\r\n  }, [getSellerBalance, username, balanceUpdateTrigger]);\r\n\r\n  const platformBalance = useMemo(() => {\r\n    if (isAdminUser && user) return adminBalance || 0;\r\n    return 0;\r\n  }, [isAdminUser, user, adminBalance, balanceUpdateTrigger]);\r\n\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    const handleAdminBalanceUpdate = () => {\r\n      if (isAdminUser && user) setBalanceUpdateTrigger((prev) => prev + 1);\r\n    };\r\n    const handlePlatformBalanceUpdate = () => {\r\n      if (isAdminUser && user) setBalanceUpdateTrigger((prev) => prev + 1);\r\n    };\r\n    const handleBuyerBalanceUpdate = () => {\r\n      if (user?.role === 'buyer') setBalanceUpdateTrigger((prev) => prev + 1);\r\n    };\r\n    const handleSellerBalanceUpdate = () => {\r\n      if (user?.role === 'seller') setBalanceUpdateTrigger((prev) => prev + 1);\r\n    };\r\n\r\n    window.addEventListener('wallet:admin-balance-updated', handleAdminBalanceUpdate as EventListener);\r\n    window.addEventListener('wallet:platform-balance-updated', handlePlatformBalanceUpdate as EventListener);\r\n    window.addEventListener('platform:balance_update', handlePlatformBalanceUpdate as EventListener);\r\n    window.addEventListener('wallet:buyer-balance-updated', handleBuyerBalanceUpdate as EventListener);\r\n    window.addEventListener('wallet:seller-balance-updated', handleSellerBalanceUpdate as EventListener);\r\n\r\n    return () => {\r\n      window.removeEventListener('wallet:admin-balance-updated', handleAdminBalanceUpdate as EventListener);\r\n      window.removeEventListener('wallet:platform-balance-updated', handlePlatformBalanceUpdate as EventListener);\r\n      window.removeEventListener('platform:balance_update', handlePlatformBalanceUpdate as EventListener);\r\n      window.removeEventListener('wallet:buyer-balance-updated', handleBuyerBalanceUpdate as EventListener);\r\n      window.removeEventListener('wallet:seller-balance-updated', handleSellerBalanceUpdate as EventListener);\r\n    };\r\n  }, [isAdminUser, user]);\r\n\r\n  useEffect(() => {\r\n    if (isAdminUser && user && refreshAdminData && !hasRefreshedAdminData.current) {\r\n      hasRefreshedAdminData.current = true;\r\n      let cancelled = false;\r\n      const refreshOnce = async () => {\r\n        if (cancelled) return;\r\n        try {\r\n          await refreshAdminData();\r\n          setBalanceUpdateTrigger((prev) => prev + 1);\r\n        } catch (error) {\r\n          console.error('[Header] Error refreshing admin data:', error);\r\n        }\r\n      };\r\n      void refreshOnce();\r\n      return () => {\r\n        cancelled = true;\r\n      };\r\n    }\r\n    if (!user || !isAdminUser) {\r\n      hasRefreshedAdminData.current = false;\r\n    }\r\n    return undefined;\r\n  }, [isAdminUser, user?.id, refreshAdminData]);\r\n\r\n  const unreadCount = useMemo(() => {\r\n    if (!user?.username) return 0;\r\n    try {\r\n      const threads: Record<string, any[]> = {};\r\n      Object.values(messages)\r\n        .flat()\r\n        .forEach((msg: any) => {\r\n          if (msg.sender === user.username || msg.receiver === user.username) {\r\n            const otherParty = msg.sender === user.username ? msg.receiver : msg.sender;\r\n            if (!threads[otherParty]) threads[otherParty] = [];\r\n            threads[otherParty].push(msg);\r\n          }\r\n        });\r\n      let total = 0;\r\n      Object.entries(threads).forEach(([otherUser, msgs]) => {\r\n        const count = msgs.filter((m) => !m.read && m.sender === otherUser && m.receiver === user.username).length;\r\n        total += count;\r\n      });\r\n      return total;\r\n    } catch (error) {\r\n      console.error('Error calculating unread count:', error);\r\n      return 0;\r\n    }\r\n  }, [user?.username, messages]);\r\n\r\n  const forceUpdateBalances = useCallback(() => {\r\n    if (!isMountedRef.current) return;\r\n    const now = Date.now();\r\n    if (now - lastBalanceUpdate.current < 1000) return;\r\n    lastBalanceUpdate.current = now;\r\n    setBalanceUpdateTrigger((prev) => prev + 1);\r\n  }, []);\r\n\r\n  const checkAuctionsWithRateLimit = useCallback(() => {\r\n    if (!isMountedRef.current) return;\r\n    const now = Date.now();\r\n    if (now - lastAuctionCheck.current < 10000) return;\r\n    lastAuctionCheck.current = now;\r\n    try {\r\n      if (typeof checkEndedAuctions === 'function') {\r\n        checkEndedAuctions();\r\n        setTimeout(() => {\r\n          if (isMountedRef.current) setBalanceUpdateTrigger((prev) => prev + 1);\r\n        }, 1000);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error checking ended auctions:', err);\r\n    }\r\n  }, [checkEndedAuctions]);\r\n\r\n  const updateReportCount = useCallback(() => {\r\n    if (!isAdminUser || !isMountedRef.current) return;\r\n    try {\r\n      const count = getReportCount();\r\n      setReportCount(typeof count === 'number' && !isNaN(count) && count >= 0 ? count : 0);\r\n    } catch (err) {\r\n      console.error('Error updating report count:', err);\r\n      setReportCount(0);\r\n    }\r\n  }, [isAdminUser]);\r\n\r\n  // Add these handler functions for notifications\r\n  const handleClearOne = useCallback((notification: UINotification) => {\r\n    if (notification.source === 'legacy') {\r\n      clearSellerNotification(notification.id);\r\n    } else {\r\n      ctxClearNotification(notification.id);\r\n    }\r\n  }, [clearSellerNotification, ctxClearNotification]);\r\n\r\n  const handleRestoreOne = useCallback((notification: UINotification) => {\r\n    if (notification.source === 'legacy') {\r\n      restoreSellerNotification(notification.id);\r\n    } else {\r\n      ctxRestoreNotification(notification.id);\r\n    }\r\n  }, [restoreSellerNotification, ctxRestoreNotification]);\r\n\r\n  const handleDeleteOne = useCallback((notification: UINotification) => {\r\n    if (notification.source === 'legacy') {\r\n      permanentlyDeleteSellerNotification(notification.id);\r\n    } else {\r\n      ctxDeleteNotification(notification.id);\r\n    }\r\n  }, [permanentlyDeleteSellerNotification, ctxDeleteNotification]);\r\n\r\n  const clearAllNotifications = useCallback(() => {\r\n    setClearingNotifications(true);\r\n    processedNotifications.active.forEach((notification) => {\r\n      if (notification.source === 'legacy') {\r\n        clearSellerNotification(notification.id);\r\n      } else {\r\n        ctxClearNotification(notification.id);\r\n      }\r\n    });\r\n    // Also call the context clear all\r\n    ctxClearAll();\r\n    setTimeout(() => setClearingNotifications(false), 500);\r\n  }, [processedNotifications.active, clearSellerNotification, ctxClearNotification, ctxClearAll]);\r\n\r\n  const deleteAllClearedNotifications = useCallback(() => {\r\n    setDeletingNotifications(true);\r\n    processedNotifications.cleared.forEach((notification) => {\r\n      if (notification.source === 'legacy') {\r\n        permanentlyDeleteSellerNotification(notification.id);\r\n      } else {\r\n        ctxDeleteNotification(notification.id);\r\n      }\r\n    });\r\n    // Also call the context delete all cleared\r\n    ctxDeleteAllCleared();\r\n    setTimeout(() => setDeletingNotifications(false), 500);\r\n  }, [processedNotifications.cleared, permanentlyDeleteSellerNotification, ctxDeleteNotification, ctxDeleteAllCleared]);\r\n\r\n  const clearBalanceInterval = useInterval(() => {\r\n    if (isMountedRef.current) forceUpdateBalances();\r\n  }, 30000);\r\n\r\n  const clearAuctionInterval = useInterval(() => {\r\n    if (isMountedRef.current) checkAuctionsWithRateLimit();\r\n  }, 30000);\r\n\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n    isMountedRef.current = true;\r\n\r\n    const initTimer = setTimeout(() => {\r\n      if (isMountedRef.current) {\r\n        updateReportCount();\r\n        forceUpdateBalances();\r\n        checkAuctionsWithRateLimit();\r\n      }\r\n    }, 100);\r\n\r\n    const handleUpdateReports = () => isMountedRef.current && updateReportCount();\r\n    const handleAuctionEnd = () => isMountedRef.current && forceUpdateBalances();\r\n    const handleWalletUpdate = () => isMountedRef.current && forceUpdateBalances();\r\n\r\n    window.addEventListener('updateReports', handleUpdateReports);\r\n    window.addEventListener('auctionEnded', handleAuctionEnd);\r\n    window.addEventListener('walletUpdated', handleWalletUpdate as EventListener);\r\n\r\n    return () => {\r\n      isMountedRef.current = false;\r\n      clearTimeout(initTimer);\r\n      clearBalanceInterval();\r\n      clearAuctionInterval();\r\n      window.removeEventListener('updateReports', handleUpdateReports);\r\n      window.removeEventListener('auctionEnded', handleAuctionEnd);\r\n      window.removeEventListener('walletUpdated', handleWalletUpdate as EventListener);\r\n    };\r\n  }, []); // once\r\n\r\n  useEffect(() => {\r\n    if (showNotifDropdown) setActiveNotifTab('active');\r\n  }, [showNotifDropdown]);\r\n\r\n  const renderMobileLink = (href: string, icon: React.ReactNode, label: string, badge?: number) => (\r\n    <Link\r\n      href={href}\r\n      className=\"flex items-center gap-3 text-[#ff950e] hover:bg-[#ff950e]/10 p-3 rounded-lg transition-colors\"\r\n      onClick={() => setMobileMenuOpen(false)}\r\n      style={{ touchAction: 'manipulation' }}\r\n    >\r\n      {icon}\r\n      <span>{label}</span>\r\n      {badge && badge > 0 && <span className=\"bg-[#ff950e] text-white text-xs rounded-full px-2 py-0.5 ml-auto\">{badge}</span>}\r\n    </Link>\r\n  );\r\n\r\n  const MobileMenu = () => (\r\n    <div className={`mobile-menu fixed inset-0 z-50 lg:hidden ${mobileMenuOpen ? 'block' : 'hidden'}`}>\r\n      <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm\" onClick={() => setMobileMenuOpen(false)} />\r\n      <div\r\n        ref={mobileMenuRef}\r\n        className=\"fixed top-0 left-0 w-64 h-full bg-gradient-to-b from-[#1a1a1a] to-[#111] border-r border-[#ff950e]/30 overflow-y-auto overscroll-contain\"\r\n        style={{ touchAction: 'pan-y' }}\r\n      >\r\n        <div className=\"p-4 border-b border-[#ff950e]/30\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <img src=\"/logo.png\" alt=\"PantyPost\" className=\"w-8 h-auto\" />\r\n              <span className=\"text-[#ff950e] font-bold\">PantyPost</span>\r\n            </div>\r\n            <button\r\n              onClick={() => setMobileMenuOpen(false)}\r\n              className=\"text-[#ff950e] hover:text-white\"\r\n              aria-label=\"Close menu\"\r\n              style={{ touchAction: 'manipulation' }}\r\n            >\r\n              <X className=\"w-6 h-6\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <nav className=\"p-4 space-y-2\">\r\n          {renderMobileLink('/browse', <ShoppingBag className=\"w-5 h-5\" />, 'Browse')}\r\n\r\n          {isAdminUser && (\r\n            <>\r\n              <div className=\"flex items-center gap-2 px-3 py-2 bg-purple-900/20 rounded-lg\">\r\n                <Crown className=\"w-4 h-4 text-purple-400\" />\r\n                <span className=\"text-purple-300 font-bold\">ADMIN</span>\r\n              </div>\r\n              {renderMobileLink('/admin/reports', <Shield className=\"w-5 h-5\" />, 'Reports', reportCount)}\r\n              {renderMobileLink('/wallet/admin', <WalletIcon className=\"w-5 h-5\" />, `Wallet: $${platformBalance.toFixed(2)}`)}\r\n            </>\r\n          )}\r\n\r\n          {role === 'seller' && !isAdminUser && (\r\n            <>\r\n              {renderMobileLink('/sellers/my-listings', <Package className=\"w-5 h-5\" />, 'My Listings')}\r\n              {renderMobileLink('/sellers/profile', <User className=\"w-5 h-5\" />, 'Profile')}\r\n              {renderMobileLink('/sellers/messages', <MessageSquare className=\"w-5 h-5\" />, 'Messages', unreadCount)}\r\n              {renderMobileLink('/sellers/orders-to-fulfil', <Package className=\"w-5 h-5\" />, 'Orders to Fulfil', pendingOrdersCount)}\r\n              {renderMobileLink('/wallet/seller', <WalletIcon className=\"w-5 h-5\" />, `Wallet: $${Math.max(sellerBalance, 0).toFixed(2)}`)}\r\n            </>\r\n          )}\r\n\r\n          {role === 'buyer' && !isAdminUser && (\r\n            <>\r\n              {renderMobileLink('/buyers/dashboard', <User className=\"w-5 h-5\" />, 'Dashboard')}\r\n              {renderMobileLink('/buyers/my-orders', <Package className=\"w-5 h-5\" />, 'My Orders')}\r\n              {renderMobileLink('/buyers/messages', <MessageSquare className=\"w-5 h-5\" />, 'Messages', unreadCount)}\r\n              {renderMobileLink('/wallet/buyer', <WalletIcon className=\"w-5 h-5\" />, `Wallet: $${Math.max(buyerBalance, 0).toFixed(2)}`)}\r\n            </>\r\n          )}\r\n\r\n          {user && (\r\n            <button\r\n              onClick={() => {\r\n                setMobileMenuOpen(false);\r\n                logout();\r\n              }}\r\n              className=\"flex items-center gap-3 text-[#ff950e] hover:bg-[#ff950e]/10 p-3 rounded-lg transition-colors w-full text-left\"\r\n              style={{ touchAction: 'manipulation' }}\r\n            >\r\n              <LogOut className=\"w-5 h-5\" />\r\n              <span>Log out</span>\r\n            </button>\r\n          )}\r\n        </nav>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  if (pathname === '/login' || pathname === '/signup') return null;\r\n\r\n  return (\r\n    <>\r\n      <header className=\"bg-gradient-to-r from-[#0a0a0a] via-[#111111] to-[#0a0a0a] text-white shadow-2xl px-4 lg:px-6 py-3 flex justify-between items-center z-40 relative border-b border-[#ff950e]/20 backdrop-blur-sm\">\r\n        <Link href=\"/\" className=\"flex items-center gap-3 group\">\r\n          <div className=\"relative\">\r\n            <div className=\"absolute -inset-2 bg-gradient-to-r from-[#ff950e] to-[#ff6b00] rounded-xl blur opacity-30 group-hover:opacity-50 transition duration-300\"></div>\r\n            <img src=\"/logo.png\" alt=\"PantyPost Logo\" className=\"relative w-16 lg:w-24 h-auto drop-shadow-2xl transform group-hover:scale-105 transition duration-300\" />\r\n          </div>\r\n        </Link>\r\n\r\n        {isMobile && (\r\n          <button\r\n            onClick={() => setMobileMenuOpen(true)}\r\n            className=\"lg:hidden flex items-center justify-center w-10 h-10 bg-[#ff950e] text-black rounded-lg hover:bg-[#ff6b00] transition-colors\"\r\n            aria-label=\"Open menu\"\r\n            style={{ touchAction: 'manipulation' }}\r\n          >\r\n            <Menu className=\"w-6 h-6\" />\r\n          </button>\r\n        )}\r\n\r\n        <nav className={`${isMobile ? 'hidden' : 'flex'} items-center gap-x-2`}>\r\n          <Link\r\n            href=\"/browse\"\r\n            className=\"group flex items-center gap-1.5 bg-gradient-to-r from-[#1a1a1a] to-[#222] hover:from-[#ff950e]/20 hover:to-[#ff6b00]/20 text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 shadow-lg hover:shadow-[#ff950e]/20 text-xs\"\r\n          >\r\n            <ShoppingBag className=\"w-3.5 h-3.5 group-hover:scale-110 transition-transform\" />\r\n            <span className=\"font-medium\">Browse</span>\r\n          </Link>\r\n\r\n          {isAdminUser && (\r\n            <>\r\n              <div className=\"flex items-center gap-1.5 px-2.5 py-1 bg-gradient-to-r from-purple-900/20 to-pink-900/20 rounded-lg border border-purple-500/30\">\r\n                <Crown className=\"w-3.5 h-3.5 text-purple-400\" />\r\n                <span className=\"text-[10px] font-bold text-purple-300\">ADMIN</span>\r\n              </div>\r\n\r\n              <div className=\"relative flex items-center\">\r\n                <Link\r\n                  href=\"/admin/reports\"\r\n                  className=\"group flex items-center gap-1.5 bg-gradient-to-r from-red-900/20 to-orange-900/20 hover:from-red-900/30 hover:to-orange-900/30 text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-red-500/30 hover:border-red-500/50 shadow-lg text-xs\"\r\n                >\r\n                  <Shield className=\"w-3.5 h-3.5 text-red-400\" />\r\n                  <span className=\"font-medium\">Reports</span>\r\n                  {reportCount > 0 && (\r\n                    <span className=\"absolute -top-2 -right-2 bg-gradient-to-r from-red-600 to-red-500 text-white text-[10px] rounded-full px-1.5 py-0.5 min-w-[18px] text-center border-2 border-white font-bold shadow-lg animate-pulse\">\r\n                      {reportCount}\r\n                    </span>\r\n                  )}\r\n                </Link>\r\n              </div>\r\n\r\n              <Link\r\n                href=\"/admin/bans\"\r\n                className=\"flex items-center gap-1.5 bg-gradient-to-r from-purple-900/20 to-red-900/20 hover:from-purple-900/30 hover:to-red-900/30 text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-purple-500/30 hover:border-purple-500/50 text-xs\"\r\n              >\r\n                <Ban className=\"w-3.5 h-3.5 text-purple-400\" />\r\n                <span>Bans</span>\r\n              </Link>\r\n\r\n              <Link\r\n                href=\"/admin/resolved\"\r\n                className=\"flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#444] text-xs\"\r\n              >\r\n                <ShieldCheck className=\"w-3.5 h-3.5 text-green-400\" />\r\n                <span>Resolved</span>\r\n              </Link>\r\n\r\n              <Link\r\n                href=\"/admin/messages\"\r\n                className=\"flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#444] text-xs relative\"\r\n              >\r\n                <MessageSquare className=\"w-3.5 h-3.5 text-blue-400\" />\r\n                <span>Messages</span>\r\n                {unreadCount > 0 && (\r\n                  <span className=\"absolute -top-2 -right-2 bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-white text-[10px] rounded-full px-1.5 py-0.5 min-w-[18px] text-center border-2 border-white font-bold shadow-lg animate-bounce\">\r\n                    {unreadCount}\r\n                  </span>\r\n                )}\r\n              </Link>\r\n\r\n              <Link\r\n                href=\"/admin/verification-requests\"\r\n                className=\"flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#444] text-xs\"\r\n              >\r\n                <ClipboardCheck className=\"w-3.5 h-3.5 text-yellow-400\" />\r\n                <span>Verify</span>\r\n              </Link>\r\n\r\n              <Link\r\n                href=\"/admin/wallet-management\"\r\n                className=\"flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#444] text-xs\"\r\n              >\r\n                <DollarSign className=\"w-3.5 h-3.5 text-green-400\" />\r\n                <span>Wallets</span>\r\n              </Link>\r\n\r\n              <Link\r\n                href=\"/wallet/admin\"\r\n                className=\"flex items-center gap-1.5 bg-gradient-to-r from-purple-900/20 to-pink-900/20 hover:from-purple-900/30 hover:to-pink-900/30 text-white px-3 py-1.5 rounded-lg transition-all duration-300 border border-purple-500/30 hover:border-purple-500/50 text-xs\"\r\n                onClick={(e) => {\r\n                  e.preventDefault();\r\n                  e.stopPropagation();\r\n                  window.location.href = '/wallet/admin';\r\n                }}\r\n                style={{ touchAction: 'manipulation' }}\r\n              >\r\n                <WalletIcon className=\"w-3.5 h-3.5 text-purple-400\" />\r\n                <span className=\"font-bold text-purple-300\">${platformBalance.toFixed(2)}</span>\r\n              </Link>\r\n            </>\r\n          )}\r\n\r\n          {role === 'seller' && !isAdminUser && (\r\n            <>\r\n              {/* Correct order: Browse, My Listings, Profile, Get Verified, Messages, Analytics, Wallet, Orders to Fulfil, Bell, Username, Logout */}\r\n              \r\n              <Link href=\"/sellers/my-listings\" className=\"group flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 text-xs\">\r\n                <Package className=\"w-3.5 h-3.5 group-hover:text-[#ff950e] transition-colors\" />\r\n                <span>My Listings</span>\r\n              </Link>\r\n\r\n              <Link href=\"/sellers/profile\" className=\"group flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 text-xs\">\r\n                <User className=\"w-3.5 h-3.5 group-hover:text-[#ff950e] transition-colors\" />\r\n                <span>Profile</span>\r\n              </Link>\r\n\r\n              <Link href=\"/sellers/verify\" className=\"group flex items-center gap-1.5 bg-gradient-to-r from-green-900/20 to-emerald-900/20 hover:from-green-900/30 hover:to-emerald-900/30 text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-green-500/30 hover:border-green-500/50 shadow-lg text-xs\">\r\n                <ShieldCheck className=\"w-3.5 h-3.5 text-green-400 group-hover:scale-110 transition-transform\" />\r\n                <span className=\"font-medium\">Get Verified</span>\r\n              </Link>\r\n\r\n              <Link href=\"/sellers/messages\" className=\"relative group\">\r\n                <div className=\"flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 text-xs\">\r\n                  <MessageSquare className=\"w-3.5 h-3.5 group-hover:text-[#ff950e] transition-colors\" />\r\n                  <span>Messages</span>\r\n                </div>\r\n                {unreadCount > 0 && (\r\n                  <span className=\"absolute -top-2 -right-2 bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-white text-[10px] rounded-full px-1.5 py-0.5 min-w-[18px] text-center border-2 border-white font-bold shadow-lg animate-bounce\">\r\n                    {unreadCount}\r\n                  </span>\r\n                )}\r\n              </Link>\r\n\r\n              <Link href=\"/sellers/subscribers\" className=\"group flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 text-xs\">\r\n                <Users className=\"w-3.5 h-3.5 group-hover:text-[#ff950e] transition-colors\" />\r\n                <span>Analytics</span>\r\n              </Link>\r\n\r\n              <Link\r\n                href=\"/wallet/seller\"\r\n                className=\"group flex items-center gap-1.5 bg-gradient-to-r from-[#ff950e]/10 to-[#ff6b00]/10 hover:from-[#ff950e]/20 hover:to-[#ff6b00]/20 text-white px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#ff950e]/30 hover:border-[#ff950e]/50 shadow-lg text-xs\"\r\n                onClick={(e) => {\r\n                  e.preventDefault();\r\n                  e.stopPropagation();\r\n                  window.location.href = '/wallet/seller';\r\n                }}\r\n                style={{ touchAction: 'manipulation' }}\r\n              >\r\n                <WalletIcon className=\"w-3.5 h-3.5 text-[#ff950e]\" />\r\n                <span className=\"font-bold text-[#ff950e]\">${Math.max(sellerBalance, 0).toFixed(2)}</span>\r\n              </Link>\r\n\r\n              <Link href=\"/sellers/orders-to-fulfil\" className=\"relative group flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 text-xs\">\r\n                <Package className=\"w-3.5 h-3.5 group-hover:text-[#ff950e] transition-colors\" />\r\n                <span>Orders to Fulfil</span>\r\n                {pendingOrdersCount > 0 && (\r\n                  <span className=\"absolute -top-2 -right-2 bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-white text-[10px] rounded-full px-1.5 py-0.5 min-w-[18px] text-center border-2 border-white font-bold shadow-lg animate-pulse\">\r\n                    {pendingOrdersCount}\r\n                  </span>\r\n                )}\r\n              </Link>\r\n\r\n              <div className=\"relative flex items-center\" ref={notifRef}>\r\n                <button\r\n                  onClick={() => setShowNotifDropdown((prev) => !prev)}\r\n                  className=\"relative flex items-center justify-center w-10 h-10 bg-[#ff950e] border border-white rounded-full shadow hover:scale-105 transition hover:bg-[#ff6b00]\"\r\n                  aria-label=\"Notifications\"\r\n                  style={{ touchAction: 'manipulation' }}\r\n                >\r\n                  <Bell className=\"w-6 h-6 text-black\" />\r\n                  {processedNotifications.active.length > 0 && (\r\n                    <span className=\"absolute -top-1.5 -right-1.5 bg-white text-[#ff950e] text-[11px] rounded-full px-1.5 py-0.5 min-w-[18px] text-center border-2 border-[#ff950e] font-bold shadow-lg\">\r\n                      {processedNotifications.active.length}\r\n                    </span>\r\n                  )}\r\n                </button>\r\n\r\n                {showNotifDropdown && (\r\n                  <div className=\"absolute right-0 top-12 w-80 bg-gradient-to-b from-[#1a1a1a] to-[#111] text-white rounded-2xl shadow-2xl z-50 border border-[#ff950e]/30 overflow-hidden backdrop-blur-md\">\r\n                    <div className=\"bg-gradient-to-r from-[#ff950e]/20 to-[#ff6b00]/20 px-4 py-2 border-b border-[#ff950e]/30\">\r\n                      <div className=\"flex justify-between items-center\">\r\n                        <h3 className=\"text-sm font-bold text-[#ff950e]\">Notifications</h3>\r\n                        {activeNotifTab === 'active' && processedNotifications.active.length > 0 && (\r\n                          <button\r\n                            onClick={clearAllNotifications}\r\n                            disabled={clearingNotifications}\r\n                            className=\"text-xs text-white hover:text-[#ff950e] font-medium transition-colors px-2 py-1 rounded bg-black/20 hover:bg-[#ff950e]/10 border border-white/20 hover:border-[#ff950e]/30 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            style={{ touchAction: 'manipulation' }}\r\n                          >\r\n                            {clearingNotifications ? 'Clearing...' : 'Clear All'}\r\n                          </button>\r\n                        )}\r\n                        {activeNotifTab === 'cleared' && processedNotifications.cleared.length > 0 && (\r\n                          <button\r\n                            onClick={deleteAllClearedNotifications}\r\n                            disabled={deletingNotifications}\r\n                            className=\"text-xs text-white hover:text-red-400 font-medium transition-colors px-2 py-1 rounded bg-red-900/20 hover:bg-red-900/30 border border-red-500/30 hover:border-red-500/50 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            style={{ touchAction: 'manipulation' }}\r\n                          >\r\n                            {deletingNotifications ? 'Deleting...' : 'Delete All'}\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex border-b border-gray-800\">\r\n                      <button\r\n                        onClick={() => setActiveNotifTab('active')}\r\n                        className={`flex-1 px-4 py-2 text-xs font-medium transition-colors relative ${\r\n                          activeNotifTab === 'active' ? 'text-[#ff950e] bg-[#ff950e]/10' : 'text-gray-400 hover:text-gray-300 hover:bg-[#222]/50'\r\n                        }`}\r\n                        style={{ touchAction: 'manipulation' }}\r\n                      >\r\n                        Active ({processedNotifications.active.length})\r\n                        {activeNotifTab === 'active' && <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-[#ff950e]\" />}\r\n                      </button>\r\n                      <button\r\n                        onClick={() => setActiveNotifTab('cleared')}\r\n                        className={`flex-1 px-4 py-2 text-xs font-medium transition-colors relative ${\r\n                          activeNotifTab === 'cleared' ? 'text-[#ff950e] bg-[#ff950e]/10' : 'text-gray-400 hover:text-gray-300 hover:bg-[#222]/50'\r\n                        }`}\r\n                        style={{ touchAction: 'manipulation' }}\r\n                      >\r\n                        Cleared ({processedNotifications.cleared.length})\r\n                        {activeNotifTab === 'cleared' && <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-[#ff950e]\" />}\r\n                      </button>\r\n                    </div>\r\n\r\n                    <ul className=\"divide-y divide-gray-800 max-h-64 overflow-y-auto overscroll-contain\">\r\n                      {activeNotifTab === 'active' ? (\r\n                        processedNotifications.active.length === 0 ? (\r\n                          <li className=\"p-4 text-sm text-center text-gray-400\">No active notifications</li>\r\n                        ) : (\r\n                          processedNotifications.active.map((notification, i) => (\r\n                            <li key={notification.id || i} className=\"flex justify-between items-start p-3 text-sm hover:bg-[#222]/50 transition-colors\">\r\n                              <div className=\"flex-1 pr-2\">\r\n                                <SecureMessageDisplay content={notification.message} className=\"text-gray-200 leading-snug\" allowBasicFormatting={false} />\r\n                                {notification.timestamp && (\r\n                                  <div className=\"text-xs text-gray-500 mt-1\">{new Date(notification.timestamp).toLocaleString()}</div>\r\n                                )}\r\n                              </div>\r\n                              <button\r\n                                onClick={() => handleClearOne(notification)}\r\n                                className=\"text-xs text-[#ff950e] hover:text-[#ff6b00] font-bold transition-colors whitespace-nowrap\"\r\n                                style={{ touchAction: 'manipulation' }}\r\n                              >\r\n                                Clear\r\n                              </button>\r\n                            </li>\r\n                          ))\r\n                        )\r\n                      ) : processedNotifications.cleared.length === 0 ? (\r\n                        <li className=\"p-4 text-sm text-center text-gray-400\">No cleared notifications</li>\r\n                      ) : (\r\n                        processedNotifications.cleared.map((notification, i) => (\r\n                          <li key={notification.id || `cleared-${i}`} className=\"flex justify-between items-start p-3 text-sm hover:bg-[#222]/50 transition-colors\">\r\n                            <div className=\"flex-1 pr-2\">\r\n                              <SecureMessageDisplay content={notification.message} className=\"text-gray-400 leading-snug\" allowBasicFormatting={false} />\r\n                              {notification.timestamp && <div className=\"text-xs text-gray-600 mt-1\">{new Date(notification.timestamp).toLocaleString()}</div>}\r\n                            </div>\r\n                            <div className=\"flex gap-2 flex-col\">\r\n                              <button\r\n                                onClick={() => handleRestoreOne(notification)}\r\n                                className=\"text-xs text-green-400 hover:text-green-300 font-bold transition-colors whitespace-nowrap flex items-center gap-1\"\r\n                                title=\"Restore notification\"\r\n                                style={{ touchAction: 'manipulation' }}\r\n                              >\r\n                                <RotateCcw className=\"w-3 h-3\" />\r\n                                Restore\r\n                              </button>\r\n                              <button\r\n                                onClick={() => handleDeleteOne(notification)}\r\n                                className=\"text-xs text-red-400 hover:text-red-300 font-bold transition-colors whitespace-nowrap flex items-center gap-1\"\r\n                                title=\"Delete permanently\"\r\n                                style={{ touchAction: 'manipulation' }}\r\n                              >\r\n                                <Trash2 className=\"w-3 h-3\" />\r\n                                Delete\r\n                              </button>\r\n                            </div>\r\n                          </li>\r\n                        ))\r\n                      )}\r\n                    </ul>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          {role === 'buyer' && !isAdminUser && (\r\n            <>\r\n              <Link href=\"/buyers/dashboard\" className=\"group flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 text-xs\">\r\n                <User className=\"w-3.5 h-3.5 group-hover:text-[#ff950e] transition-colors\" />\r\n                <span>Dashboard</span>\r\n              </Link>\r\n\r\n              <Link href=\"/buyers/my-orders\" className=\"group flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 text-xs\">\r\n                <Package className=\"w-3.5 h-3.5 group-hover:text-[#ff950e] transition-colors\" />\r\n                <span>My Orders</span>\r\n              </Link>\r\n\r\n              <Link\r\n                href=\"/wallet/buyer\"\r\n                className=\"group flex items-center gap-1.5 bg-gradient-to-r from-purple-600/20 to-purple-700/20 hover:from-purple-600/30 hover:to-purple-700/30 text-white px-3 py-1.5 rounded-lg transition-all duration-300 border border-purple-500/30 hover:border-purple-500/50 shadow-lg text-xs\"\r\n                onClick={(e) => {\r\n                  e.preventDefault();\r\n                  e.stopPropagation();\r\n                  window.location.href = '/wallet/buyer';\r\n                }}\r\n                style={{ touchAction: 'manipulation' }}\r\n              >\r\n                <WalletIcon className=\"w-3.5 h-3.5 text-purple-400\" />\r\n                <span className=\"font-bold text-purple-400\">${Math.max(buyerBalance, 0).toFixed(2)}</span>\r\n              </Link>\r\n\r\n              <Link href=\"/buyers/messages\" className=\"relative group\">\r\n                <div className=\"flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 text-xs\">\r\n                  <MessageSquare className=\"w-3.5 h-3.5 group-hover:text-[#ff950e] transition-colors\" />\r\n                  <span>Messages</span>\r\n                </div>\r\n                {unreadCount > 0 && (\r\n                  <span className=\"absolute -top-2 -right-2 bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-white text-[10px] rounded-full px-1.5 py-0.5 min-w-[18px] text-center border-2 border-white font-bold shadow-lg animate-bounce\">\r\n                    {unreadCount}\r\n                  </span>\r\n                )}\r\n              </Link>\r\n            </>\r\n          )}\r\n\r\n          {!user && (\r\n            <div className=\"flex items-center gap-2\">\r\n              <Link\r\n                href=\"/login\"\r\n                className=\"bg-gradient-to-r from-[#1a1a1a] to-[#222] hover:from-[#222] hover:to-[#333] text-[#ff950e] text-xs font-bold px-4 py-2 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 shadow-lg hover:shadow-[#ff950e]/20\"\r\n              >\r\n                Log In\r\n              </Link>\r\n              <Link\r\n                href=\"/signup\"\r\n                className=\"bg-gradient-to-r from-[#ff950e] to-[#ff6b00] hover:from-[#ff6b00] hover:to-[#ff950e] text-black text-xs font-bold px-4 py-2 rounded-lg transition-all duration-300 shadow-xl hover:shadow-2xl hover:shadow-[#ff950e]/30 transform hover:scale-105 border border-white/20\"\r\n                style={{ color: '#000' }}\r\n              >\r\n                Sign Up\r\n              </Link>\r\n            </div>\r\n          )}\r\n\r\n          {user && (\r\n            <div className=\"flex items-center gap-2 ml-1\">\r\n              <div className=\"flex items-center gap-1.5 bg-gradient-to-r from-[#ff950e]/10 to-[#ff6b00]/10 px-3 py-1.5 rounded-lg border border-[#ff950e]/30\">\r\n                {role === 'seller' && <Heart className=\"w-3.5 h-3.5 text-[#ff950e]\" />}\r\n                {role === 'buyer' && <ShoppingBag className=\"w-3.5 h-3.5 text-[#ff950e]\" />}\r\n                {isAdminUser && <Crown className=\"w-3.5 h-3.5 text-purple-400\" />}\r\n                <span className=\"text-[#ff950e] font-bold text-xs\">{username}</span>\r\n                <span className=\"text-gray-400 text-[10px]\">({isAdminUser ? 'admin' : role})</span>\r\n              </div>\r\n              <button\r\n                onClick={logout}\r\n                className=\"group flex items-center gap-1.5 bg-[#1a1a1a] hover:bg-[#222] text-[#ff950e] px-3 py-1.5 rounded-lg transition-all duration-300 border border-[#333] hover:border-[#ff950e]/50 text-xs cursor-pointer\"\r\n                style={{ touchAction: 'manipulation' }}\r\n              >\r\n                <LogOut className=\"w-3.5 h-3.5 group-hover:text-[#ff950e] transition-colors\" />\r\n                <span>Log out</span>\r\n              </button>\r\n            </div>\r\n          )}\r\n        </nav>\r\n      </header>\r\n\r\n      <MobileMenu />\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3128, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/AgeVerificationModal.tsx"],"sourcesContent":["// src/components/AgeVerificationModal.tsx\r\n'use client';\r\n\r\nimport { useState } from 'react';\r\n\r\nconst AGE_VERIFIED_KEY = 'pantypost_age_verified';\r\n\r\nexport default function AgeVerificationModal(): React.ReactElement | null {\r\n  // Initialize state based on localStorage\r\n  const [isVerified, setIsVerified] = useState<boolean>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      try {\r\n        return localStorage.getItem(AGE_VERIFIED_KEY) === 'true';\r\n      } catch (error) {\r\n        console.error('Error reading age verification:', error);\r\n        return false;\r\n      }\r\n    }\r\n    return false;\r\n  });\r\n\r\n  const handleYes = () => {\r\n    try {\r\n      localStorage.setItem(AGE_VERIFIED_KEY, 'true');\r\n      setIsVerified(true);\r\n    } catch (error) {\r\n      console.error('Error saving age verification:', error);\r\n      setIsVerified(true);\r\n    }\r\n  };\r\n\r\n  const handleNo = () => {\r\n    window.location.href = 'https://www.google.com';\r\n  };\r\n\r\n  if (isVerified) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/90 backdrop-blur-lg z-[100] flex items-center justify-center p-4\">\r\n      <div className=\"bg-[#161616] border-2 border-[#ff950e]/50 p-8 rounded-2xl max-w-md w-full shadow-2xl shadow-[#ff950e]/10\">\r\n        <h2 className=\"text-2xl font-bold text-[#ff950e] mb-4 text-center\">Age Verification</h2>\r\n        <p className=\"mb-6 text-center text-gray-300\">\r\n          You must be at least 21 years old to enter this site. By entering, you confirm you are at least 21 years old.\r\n        </p>\r\n        <p className=\"text-sm mb-6 text-center text-gray-400\">By entering our website, you agree to the terms & conditions.</p>\r\n        <div className=\"flex gap-4 justify-center\">\r\n          <button\r\n            onClick={handleYes}\r\n            type=\"button\"\r\n            className=\"group relative inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-[#ff950e] to-[#ffb347] text-black font-bold rounded-full overflow-hidden transition-all duration-300 ease-out hover:scale-105 hover:shadow-lg hover:shadow-[#ff950e]/30 active:scale-95 focus:outline-none focus-visible:ring-2 focus-visible:ring-[#ff950e] focus-visible:ring-offset-2 focus-visible:ring-offset-black\"\r\n          >\r\n            <span className=\"relative z-10\">I am 21+</span>\r\n          </button>\r\n          <button\r\n            onClick={handleNo}\r\n            type=\"button\"\r\n            className=\"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-full transition-all duration-300 ease-out hover:scale-105 active:scale-95 focus:outline-none focus-visible:ring-2 focus-visible:ring-gray-500 focus-visible:ring-offset-2 focus-visible:ring-offset-black\"\r\n          >\r\n            Exit\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,0CAA0C;;;;;AAG1C;;;AAFA;;AAIA,MAAM,mBAAmB;AAEV,SAAS;;IACtB,yCAAyC;IACzC,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD;yCAAW;YACpD,wCAAmC;gBACjC,IAAI;oBACF,OAAO,aAAa,OAAO,CAAC,sBAAsB;gBACpD,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,mCAAmC;oBACjD,OAAO;gBACT;YACF;YACA,OAAO;QACT;;IAEA,MAAM,YAAY;QAChB,IAAI;YACF,aAAa,OAAO,CAAC,kBAAkB;YACvC,cAAc;QAChB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,kCAAkC;YAChD,cAAc;QAChB;IACF;IAEA,MAAM,WAAW;QACf,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;IAEA,IAAI,YAAY,OAAO;IAEvB,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;8BAAqD;;;;;;8BACnE,6LAAC;oBAAE,WAAU;8BAAiC;;;;;;8BAG9C,6LAAC;oBAAE,WAAU;8BAAyC;;;;;;8BACtD,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BACC,SAAS;4BACT,MAAK;4BACL,WAAU;sCAEV,cAAA,6LAAC;gCAAK,WAAU;0CAAgB;;;;;;;;;;;sCAElC,6LAAC;4BACC,SAAS;4BACT,MAAK;4BACL,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAOX;GAzDwB;KAAA","debugId":null}},
    {"offset": {"line": 3258, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/ui/SecureInput.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect, forwardRef } from 'react';\r\nimport { Eye, EyeOff, AlertCircle, CheckCircle, Info } from 'lucide-react';\r\nimport { sanitizeStrict, sanitizeEmail } from '@/utils/security/sanitization';\r\n\r\ninterface SecureInputProps\r\n  extends Omit<React.InputHTMLAttributes<HTMLInputElement>, 'onChange'> {\r\n  label?: string;\r\n  error?: string;\r\n  touched?: boolean;\r\n  success?: boolean;\r\n  helpText?: string;\r\n  sanitize?: boolean;\r\n  sanitizer?: (value: string) => string;\r\n  onChange?: (value: string) => void;\r\n  onBlur?: () => void;\r\n  showPasswordToggle?: boolean;\r\n  showStrengthIndicator?: boolean;\r\n  validationIndicator?: boolean;\r\n  maxLength?: number;\r\n  characterCount?: boolean;\r\n}\r\n\r\n/**\r\n * Secure input component with built-in sanitization and validation indicators\r\n */\r\nexport const SecureInput = forwardRef<HTMLInputElement, SecureInputProps>(\r\n  (\r\n    {\r\n      label,\r\n      error,\r\n      touched,\r\n      success,\r\n      helpText,\r\n      sanitize = true,\r\n      sanitizer,\r\n      onChange,\r\n      onBlur,\r\n      type = 'text',\r\n      showPasswordToggle = false,\r\n      showStrengthIndicator = false,\r\n      validationIndicator = true,\r\n      maxLength,\r\n      characterCount = false,\r\n      className = '',\r\n      id,\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const [value, setValue] = useState((props.value as string) || '');\r\n    const [isFocused, setIsFocused] = useState(false);\r\n\r\n    // Keep internal value synchronized with external value prop\r\n    useEffect(() => {\r\n      setValue((props.value as string) ?? '');\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [props.value]);\r\n\r\n    // Determine input type (preserve native types other than password)\r\n    const inputType = type === 'password' ? (showPassword ? 'text' : 'password') : type;\r\n\r\n    // Handle input change with sanitization\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n      let newValue = e.target.value;\r\n\r\n      // Apply sanitization\r\n      if (sanitize) {\r\n        if (sanitizer) {\r\n          newValue = sanitizer(newValue);\r\n        } else if (type === 'email') {\r\n          newValue = sanitizeEmail(newValue);\r\n        } else if (type !== 'password') {\r\n          newValue = sanitizeStrict(newValue);\r\n        }\r\n      }\r\n\r\n      // Apply max length\r\n      if (maxLength && newValue.length > maxLength) {\r\n        newValue = newValue.slice(0, maxLength);\r\n      }\r\n\r\n      setValue(newValue);\r\n      onChange?.(newValue);\r\n    };\r\n\r\n    // Handle paste event with extra sanitization\r\n    const handlePaste = (e: React.ClipboardEvent) => {\r\n      if (!sanitize) return;\r\n\r\n      e.preventDefault();\r\n      const pastedText = e.clipboardData.getData('text');\r\n      let sanitizedText = pastedText;\r\n\r\n      if (sanitizer) {\r\n        sanitizedText = sanitizer(pastedText);\r\n      } else if (type === 'email') {\r\n        sanitizedText = sanitizeEmail(pastedText);\r\n      } else if (type !== 'password') {\r\n        sanitizedText = sanitizeStrict(pastedText);\r\n      }\r\n\r\n      const newValue = value + sanitizedText;\r\n      setValue(maxLength ? newValue.slice(0, maxLength) : newValue);\r\n      onChange?.(newValue);\r\n    };\r\n\r\n    // Determine border color based on state\r\n    const getBorderColor = () => {\r\n      if (isFocused) {\r\n        if (error && touched) return 'border-red-500 focus:ring-red-500';\r\n        if (success && touched) return 'border-green-500 focus:ring-green-500';\r\n        return 'border-[#ff950e] focus:ring-[#ff950e]';\r\n      }\r\n\r\n      if (error && touched) return 'border-red-500/50';\r\n      if (success && touched) return 'border-green-500/50';\r\n      return 'border-gray-700';\r\n    };\r\n\r\n    return (\r\n      <div className=\"w-full\">\r\n        {label && (\r\n          <label htmlFor={id} className=\"block text-sm font-medium text-gray-300 mb-1.5\">\r\n            {label}\r\n            {props.required && <span className=\"text-red-400 ml-1\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        <div className=\"relative\">\r\n          <input\r\n            ref={ref}\r\n            id={id}\r\n            type={inputType}\r\n            value={value}\r\n            onChange={handleChange}\r\n            onPaste={handlePaste}\r\n            onFocus={() => setIsFocused(true)}\r\n            onBlur={() => {\r\n              setIsFocused(false);\r\n              onBlur?.();\r\n            }}\r\n            className={`\r\n              w-full px-3.5 py-2.5 bg-black/50 border rounded-lg \r\n              text-white placeholder-gray-500 focus:outline-none focus:ring-1 \r\n              transition-colors ${getBorderColor()} ${className}\r\n              ${showPasswordToggle || validationIndicator ? 'pr-10' : ''}\r\n            `}\r\n            {...props}\r\n          />\r\n\r\n          {/* Password toggle button */}\r\n          {showPasswordToggle && type === 'password' && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setShowPassword(!showPassword)}\r\n              className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-300 transition-colors\"\r\n              tabIndex={-1}\r\n            >\r\n              {showPassword ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\r\n            </button>\r\n          )}\r\n\r\n          {/* Validation indicator */}\r\n          {validationIndicator && !showPasswordToggle && touched && (\r\n            <div className=\"absolute right-3 top-1/2 -translate-y-1/2\">\r\n              {error ? (\r\n                <AlertCircle className=\"w-4 h-4 text-red-400\" />\r\n              ) : success ? (\r\n                <CheckCircle className=\"w-4 h-4 text-green-400\" />\r\n              ) : null}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Error, success, or help text */}\r\n        {touched && error && (\r\n          <p className=\"mt-1 text-xs text-red-400 flex items-center gap-1\">\r\n            <AlertCircle className=\"w-3 h-3\" />\r\n            {error}\r\n          </p>\r\n        )}\r\n\r\n        {!error && helpText && (\r\n          <p className=\"mt-1 text-xs text-gray-500 flex items-center gap-1\">\r\n            <Info className=\"w-3 h-3\" />\r\n            {helpText}\r\n          </p>\r\n        )}\r\n\r\n        {/* Character count */}\r\n        {characterCount && maxLength && (\r\n          <p\r\n            className={`mt-1 text-xs text-right ${\r\n              value.length >= maxLength ? 'text-red-400' : 'text-gray-500'\r\n            }`}\r\n          >\r\n            {value.length}/{maxLength}\r\n          </p>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nSecureInput.displayName = 'SecureInput';\r\n\r\n/**\r\n * Secure textarea component with similar features\r\n */\r\ninterface SecureTextareaProps\r\n  extends Omit<React.TextareaHTMLAttributes<HTMLTextAreaElement>, 'onChange'> {\r\n  label?: string;\r\n  error?: string;\r\n  touched?: boolean;\r\n  success?: boolean;\r\n  helpText?: string;\r\n  sanitize?: boolean;\r\n  sanitizer?: (value: string) => string;\r\n  onChange?: (value: string) => void;\r\n  onBlur?: () => void;\r\n  maxLength?: number;\r\n  characterCount?: boolean;\r\n  resize?: 'none' | 'vertical' | 'horizontal' | 'both';\r\n}\r\n\r\nexport const SecureTextarea = forwardRef<HTMLTextAreaElement, SecureTextareaProps>(\r\n  (\r\n    {\r\n      label,\r\n      error,\r\n      touched,\r\n      success,\r\n      helpText,\r\n      sanitize = true,\r\n      sanitizer,\r\n      onChange,\r\n      onBlur,\r\n      maxLength,\r\n      characterCount = true,\r\n      resize = 'vertical',\r\n      className = '',\r\n      id,\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    const [value, setValue] = useState((props.value as string) || '');\r\n    const [isFocused, setIsFocused] = useState(false);\r\n\r\n    // Keep internal value synchronized with external value prop\r\n    useEffect(() => {\r\n      setValue((props.value as string) ?? '');\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [props.value]);\r\n\r\n    // Handle input change with sanitization\r\n    const handleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n      let newValue = e.target.value;\r\n\r\n      // Apply sanitization\r\n      if (sanitize) {\r\n        if (sanitizer) {\r\n          newValue = sanitizer(newValue);\r\n        } else {\r\n          newValue = sanitizeStrict(newValue);\r\n        }\r\n      }\r\n\r\n      // Apply max length\r\n      if (maxLength && newValue.length > maxLength) {\r\n        newValue = newValue.slice(0, maxLength);\r\n      }\r\n\r\n      setValue(newValue);\r\n      onChange?.(newValue);\r\n    };\r\n\r\n    // Determine border color based on state\r\n    const getBorderColor = () => {\r\n      if (isFocused) {\r\n        if (error && touched) return 'border-red-500 focus:ring-red-500';\r\n        if (success && touched) return 'border-green-500 focus:ring-green-500';\r\n        return 'border-[#ff950e] focus:ring-[#ff950e]';\r\n      }\r\n\r\n      if (error && touched) return 'border-red-500/50';\r\n      if (success && touched) return 'border-green-500/50';\r\n      return 'border-gray-700';\r\n    };\r\n\r\n    const resizeClass = {\r\n      none: 'resize-none',\r\n      vertical: 'resize-y',\r\n      horizontal: 'resize-x',\r\n      both: 'resize',\r\n    }[resize];\r\n\r\n    return (\r\n      <div className=\"w-full\">\r\n        {label && (\r\n          <label htmlFor={id} className=\"block text-sm font-medium text-gray-300 mb-1.5\">\r\n            {label}\r\n            {props.required && <span className=\"text-red-400 ml-1\">*</span>}\r\n          </label>\r\n        )}\r\n\r\n        <div className=\"relative\">\r\n          <textarea\r\n            ref={ref}\r\n            id={id}\r\n            value={value}\r\n            onChange={handleChange}\r\n            onFocus={() => setIsFocused(true)}\r\n            onBlur={() => {\r\n              setIsFocused(false);\r\n              onBlur?.();\r\n            }}\r\n            className={`\r\n              w-full px-3.5 py-2.5 bg-black/50 border rounded-lg \r\n              text-white placeholder-gray-500 focus:outline-none focus:ring-1 \r\n              transition-colors ${getBorderColor()} ${resizeClass} ${className}\r\n            `}\r\n            {...props}\r\n          />\r\n        </div>\r\n\r\n        {/* Error, success, or help text */}\r\n        {touched && error && (\r\n          <p className=\"mt-1 text-xs text-red-400 flex items-center gap-1\">\r\n            <AlertCircle className=\"w-3 h-3\" />\r\n            {error}\r\n          </p>\r\n        )}\r\n\r\n        {!error && helpText && (\r\n          <p className=\"mt-1 text-xs text-gray-500 flex items-center gap-1\">\r\n            <Info className=\"w-3 h-3\" />\r\n            {helpText}\r\n          </p>\r\n        )}\r\n\r\n        {/* Character count */}\r\n        {characterCount && maxLength && (\r\n          <p\r\n            className={`mt-1 text-xs text-right ${\r\n              value.length >= maxLength ? 'text-red-400' : 'text-gray-500'\r\n            }`}\r\n          >\r\n            {value.length}/{maxLength}\r\n          </p>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nSecureTextarea.displayName = 'SecureTextarea';\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3655, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/BanCheck.tsx"],"sourcesContent":["// src/components/BanCheck.tsx\r\n'use client';\r\n\r\nimport { useEffect, useState, useCallback, useRef } from 'react';\r\nimport { useBans } from '@/context/BanContext';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { SecureTextarea } from '@/components/ui/SecureInput';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\nimport { sanitizeStrict } from '@/utils/security/sanitization';\r\nimport {\r\n  Ban as BanIcon,\r\n  Clock,\r\n  AlertTriangle,\r\n  MessageSquare,\r\n  Infinity as InfinityIcon,\r\n  Shield,\r\n  Calendar,\r\n  FileText,\r\n  Upload,\r\n  X,\r\n  RefreshCw,\r\n  Image as ImageIcon,\r\n  Send,\r\n  Info,\r\n  ExternalLink,\r\n} from 'lucide-react';\r\n\r\ninterface BanCheckProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst BanCheck: React.FC<BanCheckProps> = ({ children }) => {\r\n  const { user, logout } = useAuth();\r\n  const { isUserBanned, submitAppeal, getBanInfo } = useBans();\r\n\r\n  const [banInfo, setBanInfo] = useState<any>(null);\r\n  const [showAppealForm, setShowAppealForm] = useState(false);\r\n  const [appealText, setAppealText] = useState('');\r\n  const [appealFiles, setAppealFiles] = useState<File[]>([]);\r\n  const [appealSubmitted, setAppealSubmitted] = useState(false);\r\n  const [isSubmittingAppeal, setIsSubmittingAppeal] = useState(false);\r\n  const [retryCount, setRetryCount] = useState(0);\r\n  const [lastCheckTime, setLastCheckTime] = useState<number>(0);\r\n  const [connectionError, setConnectionError] = useState(false);\r\n  const [appealError, setAppealError] = useState('');\r\n\r\n  const maxRetries = 3;\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const checkBanStatus = useCallback(async () => {\r\n    if (!user?.username) {\r\n      setBanInfo(null);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setConnectionError(false);\r\n      const ban = isUserBanned(user.username);\r\n      setBanInfo(ban);\r\n      setLastCheckTime(Date.now());\r\n      setRetryCount(0);\r\n\r\n      if (!ban && banInfo) {\r\n        setTimeout(() => {\r\n          window.location.reload();\r\n        }, 2000);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error checking ban status:', error);\r\n      setConnectionError(true);\r\n\r\n      if (retryCount < maxRetries) {\r\n        const backoffDelay = Math.pow(2, retryCount) * 1000;\r\n        setTimeout(() => {\r\n          setRetryCount((prev) => prev + 1);\r\n          void checkBanStatus();\r\n        }, backoffDelay);\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [user?.username, isUserBanned, retryCount, banInfo]);\r\n\r\n  useEffect(() => {\r\n    void checkBanStatus();\r\n\r\n    const interval = setInterval(() => {\r\n      void checkBanStatus();\r\n    }, 30000);\r\n\r\n    const handleBanExpired = (event: Event) => {\r\n      const custom = event as CustomEvent;\r\n      if ((custom.detail as any)?.username === user?.username) {\r\n        void checkBanStatus();\r\n      }\r\n    };\r\n\r\n    window.addEventListener('banExpired', handleBanExpired);\r\n    return () => {\r\n      clearInterval(interval);\r\n      window.removeEventListener('banExpired', handleBanExpired);\r\n    };\r\n  }, [checkBanStatus, user?.username]);\r\n\r\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const files = Array.from(event.target.files || []);\r\n    const validFiles = files.filter((file) => {\r\n      if (!file.type.startsWith('image/')) {\r\n        alert(`${file.name} is not an image file`);\r\n        return false;\r\n      }\r\n      if (file.size > 5 * 1024 * 1024) {\r\n        alert(`${file.name} is too large (max 5MB)`);\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n\r\n    const newFiles = [...appealFiles, ...validFiles].slice(0, 3);\r\n    setAppealFiles(newFiles);\r\n\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  const removeFile = (index: number) => {\r\n    setAppealFiles((prev) => prev.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const handleSubmitAppeal = async () => {\r\n    if (!user) {\r\n      setAppealError('User not found');\r\n      return;\r\n    }\r\n\r\n    const trimmedAppeal = appealText.trim();\r\n\r\n    if (!trimmedAppeal) {\r\n      setAppealError('Please enter an appeal message');\r\n      return;\r\n    }\r\n    if (trimmedAppeal.length < 10) {\r\n      setAppealError('Appeal message must be at least 10 characters long');\r\n      return;\r\n    }\r\n    if (trimmedAppeal.length > 1000) {\r\n      setAppealError('Appeal message must be less than 1000 characters');\r\n      return;\r\n    }\r\n\r\n    setIsSubmittingAppeal(true);\r\n    setAppealError('');\r\n\r\n    try {\r\n      const success = await submitAppeal(user.username, trimmedAppeal, appealFiles);\r\n\r\n      if (success) {\r\n        setAppealSubmitted(true);\r\n        setShowAppealForm(false);\r\n        setAppealText('');\r\n        setAppealFiles([]);\r\n\r\n        const updatedBan = getBanInfo(user.username);\r\n        setBanInfo(updatedBan);\r\n\r\n        setTimeout(() => {\r\n          alert('Appeal submitted successfully! You will be notified of the decision.');\r\n        }, 500);\r\n      } else {\r\n        setAppealError('Failed to submit appeal. Please try again.');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error submitting appeal:', error);\r\n      setAppealError('An error occurred while submitting your appeal. Please try again.');\r\n    } finally {\r\n      setIsSubmittingAppeal(false);\r\n    }\r\n  };\r\n\r\n  const formatRemainingTime = (ban: any) => {\r\n    if (ban.banType === 'permanent') {\r\n      return 'This is a permanent ban';\r\n    }\r\n\r\n    if (!ban.remainingHours || ban.remainingHours <= 0) {\r\n      return 'Ban has expired - refreshing page...';\r\n    }\r\n\r\n    const hours = ban.remainingHours;\r\n\r\n    if (hours < 1) {\r\n      const minutes = Math.ceil(hours * 60);\r\n      return `${minutes} minute${minutes !== 1 ? 's' : ''} remaining`;\r\n    } else if (hours < 24) {\r\n      const wholeHours = Math.floor(hours);\r\n      const minutes = Math.ceil((hours - wholeHours) * 60);\r\n      return `${wholeHours} hour${wholeHours !== 1 ? 's' : ''}${\r\n        minutes > 0 ? ` and ${minutes} minute${minutes !== 1 ? 's' : ''}` : ''\r\n      } remaining`;\r\n    } else {\r\n      const days = Math.floor(hours / 24);\r\n      const remainingHours = Math.floor(hours % 24);\r\n      return `${days} day${days !== 1 ? 's' : ''}${\r\n        remainingHours > 0 ? ` and ${remainingHours} hour${remainingHours !== 1 ? 's' : ''}` : ''\r\n      } remaining`;\r\n    }\r\n  };\r\n\r\n  const getBanReasonDisplay = (reason: string, customReason?: string) => {\r\n    const reasonMap: Record<string, { title: string; description: string }> = {\r\n      harassment: { title: 'Harassment', description: 'Engaging in abusive or threatening behavior toward other users' },\r\n      spam: { title: 'Spam', description: 'Posting repetitive, unwanted, or promotional content' },\r\n      inappropriate_content: { title: 'Inappropriate Content', description: 'Sharing content that violates platform guidelines' },\r\n      scam: { title: 'Scam/Fraud', description: 'Attempting to defraud or scam other users' },\r\n      underage: { title: 'Underage Violation', description: 'Platform restricted to users 21 and older' },\r\n      payment_fraud: { title: 'Payment Fraud', description: 'Fraudulent payment activity or chargebacks' },\r\n      other: { title: 'Other', description: 'Other violations of platform terms of service' },\r\n    };\r\n\r\n    const reasonInfo = reasonMap[reason] || { title: reason, description: '' };\r\n    const displayReason = customReason ? `${reasonInfo.title}: ${sanitizeStrict(customReason)}` : reasonInfo.title;\r\n\r\n    return { display: displayReason, description: reasonInfo.description };\r\n  };\r\n\r\n  const getEscalationDisplay = (level?: number) => {\r\n    if (!level) return null;\r\n\r\n    const escalationMap: Record<number, { title: string; color: string; description: string }> = {\r\n      1: { title: 'Level 1', color: 'text-yellow-400', description: 'First offense' },\r\n      2: { title: 'Level 2', color: 'text-orange-400', description: 'Multiple violations' },\r\n      3: { title: 'Level 3', color: 'text-red-400', description: 'Serious violations' },\r\n      4: { title: 'Level 4', color: 'text-purple-400', description: 'Severe violations' },\r\n      5: { title: 'Level 5', color: 'text-red-600', description: 'Final warning level' },\r\n    };\r\n\r\n    return escalationMap[level] || null;\r\n  };\r\n\r\n  if (!children) {\r\n    console.warn('BanCheck: children prop is undefined');\r\n    return null;\r\n  }\r\n\r\n  if (!banInfo) {\r\n    return <>{children}</>;\r\n  }\r\n\r\n  const reasonInfo = getBanReasonDisplay(banInfo.reason, banInfo.customReason);\r\n  const escalationInfo = getEscalationDisplay(banInfo.escalationLevel);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-black flex items-center justify-center p-4\">\r\n      <div className=\"max-w-4xl w-full bg-[#1a1a1a] border-2 border-red-800 rounded-xl p-8 shadow-2xl\">\r\n        {/* Connection Error Banner */}\r\n        {connectionError && (\r\n          <div className=\"mb-6 p-4 bg-yellow-900/20 border border-yellow-800 rounded-lg flex items-center gap-3\">\r\n            <AlertTriangle size={20} className=\"text-yellow-400\" />\r\n            <div>\r\n              <p className=\"text-yellow-400 font-medium\">Connection Issue</p>\r\n              <p className=\"text-gray-300 text-sm\">Unable to verify ban status. Retrying automatically...</p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Ban Header */}\r\n        <div className=\"text-center mb-8\">\r\n          <div className=\"w-20 h-20 bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n            {banInfo.banType === 'permanent' ? (\r\n              <InfinityIcon size={40} className=\"text-red-400\" />\r\n            ) : (\r\n              <BanIcon size={40} className=\"text-red-400\" />\r\n            )}\r\n          </div>\r\n          <h1 className=\"text-3xl font-bold text-red-400 mb-2\">\r\n            Account {banInfo.banType === 'permanent' ? 'Permanently' : 'Temporarily'} Suspended\r\n          </h1>\r\n          <p className=\"text-gray-400\">Your access to PantyPost has been restricted</p>\r\n          {escalationInfo && (\r\n            <div className=\"mt-3 inline-flex items-center gap-2 px-3 py-1 bg-gray-900/50 rounded-full\">\r\n              <Shield size={16} className={escalationInfo.color} />\r\n              <span className={`text-sm font-medium ${escalationInfo.color}`}>\r\n                {escalationInfo.title} - {escalationInfo.description}\r\n              </span>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Ban Details */}\r\n        <div className=\"bg-[#222] rounded-lg p-6 mb-6\">\r\n          <h3 className=\"text-lg font-semibold text-white mb-4 flex items-center gap-2\">\r\n            <Info size={20} />\r\n            Suspension Details\r\n          </h3>\r\n\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n            <div>\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <div className=\"flex items-center gap-2 text-gray-400 mb-1\">\r\n                    <AlertTriangle size={16} />\r\n                    <span className=\"font-medium\">Violation</span>\r\n                  </div>\r\n                  <div className=\"text-white\">\r\n                    <p className=\"font-medium\">{reasonInfo.display}</p>\r\n                    {reasonInfo.description && <p className=\"text-sm text-gray-400 mt-1\">{reasonInfo.description}</p>}\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <div className=\"flex items-center gap-2 text-gray-400 mb-1\">\r\n                    <Clock size={16} />\r\n                    <span className=\"font-medium\">Duration</span>\r\n                  </div>\r\n                  <div className=\"text-white\">\r\n                    <p className=\"font-medium\">{formatRemainingTime(banInfo)}</p>\r\n                    {banInfo.banType === 'temporary' && (\r\n                      <div className=\"mt-2 bg-red-900/20 rounded-full h-2\">\r\n                        <div\r\n                          className=\"bg-red-500 h-2 rounded-full transition-all duration-1000\"\r\n                          style={{\r\n                            width: `${Math.max(\r\n                              0,\r\n                              Math.min(100, ((banInfo.remainingHours || 0) / ((parseInt(banInfo.notes) || 24))) * 100)\r\n                            )}%`,\r\n                          }}\r\n                        />\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <div className=\"flex items-center gap-2 text-gray-400 mb-1\">\r\n                    <Calendar size={16} />\r\n                    <span className=\"font-medium\">Suspended On</span>\r\n                  </div>\r\n                  <p className=\"text-white\">{new Date(banInfo.startTime).toLocaleString()}</p>\r\n                </div>\r\n\r\n                {banInfo.endTime && (\r\n                  <div>\r\n                    <div className=\"flex items-center gap-2 text-gray-400 mb-1\">\r\n                      <Calendar size={16} />\r\n                      <span className=\"font-medium\">Suspension Ends</span>\r\n                    </div>\r\n                    <p className=\"text-white\">{new Date(banInfo.endTime).toLocaleString()}</p>\r\n                  </div>\r\n                )}\r\n\r\n                <div>\r\n                  <div className=\"flex items-center gap-2 text-gray-400 mb-1\">\r\n                    <Shield size={16} />\r\n                    <span className=\"font-medium\">Moderator</span>\r\n                  </div>\r\n                  <p className=\"text-white\">\r\n                    <SecureMessageDisplay content={banInfo.bannedBy} allowBasicFormatting={false} as=\"span\" />\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {banInfo.notes && (\r\n            <div className=\"mt-6 pt-4 border-t border-gray-700\">\r\n              <div className=\"flex items-center gap-2 text-gray-400 mb-2\">\r\n                <FileText size={16} />\r\n                <span className=\"font-medium\">Additional Information</span>\r\n              </div>\r\n              <div className=\"bg-[#1a1a1a] rounded-lg p-3\">\r\n                <SecureMessageDisplay content={banInfo.notes} allowBasicFormatting={false} className=\"text-gray-300 text-sm\" />\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Appeal Section */}\r\n        {banInfo.appealable && !banInfo.appealSubmitted && !appealSubmitted && (\r\n          <div className=\"bg-blue-900/10 border border-blue-800 rounded-lg p-6 mb-6\">\r\n            <h3 className=\"text-lg font-semibold text-blue-400 mb-3 flex items-center justify-center gap-2\">\r\n              <MessageSquare size={20} />\r\n              Submit an Appeal\r\n            </h3>\r\n            <div className=\"text-center mb-4\">\r\n              <p className=\"text-gray-300 text-sm mb-2\">\r\n                If you believe this suspension was issued in error, you can submit an appeal for review.\r\n              </p>\r\n              <p className=\"text-gray-400 text-xs\">Appeals are reviewed by our moderation team within 24-48 hours.</p>\r\n            </div>\r\n\r\n            {!showAppealForm ? (\r\n              <div className=\"text-center\">\r\n                <button\r\n                  onClick={() => {\r\n                    setShowAppealForm(true);\r\n                    setAppealError('');\r\n                  }}\r\n                  className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium\"\r\n                >\r\n                  Start Appeal Process\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-blue-400 mb-2\">Explain why this suspension should be lifted *</label>\r\n                  <SecureTextarea\r\n                    value={appealText}\r\n                    onChange={setAppealText}\r\n                    onBlur={() => setAppealError('')}\r\n                    placeholder=\"Please provide a detailed explanation of why you believe this suspension was issued in error, or describe any circumstances that should be considered...\"\r\n                    rows={5}\r\n                    maxLength={1000}\r\n                    characterCount={true}\r\n                    error={appealError}\r\n                    touched={!!appealError}\r\n                    className=\"w-full\"\r\n                  />\r\n                </div>\r\n\r\n                {/* Evidence Upload */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-blue-400 mb-2\">Supporting Evidence (Optional)</label>\r\n                  <div className=\"border-2 border-dashed border-gray-700 rounded-lg p-4\">\r\n                    <div className=\"text-center\">\r\n                      <Upload size={32} className=\"mx-auto text-gray-500 mb-2\" />\r\n                      <p className=\"text-sm text-gray-400 mb-2\">Upload screenshots or images that support your appeal</p>\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => fileInputRef.current?.click()}\r\n                        className=\"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors text-sm\"\r\n                      >\r\n                        Choose Files\r\n                      </button>\r\n                      <p className=\"text-xs text-gray-500 mt-2\">Max 3 files, 5MB each. Images only.</p>\r\n                      <input ref={fileInputRef} type=\"file\" multiple accept=\"image/*\" onChange={handleFileSelect} className=\"hidden\" />\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Selected Files */}\r\n                  {appealFiles.length > 0 && (\r\n                    <div className=\"mt-3 space-y-2\">\r\n                      <p className=\"text-sm font-medium text-gray-300\">Selected Evidence:</p>\r\n                      {appealFiles.map((file, index) => (\r\n                        <div key={index} className=\"flex items-center justify-between bg-[#222] p-2 rounded\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <ImageIcon size={16} className=\"text-blue-400\" />\r\n                            <span className=\"text-sm text-gray-300\">{file.name}</span>\r\n                            <span className=\"text-xs text-gray-500\">({(file.size / 1024 / 1024).toFixed(1)}MB)</span>\r\n                          </div>\r\n                          <button onClick={() => removeFile(index)} className=\"text-red-400 hover:text-red-3 00 transition-colors\">\r\n                            <X size={16} />\r\n                          </button>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"flex gap-3 pt-4\">\r\n                  <button\r\n                    onClick={() => {\r\n                      setShowAppealForm(false);\r\n                      setAppealText('');\r\n                      setAppealFiles([]);\r\n                      setAppealError('');\r\n                    }}\r\n                    className=\"flex-1 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors\"\r\n                    disabled={isSubmittingAppeal}\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    onClick={handleSubmitAppeal}\r\n                    disabled={!appealText.trim() || appealText.length < 10 || isSubmittingAppeal}\r\n                    className=\"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2\"\r\n                  >\r\n                    {isSubmittingAppeal ? (\r\n                      <>\r\n                        <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\"></div>\r\n                        Submitting...\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <Send size={16} />\r\n                        Submit Appeal\r\n                      </>\r\n                    )}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Appeal Status */}\r\n        {(banInfo.appealSubmitted || appealSubmitted) && (\r\n          <div className=\"bg-orange-900/10 border border-orange-800 rounded-lg p-6 mb-6\">\r\n            <h3 className=\"text-lg font-semibold text-orange-400 mb-3 flex items-center gap-2\">\r\n              <MessageSquare size={20} />\r\n              Appeal Status: {banInfo.appealStatus || 'Pending'}\r\n            </h3>\r\n\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-3 h-3 bg-orange-400 rounded-full\"></div>\r\n                <span className=\"text-gray-300 text-sm\">Your appeal has been submitted and is being reviewed by our moderation team.</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-3 h-3 bg-gray-600 rounded-full\"></div>\r\n                <span className=\"text-gray-400 text-sm\">You will be notified of the decision via email and platform notification.</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-3 h-3 bg-gray-600 rounded-full\"></div>\r\n                <span className=\"text-gray-400 text-sm\">Appeals are typically reviewed within 24-48 hours.</span>\r\n              </div>\r\n            </div>\r\n\r\n            {banInfo.appealText && (\r\n              <div className=\"mt-4 p-3 bg-[#222] rounded border-l-4 border-orange-400\">\r\n                <div className=\"text-sm text-orange-400 mb-1\">Your appeal message:</div>\r\n                <SecureMessageDisplay content={banInfo.appealText} allowBasicFormatting={false} className=\"text-sm text-gray-300\" />\r\n                {banInfo.appealDate && <div className=\"text-xs text-gray-500 mt-2\">Submitted: {new Date(banInfo.appealDate).toLocaleString()}</div>}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex flex-col sm:flex-row gap-3 justify-center mb-6\">\r\n          <button\r\n            onClick={() => {\r\n              logout();\r\n              window.location.href = '/';\r\n            }}\r\n            className=\"px-6 py-3 bg-[#333] text-white rounded-lg hover:bg-[#444] transition-colors font-medium\"\r\n          >\r\n            Sign Out\r\n          </button>\r\n\r\n          <button\r\n            onClick={() => {\r\n              setRetryCount(0);\r\n              void checkBanStatus();\r\n            }}\r\n            className=\"px-6 py-3 bg-[#ff950e] text-black rounded-lg hover:bg-[#e88800] transition-colors font-medium flex items-center gap-2\"\r\n            disabled={connectionError && retryCount >= maxRetries}\r\n          >\r\n            <RefreshCw size={16} className={connectionError ? 'animate-spin' : ''} />\r\n            {connectionError ? 'Retrying...' : 'Refresh Status'}\r\n          </button>\r\n        </div>\r\n\r\n        {/* Contact Info */}\r\n        <div className=\"text-center pt-6 border-top border-gray-700\">\r\n          <div className=\"text-sm text-gray-400 mb-2\">\r\n            <p className=\"mb-2\">For urgent matters or technical issues, you can contact our support team.</p>\r\n            <div>\r\n              Please reference your username:{' '}\r\n              <strong className=\"text-white\">\r\n                <SecureMessageDisplay content={user?.username || ''} allowBasicFormatting={false} as=\"span\" />\r\n              </strong>\r\n            </div>\r\n          </div>\r\n\r\n          {lastCheckTime > 0 && <div className=\"text-xs text-gray-500 mt-3\">Last status check: {new Date(lastCheckTime).toLocaleTimeString()}</div>}\r\n        </div>\r\n\r\n        {/* Platform Guidelines Link */}\r\n        <div className=\"mt-6 text-center\">\r\n          <button\r\n            onClick={() => window.open('/terms', '_blank')}\r\n            className=\"text-blue-400 hover:text-blue-300 text-sm underline flex items-center gap-1 mx-auto transition-colors\"\r\n          >\r\n            <ExternalLink size={14} />\r\n            Review Platform Guidelines\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BanCheck;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5074, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/MessageNotifications.tsx"],"sourcesContent":["// src/components/MessageNotifications.tsx\r\n'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useMessages } from '@/context/MessageContext';\r\nimport { useRouter } from 'next/navigation';\r\nimport { MessageCircle, X } from 'lucide-react';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\nimport { sanitizeStrict } from '@/utils/security/sanitization';\r\n\r\nexport default function MessageNotifications() {\r\n  const { user } = useAuth();\r\n  const { messageNotifications } = useMessages();\r\n  const router = useRouter();\r\n  const [visible, setVisible] = useState<string[]>([]);\r\n  const [mounted, setMounted] = useState(false);\r\n\r\n  // Set mounted state\r\n  useEffect(() => {\r\n    setMounted(true);\r\n  }, []);\r\n\r\n  // Update visible notifications when they change\r\n  useEffect(() => {\r\n    if (!user || user.role !== 'seller' || !mounted) return;\r\n\r\n    const notifications = messageNotifications[user.username] || [];\r\n    setVisible(notifications.map((n) => n.buyer));\r\n  }, [user, messageNotifications, mounted]);\r\n\r\n  // Listen for storage changes for real-time updates\r\n  useEffect(() => {\r\n    if (!mounted) return;\r\n\r\n    const handleStorageChange = (e: StorageEvent) => {\r\n      if (e.key === 'panty_message_notifications' && user?.role === 'seller') {\r\n        const notifications = messageNotifications[user.username] || [];\r\n        setVisible(notifications.map((n) => n.buyer));\r\n      }\r\n    };\r\n\r\n    window.addEventListener('storage', handleStorageChange);\r\n    return () => window.removeEventListener('storage', handleStorageChange);\r\n  }, [user, messageNotifications, mounted]);\r\n\r\n  if (!mounted || !user || user.role !== 'seller') return null;\r\n\r\n  const notifications = messageNotifications[user.username] || [];\r\n  const visibleNotifications = notifications.filter((n) => visible.includes(n.buyer));\r\n\r\n  if (visibleNotifications.length === 0) return null;\r\n\r\n  return (\r\n    <div className=\"fixed bottom-4 right-4 z-50 space-y-2 max-w-sm\">\r\n      {visibleNotifications.map((notif) => {\r\n        const buyerSafe = sanitizeStrict(notif.buyer);\r\n        const threadParam = encodeURIComponent(notif.buyer);\r\n\r\n        return (\r\n          <div\r\n            key={buyerSafe}\r\n            className=\"bg-purple-600 text-white rounded-lg shadow-lg p-4 cursor-pointer hover:bg-purple-700 transition-all transform hover:scale-105 animate-slide-in\"\r\n            onClick={() => {\r\n              // Navigate to the conversation (encode user-supplied value)\r\n              router.push(`/sellers/messages?thread=${threadParam}`);\r\n              // Remove from visible\r\n              setVisible((prev) => prev.filter((b) => b !== notif.buyer));\r\n            }}\r\n          >\r\n            <div className=\"flex items-start justify-between\">\r\n              <div className=\"flex items-start flex-1\">\r\n                <MessageCircle className=\"w-5 h-5 mr-3 mt-0.5 flex-shrink-0\" />\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <div className=\"font-semibold\">\r\n                    {notif.messageCount > 1 ? (\r\n                      <>\r\n                        {notif.messageCount} new messages from{' '}\r\n                        <SecureMessageDisplay content={buyerSafe} allowBasicFormatting={false} as=\"span\" />\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        New message from{' '}\r\n                        <SecureMessageDisplay content={buyerSafe} allowBasicFormatting={false} as=\"span\" />\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                  <SecureMessageDisplay\r\n                    content={notif.lastMessage}\r\n                    className=\"text-sm opacity-90 truncate mt-1\"\r\n                    allowBasicFormatting={false}\r\n                    maxLength={100}\r\n                    as=\"div\"\r\n                  />\r\n                  <div className=\"text-xs opacity-75 mt-1\">\r\n                    {new Date(notif.timestamp).toLocaleTimeString()}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <button\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  setVisible((prev) => prev.filter((b) => b !== notif.buyer));\r\n                }}\r\n                className=\"ml-3 p-1 hover:bg-purple-800 rounded transition-colors\"\r\n                aria-label=\"Dismiss notification\"\r\n              >\r\n                <X className=\"w-4 h-4\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5305, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/PWAInstall.tsx"],"sourcesContent":["// src/components/PWAInstall.tsx\r\n'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { X, Download } from 'lucide-react';\r\n\r\n// Minimal typing for the deferred install prompt event\r\ntype BeforeInstallPromptEvent = Event & {\r\n  prompt: () => void;\r\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>;\r\n};\r\n\r\nexport function PWAInstall() {\r\n  const [deferredPrompt, setDeferredPrompt] = useState<BeforeInstallPromptEvent | null>(null);\r\n  const [showPrompt, setShowPrompt] = useState(false);\r\n  const [isIOS, setIsIOS] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    // Check if iOS\r\n    const userAgent = window.navigator.userAgent.toLowerCase();\r\n    const ios = /iphone|ipad|ipod/.test(userAgent);\r\n    setIsIOS(ios);\r\n\r\n    // Check if already dismissed (7-day cooldown)\r\n    try {\r\n      const dismissed = localStorage.getItem('pwa-prompt-dismissed');\r\n      if (dismissed && Date.now() - parseInt(dismissed, 10) < 7 * 24 * 60 * 60 * 1000) {\r\n        return;\r\n      }\r\n    } catch {\r\n      // Ignore storage errors\r\n    }\r\n\r\n    // Listen for install prompt\r\n    const handleBeforeInstallPrompt = (e: Event) => {\r\n      e.preventDefault();\r\n      setDeferredPrompt(e as BeforeInstallPromptEvent);\r\n\r\n      // Show prompt after a short delay\r\n      const t = setTimeout(() => setShowPrompt(true), 3000);\r\n      return () => clearTimeout(t);\r\n    };\r\n\r\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\r\n\r\n    return () => {\r\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\r\n    };\r\n  }, []);\r\n\r\n  const handleInstall = async () => {\r\n    try {\r\n      if (!deferredPrompt) return;\r\n      deferredPrompt.prompt();\r\n      const { outcome } = await deferredPrompt.userChoice;\r\n\r\n      if (process.env.NODE_ENV === 'development') {\r\n        console.log('PWA install prompt outcome:', outcome);\r\n      }\r\n\r\n      setDeferredPrompt(null);\r\n      setShowPrompt(false);\r\n    } catch {\r\n      setDeferredPrompt(null);\r\n      setShowPrompt(false);\r\n    }\r\n  };\r\n\r\n  const handleDismiss = () => {\r\n    setShowPrompt(false);\r\n    try {\r\n      localStorage.setItem('pwa-prompt-dismissed', Date.now().toString());\r\n    } catch {\r\n      // Ignore storage errors\r\n    }\r\n  };\r\n\r\n  if (!showPrompt || (!deferredPrompt && !isIOS)) return null;\r\n\r\n  return (\r\n    <div\r\n      className=\"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 bg-gray-900 border border-gray-800 rounded-lg shadow-xl p-4 z-50\"\r\n      role=\"dialog\"\r\n      aria-modal=\"true\"\r\n      aria-label=\"Install PantyPost App\"\r\n    >\r\n      <button\r\n        onClick={handleDismiss}\r\n        className=\"absolute top-2 right-2 text-gray-500 hover:text-gray-300\"\r\n        aria-label=\"Dismiss install prompt\"\r\n      >\r\n        <X className=\"h-5 w-5\" />\r\n      </button>\r\n\r\n      <div className=\"flex items-start space-x-3\">\r\n        <div className=\"flex-shrink-0\">\r\n          <Download className=\"h-8 w-8 text-[#ff950e]\" />\r\n        </div>\r\n        <div className=\"flex-1\">\r\n          <h3 className=\"text-white font-semibold mb-1\">Install PantyPost App</h3>\r\n          <p className=\"text-gray-400 text-sm mb-3\">\r\n            Install our app for a better experience with offline access and notifications.\r\n          </p>\r\n\r\n          {isIOS ? (\r\n            <p className=\"text-gray-500 text-xs\">Tap the share button and select &quot;Add to Home Screen&quot;</p>\r\n          ) : (\r\n            <button\r\n              onClick={handleInstall}\r\n              className=\"bg-[#ff950e] text-black px-4 py-2 rounded-lg text-sm font-medium hover:bg-[#ff8c00] transition-colors\"\r\n            >\r\n              Install Now\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,gCAAgC;;;;AA0DtB;;AAvDV;AACA;AAAA;;;AAHA;;;AAWO,SAAS;;IACd,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAmC;IACtF,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEnC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;gCAAE;YACR;;YAEA,eAAe;YACf,MAAM,YAAY,OAAO,SAAS,CAAC,SAAS,CAAC,WAAW;YACxD,MAAM,MAAM,mBAAmB,IAAI,CAAC;YACpC,SAAS;YAET,8CAA8C;YAC9C,IAAI;gBACF,MAAM,YAAY,aAAa,OAAO,CAAC;gBACvC,IAAI,aAAa,KAAK,GAAG,KAAK,SAAS,WAAW,MAAM,IAAI,KAAK,KAAK,KAAK,MAAM;oBAC/E;gBACF;YACF,EAAE,UAAM;YACN,wBAAwB;YAC1B;YAEA,4BAA4B;YAC5B,MAAM;kEAA4B,CAAC;oBACjC,EAAE,cAAc;oBAChB,kBAAkB;oBAElB,kCAAkC;oBAClC,MAAM,IAAI;4EAAW,IAAM,cAAc;2EAAO;oBAChD;0EAAO,IAAM,aAAa;;gBAC5B;;YAEA,OAAO,gBAAgB,CAAC,uBAAuB;YAE/C;wCAAO;oBACL,OAAO,mBAAmB,CAAC,uBAAuB;gBACpD;;QACF;+BAAG,EAAE;IAEL,MAAM,gBAAgB;QACpB,IAAI;YACF,IAAI,CAAC,gBAAgB;YACrB,eAAe,MAAM;YACrB,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,eAAe,UAAU;YAEnD,wCAA4C;gBAC1C,QAAQ,GAAG,CAAC,+BAA+B;YAC7C;YAEA,kBAAkB;YAClB,cAAc;QAChB,EAAE,UAAM;YACN,kBAAkB;YAClB,cAAc;QAChB;IACF;IAEA,MAAM,gBAAgB;QACpB,cAAc;QACd,IAAI;YACF,aAAa,OAAO,CAAC,wBAAwB,KAAK,GAAG,GAAG,QAAQ;QAClE,EAAE,UAAM;QACN,wBAAwB;QAC1B;IACF;IAEA,IAAI,CAAC,cAAe,CAAC,kBAAkB,CAAC,OAAQ,OAAO;IAEvD,qBACE,6LAAC;QACC,WAAU;QACV,MAAK;QACL,cAAW;QACX,cAAW;;0BAEX,6LAAC;gBACC,SAAS;gBACT,WAAU;gBACV,cAAW;0BAEX,cAAA,6LAAC,+LAAA,CAAA,IAAC;oBAAC,WAAU;;;;;;;;;;;0BAGf,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,6MAAA,CAAA,WAAQ;4BAAC,WAAU;;;;;;;;;;;kCAEtB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAG,WAAU;0CAAgC;;;;;;0CAC9C,6LAAC;gCAAE,WAAU;0CAA6B;;;;;;4BAIzC,sBACC,6LAAC;gCAAE,WAAU;0CAAwB;;;;;qDAErC,6LAAC;gCACC,SAAS;gCACT,WAAU;0CACX;;;;;;;;;;;;;;;;;;;;;;;;AAQb;GA5GgB;KAAA","debugId":null}},
    {"offset": {"line": 5493, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/GoogleAnalytics.tsx"],"sourcesContent":["// src/components/GoogleAnalytics.tsx\r\nimport Script from 'next/script';\r\nimport React from 'react';\r\n\r\nexport function GoogleAnalytics(): React.ReactElement | null {\r\n  const GA_MEASUREMENT_ID = process.env.NEXT_PUBLIC_GA_MEASUREMENT_ID;\r\n\r\n  if (!GA_MEASUREMENT_ID || process.env.NODE_ENV !== 'production') return null;\r\n\r\n  return (\r\n    <>\r\n      <Script src={`https://www.googletagmanager.com/gtag/js?id=${GA_MEASUREMENT_ID}`} strategy=\"afterInteractive\" />\r\n      <Script id=\"google-analytics\" strategy=\"afterInteractive\">\r\n        {`\r\n          window.dataLayer = window.dataLayer || [];\r\n          function gtag(){dataLayer.push(arguments);}\r\n          gtag('js', new Date());\r\n          gtag('config', '${GA_MEASUREMENT_ID}', {\r\n            page_path: window.location.pathname,\r\n          });\r\n        `}\r\n      </Script>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,qCAAqC;;;;AAKT;;AAJ5B;;;AAGO,SAAS;IACd,MAAM,oBAAoB,gKAAA,CAAA,UAAO,CAAC,GAAG,CAAC,6BAA6B;IAEnE,wCAAiE,OAAO;;;AAiB1E;KApBgB","debugId":null}}]
}