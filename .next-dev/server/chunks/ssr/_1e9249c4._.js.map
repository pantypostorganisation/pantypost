{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/src/components/admin/bans/AnalyticsContent.tsx"],"sourcesContent":["// src/components/admin/bans/AnalyticsContent.tsx\r\n'use client';\r\n\r\nimport React, { useMemo } from 'react';\r\nimport { BarChart3, MessageSquare } from 'lucide-react';\r\nimport { BanStats } from '@/types/ban';\r\nimport { sanitizeStrict, sanitizeNumber } from '@/utils/security/sanitization';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\ninterface AnalyticsContentProps {\r\n  banStats: BanStats;\r\n}\r\n\r\n// Valid ban reasons for validation / bucketing\r\nconst VALID_BAN_REASONS = [\r\n  'harassment',\r\n  'inappropriate_content',\r\n  'spam',\r\n  'fake_profile',\r\n  'scamming',\r\n  'underage',\r\n  'ban_evasion',\r\n  'other',\r\n] as const;\r\n\r\nconst VALID_SET = new Set<string>(VALID_BAN_REASONS as unknown as string[]);\r\n\r\n// Format reason for display with sanitization\r\nconst formatReasonForDisplay = (reason: string): string => {\r\n  const sanitizedReason = sanitizeStrict(reason);\r\n  return sanitizedReason\r\n    .replace(/_/g, ' ')\r\n    .replace(/\\b\\w/g, (char) => char.toUpperCase());\r\n};\r\n\r\n// Safely calculate percentage\r\nconst calculatePercentage = (count: number, total: number): number => {\r\n  if (total <= 0 || !Number.isFinite(total)) return 0;\r\n  if (count < 0 || !Number.isFinite(count)) return 0;\r\n\r\n  const percentage = (count / total) * 100;\r\n  return Math.min(100, Math.max(0, percentage)); // Clamp 0â€“100\r\n};\r\n\r\nexport default function AnalyticsContent({ banStats }: AnalyticsContentProps) {\r\n  // Sanitize & bucket ban reasons (unknown -> 'other'), memoized\r\n  const sanitizedBansByReason = useMemo(() => {\r\n    const raw = Object.entries(banStats?.bansByReason || {});\r\n    const acc: Record<string, number> = {};\r\n\r\n    for (const [reason, count] of raw) {\r\n      const normalized = sanitizeStrict(String(reason)).toLowerCase();\r\n      const bucket = VALID_SET.has(normalized) ? normalized : 'other';\r\n      const safeCount = sanitizeNumber(Number(count) || 0, 0, 999_999, 0);\r\n      acc[bucket] = (acc[bucket] || 0) + safeCount;\r\n    }\r\n\r\n    // Optionally drop zero-count buckets\r\n    Object.keys(acc).forEach((k) => {\r\n      if (!acc[k]) delete acc[k];\r\n    });\r\n\r\n    return acc;\r\n  }, [banStats]);\r\n\r\n  // Total bans (memoized)\r\n  const total = useMemo(\r\n    () =>\r\n      Object.values(sanitizedBansByReason).reduce((sum, val) => {\r\n        const num = Number(val);\r\n        return sum + (Number.isFinite(num) ? num : 0);\r\n      }, 0),\r\n    [sanitizedBansByReason]\r\n  );\r\n\r\n  // Sanitize appeal stats with consistency check (memoized)\r\n  const sanitizedAppealStats = useMemo(() => {\r\n    const stats = {\r\n      totalAppeals: sanitizeNumber(banStats?.appealStats?.totalAppeals || 0, 0, 999_999, 0),\r\n      pendingAppeals: sanitizeNumber(banStats?.appealStats?.pendingAppeals || 0, 0, 999_999, 0),\r\n      approvedAppeals: sanitizeNumber(banStats?.appealStats?.approvedAppeals || 0, 0, 999_999, 0),\r\n      rejectedAppeals: sanitizeNumber(banStats?.appealStats?.rejectedAppeals || 0, 0, 999_999, 0),\r\n    };\r\n\r\n    const sum = stats.pendingAppeals + stats.approvedAppeals + stats.rejectedAppeals;\r\n    if (sum > stats.totalAppeals) {\r\n      stats.totalAppeals = sum; // keep totals consistent if inputs drift\r\n    }\r\n    return stats;\r\n  }, [banStats]);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <h2 className=\"text-xl font-semibold text-white mb-4\">Ban Analytics</h2>\r\n\r\n      {/* Ban Reasons Chart */}\r\n      <div className=\"bg-[#1a1a1a] border border-gray-800 rounded-lg p-6\">\r\n        <h3 className=\"text-lg font-semibold text-white mb-4 flex items-center gap-2\">\r\n          <BarChart3 size={20} className=\"text-blue-400\" />\r\n          Ban Reasons Distribution\r\n        </h3>\r\n        <div className=\"space-y-3\">\r\n          {Object.keys(sanitizedBansByReason).length === 0 ? (\r\n            <p className=\"text-gray-400 text-center py-4\">No ban data available</p>\r\n          ) : (\r\n            Object.entries(sanitizedBansByReason)\r\n              .sort(([, a], [, b]) => b - a) // Sort by count desc\r\n              .map(([reason, count]) => {\r\n                const percentage = calculatePercentage(count, total);\r\n                return (\r\n                  <div key={reason}>\r\n                    <div className=\"flex justify-between items-center mb-1\">\r\n                      <span className=\"text-sm text-gray-300\">\r\n                        <SecureMessageDisplay\r\n                          content={formatReasonForDisplay(reason)}\r\n                          allowBasicFormatting={false}\r\n                        />\r\n                      </span>\r\n                      <span className=\"text-sm text-gray-400\">\r\n                        {count.toLocaleString()} ({percentage.toFixed(1)}%)\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"w-full bg-gray-700 rounded-full h-2 overflow-hidden\">\r\n                      <div\r\n                        className=\"bg-[#ff950e] h-2 rounded-full transition-all duration-500\"\r\n                        style={{ width: `${percentage}%` }}\r\n                        role=\"progressbar\"\r\n                        aria-valuenow={Number.isFinite(percentage) ? Math.round(percentage) : 0}\r\n                        aria-valuemin={0}\r\n                        aria-valuemax={100}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Appeal Statistics */}\r\n      <div className=\"bg-[#1a1a1a] border border-gray-800 rounded-lg p-6\">\r\n        <h3 className=\"text-lg font-semibold text-white mb-4 flex items-center gap-2\">\r\n          <MessageSquare size={20} className=\"text-orange-400\" />\r\n          Appeal Processing\r\n        </h3>\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold text-blue-400\">\r\n              {sanitizedAppealStats.totalAppeals.toLocaleString()}\r\n            </div>\r\n            <div className=\"text-xs text-gray-400\">Total Appeals</div>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold text-yellow-400\">\r\n              {sanitizedAppealStats.pendingAppeals.toLocaleString()}\r\n            </div>\r\n            <div className=\"text-xs text-gray-400\">Pending</div>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold text-green-400\">\r\n              {sanitizedAppealStats.approvedAppeals.toLocaleString()}\r\n            </div>\r\n            <div className=\"text-xs text-gray-400\">Approved</div>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold text-red-400\">\r\n              {sanitizedAppealStats.rejectedAppeals.toLocaleString()}\r\n            </div>\r\n            <div className=\"text-xs text-gray-400\">Rejected</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 356, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/chart-column.js","sources":["file:///C:/Users/gerom/OneDrive/Documents/pantypost/node_modules/lucide-react/src/icons/chart-column.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M3 3v16a2 2 0 0 0 2 2h16', key: 'c24i48' }],\n  ['path', { d: 'M18 17V9', key: '2bz60n' }],\n  ['path', { d: 'M13 17V5', key: '1frdt8' }],\n  ['path', { d: 'M8 17v-3', key: '17ska0' }],\n];\n\n/**\n * @component @name ChartColumn\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyAzdjE2YTIgMiAwIDAgMCAyIDJoMTYiIC8+CiAgPHBhdGggZD0iTTE4IDE3VjkiIC8+CiAgPHBhdGggZD0iTTEzIDE3VjUiIC8+CiAgPHBhdGggZD0iTTggMTd2LTMiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/chart-column\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ChartColumn = createLucideIcon('chart-column', __iconNode);\n\nexport default ChartColumn;\n"],"names":[],"mappings":";;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAuB,CAAA,CAAA,CAAA,CAAA;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA;QAAA,CAAA;YAAE,GAAG,CAA4B,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAA,CAAA,CAAA,CAAA,CAAA,CAAK;QAAA,CAAU;KAAA,CAAA;IACzD;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA;QAAA,CAAA;YAAE,GAAG,CAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAA,CAAA,CAAA,CAAA,CAAA,CAAK;QAAA,CAAU;KAAA,CAAA;IACzC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA;QAAA,CAAA;YAAE,GAAG,CAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAA,CAAA,CAAA,CAAA,CAAA,CAAK;QAAA,CAAU;KAAA,CAAA;IACzC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA;QAAA,CAAA;YAAE,GAAG,CAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAA,CAAA,CAAA,CAAA,CAAA,CAAK;QAAA,CAAU;KAAA;CAC3C,CAAA;AAaM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,WAAA,CAAc,CAAA,wKAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAiB,CAAjB,CAAA,AAAiB,CAAjB,AAAiB,CAAA,AAAjB,CAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAgB,CAAU,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA","debugId":null}}]
}