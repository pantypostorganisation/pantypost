{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/RequireAuth.tsx"],"sourcesContent":["// src/components/RequireAuth.tsx\r\n'use client';\r\n\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useEffect, useState } from 'react';\r\nimport { z } from 'zod';\r\n\r\nconst VALID_ROLES = ['buyer', 'seller', 'admin'] as const;\r\ntype ValidRole = (typeof VALID_ROLES)[number];\r\n\r\nconst RoleSchema = z.enum(VALID_ROLES);\r\n\r\nexport default function RequireAuth({\r\n  role,\r\n  children,\r\n}: {\r\n  role: ValidRole;\r\n  children: React.ReactNode;\r\n}) {\r\n  const { user, isAuthReady } = useAuth();\r\n  const router = useRouter();\r\n  const [authorized, setAuthorized] = useState(false);\r\n  const [hasChecked, setHasChecked] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isAuthReady || hasChecked) return;\r\n\r\n    // Runtime validation of `role` prop (dev-only noise)\r\n    const parsed = RoleSchema.safeParse(role);\r\n    if (!parsed.success) {\r\n      if (process.env.NODE_ENV === 'development') {\r\n        console.warn('[RequireAuth] Invalid role prop supplied:', role);\r\n      }\r\n      router.push('/login');\r\n      setHasChecked(true);\r\n      return;\r\n    }\r\n\r\n    const userRole = user?.role as ValidRole | undefined;\r\n\r\n    // NEW: strict role matching — no admin override for buyer/seller routes\r\n    let hasAccess = false;\r\n    if (parsed.data === 'admin') {\r\n      hasAccess = userRole === 'admin';\r\n    } else {\r\n      hasAccess = userRole === parsed.data; // admin can’t view buyer/seller pages\r\n    }\r\n\r\n    if (!user || !hasAccess) {\r\n      router.push('/login');\r\n    } else {\r\n      setAuthorized(true);\r\n    }\r\n\r\n    setHasChecked(true);\r\n  }, [isAuthReady, user, role, router, hasChecked]);\r\n\r\n  if (!isAuthReady || !hasChecked) {\r\n    return (\r\n      <div className=\"min-h-screen bg-black flex items-center justify-center\" role=\"status\" aria-label=\"Checking access\">\r\n        <div className=\"flex items-center space-x-2\">\r\n          <div className=\"w-4 h-4 bg-[#ff950e] rounded-full animate-pulse\" />\r\n          <div className=\"w-4 h-4 bg-[#ff950e] rounded-full animate-pulse\" style={{ animationDelay: '0.2s' }} />\r\n          <div className=\"w-4 h-4 bg-[#ff950e] rounded-full animate-pulse\" style={{ animationDelay: '0.4s' }} />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!authorized) return null;\r\n\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":"AAAA,iCAAiC;;;;;AAGjC;AACA;AACA;AACA;AALA;;;;;;AAOA,MAAM,cAAc;IAAC;IAAS;IAAU;CAAQ;AAGhD,MAAM,aAAa,kKAAA,CAAA,IAAC,CAAC,IAAI,CAAC;AAEX,SAAS,YAAY,EAClC,IAAI,EACJ,QAAQ,EAIT;IACC,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,GAAG,CAAA,GAAA,8HAAA,CAAA,UAAO,AAAD;IACpC,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAE7C,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,CAAC,eAAe,YAAY;QAEhC,qDAAqD;QACrD,MAAM,SAAS,WAAW,SAAS,CAAC;QACpC,IAAI,CAAC,OAAO,OAAO,EAAE;YACnB,wCAA4C;gBAC1C,QAAQ,IAAI,CAAC,6CAA6C;YAC5D;YACA,OAAO,IAAI,CAAC;YACZ,cAAc;YACd;QACF;QAEA,MAAM,WAAW,MAAM;QAEvB,wEAAwE;QACxE,IAAI,YAAY;QAChB,IAAI,OAAO,IAAI,KAAK,SAAS;YAC3B,YAAY,aAAa;QAC3B,OAAO;YACL,YAAY,aAAa,OAAO,IAAI,EAAE,sCAAsC;QAC9E;QAEA,IAAI,CAAC,QAAQ,CAAC,WAAW;YACvB,OAAO,IAAI,CAAC;QACd,OAAO;YACL,cAAc;QAChB;QAEA,cAAc;IAChB,GAAG;QAAC;QAAa;QAAM;QAAM;QAAQ;KAAW;IAEhD,IAAI,CAAC,eAAe,CAAC,YAAY;QAC/B,qBACE,8OAAC;YAAI,WAAU;YAAyD,MAAK;YAAS,cAAW;sBAC/F,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;;;;;kCACf,8OAAC;wBAAI,WAAU;wBAAkD,OAAO;4BAAE,gBAAgB;wBAAO;;;;;;kCACjG,8OAAC;wBAAI,WAAU;wBAAkD,OAAO;4BAAE,gBAAgB;wBAAO;;;;;;;;;;;;;;;;;IAIzG;IAEA,IAAI,CAAC,YAAY,OAAO;IAExB,qBAAO;kBAAG;;AACZ","debugId":null}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/browse/BrowseHeader.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { Sparkles, Package, ShoppingBag, Crown, Gavel } from 'lucide-react';\r\nimport { BrowseHeaderProps } from '@/types/browse';\r\n\r\nexport default function BrowseHeader({\r\n  user,\r\n  filteredListingsCount,\r\n  filter,\r\n  categoryCounts,\r\n  onFilterChange\r\n}: BrowseHeaderProps) {\r\n  return (\r\n    <>\r\n      {user?.role === 'seller' && (\r\n        <div className=\"bg-blue-700/20 border border-blue-700 text-blue-400 p-4 rounded-lg mb-6 max-w-3xl mx-auto\">\r\n          <p className=\"text-sm flex items-center gap-2\">\r\n            <Sparkles className=\"w-4 h-4\" />\r\n            You are viewing this page as a seller. You can browse listings but cannot make purchases.\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      {user?.role === 'admin' && (\r\n        <div className=\"bg-purple-900/20 border border-purple-700 text-purple-300 p-4 rounded-lg mb-6 max-w-3xl mx-auto\">\r\n          <p className=\"text-sm flex items-center gap-2\">\r\n            <Crown className=\"w-4 h-4\" />\r\n            Admins can browse for moderation and analytics, but cannot purchase or bid.\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"mb-4 max-w-[1700px] mx-auto px-6\">\r\n        <div className=\"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-4\">\r\n          <div className=\"flex flex-col leading-tight\">\r\n            <h1 className=\"text-2xl font-bold text-white mb-1\">\r\n              Browse <span className=\"text-[#ff950e]\">Listings</span>\r\n            </h1>\r\n            <p className=\"text-gray-400 text-sm\">\r\n              Discover {filteredListingsCount} amazing {filter === 'all' ? 'total' : filter} listings from verified sellers\r\n            </p>\r\n          </div>\r\n\r\n          {/* Category Filters */}\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              <button\r\n                onClick={() => onFilterChange('all')}\r\n                className={`group flex items-center gap-1.5 px-3 py-1.5 rounded-lg transition-all duration-300 shadow-lg text-xs font-medium ${\r\n                  filter === 'all'\r\n                    ? 'bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-white border border-white/20 hover:from-[#ff6b00] hover:to-[#ff950e] hover:shadow-2xl hover:shadow-[#ff950e]/30 transform hover:scale-105'\r\n                    : 'bg-gradient-to-r from-[#1a1a1a] to-[#222] hover:from-[#222] hover:to-[#333] text-[#ff950e] border border-[#333] hover:border-[#ff950e]/50 hover:shadow-[#ff950e]/20'\r\n                }`}\r\n              >\r\n                <Package className=\"w-3.5 h-3.5 group-hover:scale-110 transition-transform\" />\r\n                <span>All</span>\r\n                <span className=\"bg-black/20 px-1.5 py-0.5 rounded-full text-xs font-bold\">\r\n                  {categoryCounts.all}\r\n                </span>\r\n              </button>\r\n\r\n              <button\r\n                onClick={() => onFilterChange('standard')}\r\n                className={`group flex items-center gap-1.5 px-3 py-1.5 rounded-lg transition-all duration-300 shadow-lg text-xs font-medium ${\r\n                  filter === 'standard'\r\n                    ? 'bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-white border border-white/20 hover:from-[#ff6b00] hover:to-[#ff950e] hover:shadow-2xl hover:shadow-[#ff950e]/30 transform hover:scale-105'\r\n                    : 'bg-gradient-to-r from-[#1a1a1a] to-[#222] hover:from-[#222] hover:to-[#333] text-[#ff950e] border border-[#333] hover:border-[#ff950e]/50 hover:shadow-[#ff950e]/20'\r\n                }`}\r\n              >\r\n                <ShoppingBag className=\"w-3.5 h-3.5 group-hover:scale-110 transition-transform\" />\r\n                <span>Standard</span>\r\n                <span className=\"bg-black/20 px-1.5 py-0.5 rounded-full text-xs font-bold\">\r\n                  {categoryCounts.standard}\r\n                </span>\r\n              </button>\r\n\r\n              <button\r\n                onClick={() => onFilterChange('premium')}\r\n                className={`group flex items-center gap-1.5 px-3 py-1.5 rounded-lg transition-all duration-300 shadow-lg text-xs font-medium ${\r\n                  filter === 'premium'\r\n                    ? 'bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-white border border-white/20 hover:from-[#ff6b00] hover:to-[#ff950e] hover:shadow-2xl hover:shadow-[#ff950e]/30 transform hover:scale-105'\r\n                    : 'bg-gradient-to-r from-[#1a1a1a] to-[#222] hover:from-[#222] hover:to-[#333] text-[#ff950e] border border-[#333] hover:border-[#ff950e]/50 hover:shadow-[#ff950e]/20'\r\n                }`}\r\n              >\r\n                <Crown className=\"w-3.5 h-3.5 group-hover:scale-110 transition-transform\" />\r\n                <span>Premium</span>\r\n                <span className=\"bg-black/20 px-1.5 py-0.5 rounded-full text-xs font-bold\">\r\n                  {categoryCounts.premium}\r\n                </span>\r\n              </button>\r\n\r\n              <button\r\n                onClick={() => onFilterChange('auction')}\r\n                className={`group flex items-center gap-1.5 px-3 py-1.5 rounded-lg transition-all duration-300 shadow-lg text-xs font-medium ${\r\n                  filter === 'auction'\r\n                    ? 'bg-gradient-to-r from-[#8b5cf6] to-[#7c3aed] text-white border border-white/20 hover:from-[#7c3aed] hover:to-[#8b5cf6] hover:shadow-2xl hover:shadow-[#8b5cf6]/30 transform hover:scale-105'\r\n                    : 'bg-gradient-to-r from-[#1a1a1a] to-[#222] hover:from-[#222] hover:to-[#333] text-[#8b5cf6] border border-[#333] hover:border-[#8b5cf6]/50 hover:shadow-[#8b5cf6]/20'\r\n                }`}\r\n              >\r\n                <Gavel className=\"w-3.5 h-3.5 group-hover:scale-110 transition-transform\" />\r\n                <span>Auctions</span>\r\n                <span className=\"bg-black/20 px-1.5 py-0.5 rounded-full text-xs font-bold\">\r\n                  {categoryCounts.auction}\r\n                </span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAFA;;;AAKe,SAAS,aAAa,EACnC,IAAI,EACJ,qBAAqB,EACrB,MAAM,EACN,cAAc,EACd,cAAc,EACI;IAClB,qBACE;;YACG,MAAM,SAAS,0BACd,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAE,WAAU;;sCACX,8OAAC,0MAAA,CAAA,WAAQ;4BAAC,WAAU;;;;;;wBAAY;;;;;;;;;;;;YAMrC,MAAM,SAAS,yBACd,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAE,WAAU;;sCACX,8OAAC,oMAAA,CAAA,QAAK;4BAAC,WAAU;;;;;;wBAAY;;;;;;;;;;;;0BAMnC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;;wCAAqC;sDAC1C,8OAAC;4CAAK,WAAU;sDAAiB;;;;;;;;;;;;8CAE1C,8OAAC;oCAAE,WAAU;;wCAAwB;wCACzB;wCAAsB;wCAAU,WAAW,QAAQ,UAAU;wCAAO;;;;;;;;;;;;;sCAKlF,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCACC,SAAS,IAAM,eAAe;wCAC9B,WAAW,CAAC,iHAAiH,EAC3H,WAAW,QACP,gMACA,uKACJ;;0DAEF,8OAAC,wMAAA,CAAA,UAAO;gDAAC,WAAU;;;;;;0DACnB,8OAAC;0DAAK;;;;;;0DACN,8OAAC;gDAAK,WAAU;0DACb,eAAe,GAAG;;;;;;;;;;;;kDAIvB,8OAAC;wCACC,SAAS,IAAM,eAAe;wCAC9B,WAAW,CAAC,iHAAiH,EAC3H,WAAW,aACP,gMACA,uKACJ;;0DAEF,8OAAC,oNAAA,CAAA,cAAW;gDAAC,WAAU;;;;;;0DACvB,8OAAC;0DAAK;;;;;;0DACN,8OAAC;gDAAK,WAAU;0DACb,eAAe,QAAQ;;;;;;;;;;;;kDAI5B,8OAAC;wCACC,SAAS,IAAM,eAAe;wCAC9B,WAAW,CAAC,iHAAiH,EAC3H,WAAW,YACP,gMACA,uKACJ;;0DAEF,8OAAC,oMAAA,CAAA,QAAK;gDAAC,WAAU;;;;;;0DACjB,8OAAC;0DAAK;;;;;;0DACN,8OAAC;gDAAK,WAAU;0DACb,eAAe,OAAO;;;;;;;;;;;;kDAI3B,8OAAC;wCACC,SAAS,IAAM,eAAe;wCAC9B,WAAW,CAAC,iHAAiH,EAC3H,WAAW,YACP,gMACA,uKACJ;;0DAEF,8OAAC,oMAAA,CAAA,QAAK;gDAAC,WAAU;;;;;;0DACjB,8OAAC;0DAAK;;;;;;0DACN,8OAAC;gDAAK,WAAU;0DACb,eAAe,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASzC","debugId":null}},
    {"offset": {"line": 391, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/browse/BrowseFilters.tsx"],"sourcesContent":["// src/components/browse/BrowseFilters.tsx\r\n'use client';\r\n\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { Search, DollarSign, X, Tag } from 'lucide-react';\r\nimport { BrowseFiltersProps } from '@/types/browse';\r\nimport { SecureInput } from '@/components/ui/SecureInput';\r\nimport { sanitizeCurrency } from '@/utils/security/sanitization';\r\nimport { listingsService } from '@/services/listings.service';\r\n\r\ninterface SearchSuggestion {\r\n  type: 'tag' | 'title';\r\n  value: string;\r\n  count?: number;\r\n}\r\n\r\nexport default function BrowseFilters({\r\n  searchTerm,\r\n  onSearchTermChange,\r\n  minPrice,\r\n  onMinPriceChange,\r\n  maxPrice,\r\n  onMaxPriceChange,\r\n  sortBy,\r\n  onSortByChange,\r\n  selectedHourRange,\r\n  onHourRangeChange,\r\n  hourRangeOptions,\r\n  onClearFilters,\r\n  hasActiveFilters\r\n}: BrowseFiltersProps) {\r\n  const [suggestions, setSuggestions] = useState<SearchSuggestion[]>([]);\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const [selectedSuggestionIndex, setSelectedSuggestionIndex] = useState(-1);\r\n  const [isLoadingSuggestions, setIsLoadingSuggestions] = useState(false);\r\n  const searchInputRef = useRef<HTMLInputElement>(null);\r\n  const suggestionsRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Fetch suggestions when search term changes\r\n  useEffect(() => {\r\n    const fetchSuggestions = async () => {\r\n      if (searchTerm.length < 2) {\r\n        setSuggestions([]);\r\n        return;\r\n      }\r\n\r\n      setIsLoadingSuggestions(true);\r\n      try {\r\n        // Get popular tags that match the search term\r\n        const tagsResponse = await listingsService.getPopularTags(30);\r\n        if (tagsResponse.success && tagsResponse.data) {\r\n          const matchingTags = tagsResponse.data\r\n            .filter(tag => tag.tag.toLowerCase().includes(searchTerm.toLowerCase()))\r\n            .slice(0, 5)\r\n            .map(tag => ({\r\n              type: 'tag' as const,\r\n              value: tag.tag,\r\n              count: tag.count\r\n            }));\r\n          \r\n          setSuggestions(matchingTags);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching suggestions:', error);\r\n      } finally {\r\n        setIsLoadingSuggestions(false);\r\n      }\r\n    };\r\n\r\n    const debounceTimer = setTimeout(fetchSuggestions, 300);\r\n    return () => clearTimeout(debounceTimer);\r\n  }, [searchTerm]);\r\n\r\n  // Handle click outside to close suggestions\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (\r\n        suggestionsRef.current &&\r\n        !suggestionsRef.current.contains(event.target as Node) &&\r\n        searchInputRef.current &&\r\n        !searchInputRef.current.contains(event.target as Node)\r\n      ) {\r\n        setShowSuggestions(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  // Handle keyboard navigation\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (!showSuggestions || suggestions.length === 0) return;\r\n\r\n    switch (e.key) {\r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        setSelectedSuggestionIndex(prev => \r\n          prev < suggestions.length - 1 ? prev + 1 : 0\r\n        );\r\n        break;\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        setSelectedSuggestionIndex(prev => \r\n          prev > 0 ? prev - 1 : suggestions.length - 1\r\n        );\r\n        break;\r\n      case 'Enter':\r\n        e.preventDefault();\r\n        if (selectedSuggestionIndex >= 0) {\r\n          handleSuggestionClick(suggestions[selectedSuggestionIndex]);\r\n        }\r\n        break;\r\n      case 'Escape':\r\n        setShowSuggestions(false);\r\n        setSelectedSuggestionIndex(-1);\r\n        break;\r\n    }\r\n  };\r\n\r\n  const handleSuggestionClick = (suggestion: SearchSuggestion) => {\r\n    onSearchTermChange(suggestion.value);\r\n    setShowSuggestions(false);\r\n    setSelectedSuggestionIndex(-1);\r\n  };\r\n\r\n  // Handle secure price changes\r\n  const handleMinPriceChange = (value: string) => {\r\n    if (value === '') {\r\n      onMinPriceChange('');\r\n    } else {\r\n      const sanitized = sanitizeCurrency(value);\r\n      onMinPriceChange(sanitized.toString());\r\n    }\r\n  };\r\n\r\n  const handleMaxPriceChange = (value: string) => {\r\n    if (value === '') {\r\n      onMaxPriceChange('');\r\n    } else {\r\n      const sanitized = sanitizeCurrency(value);\r\n      onMaxPriceChange(sanitized.toString());\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-[1700px] mx-auto px-6 mb-6\">\r\n      <div className=\"flex flex-wrap gap-3 items-center bg-gradient-to-r from-[#1a1a1a]/80 to-[#222]/80 backdrop-blur-sm p-3 rounded-lg border border-gray-800 shadow-lg\">\r\n        <div className=\"relative flex-1 min-w-[200px]\">\r\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 w-4 h-4 z-10\" />\r\n          <div className=\"relative\">\r\n            <SecureInput\r\n              ref={searchInputRef}\r\n              value={searchTerm}\r\n              onChange={(value) => {\r\n                onSearchTermChange(value);\r\n                setShowSuggestions(true);\r\n              }}\r\n              onFocus={() => setShowSuggestions(true)}\r\n              onKeyDown={handleKeyDown}\r\n              placeholder=\"Search by title, description, tags, or seller...\"\r\n              className=\"w-full pl-10 pr-3 py-2 rounded-lg bg-black/50 border border-gray-700 text-sm text-white placeholder-gray-400 focus:ring-1 focus:ring-[#ff950e] focus:border-[#ff950e] transition-all\"\r\n              maxLength={100}\r\n              aria-label=\"Search listings\"\r\n            />\r\n            \r\n            {/* Suggestions Dropdown */}\r\n            {showSuggestions && suggestions.length > 0 && (\r\n              <div\r\n                ref={suggestionsRef}\r\n                className=\"absolute top-full left-0 right-0 mt-1 bg-[#1a1a1a] border border-gray-700 rounded-lg shadow-xl z-50 overflow-hidden\"\r\n              >\r\n                <div className=\"max-h-60 overflow-y-auto\">\r\n                  {suggestions.map((suggestion, index) => (\r\n                    <button\r\n                      key={`${suggestion.type}-${suggestion.value}`}\r\n                      onClick={() => handleSuggestionClick(suggestion)}\r\n                      onMouseEnter={() => setSelectedSuggestionIndex(index)}\r\n                      className={`\r\n                        w-full px-4 py-2 text-left flex items-center gap-2 transition-colors\r\n                        ${index === selectedSuggestionIndex \r\n                          ? 'bg-[#ff950e]/20 text-[#ff950e]' \r\n                          : 'text-gray-300 hover:bg-gray-800'\r\n                        }\r\n                      `}\r\n                    >\r\n                      <Tag className=\"w-3 h-3 opacity-60\" />\r\n                      <span className=\"flex-1 text-sm\">{suggestion.value}</span>\r\n                      {suggestion.count && (\r\n                        <span className=\"text-xs text-gray-500\">\r\n                          {suggestion.count} {suggestion.count === 1 ? 'item' : 'items'}\r\n                        </span>\r\n                      )}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n                {isLoadingSuggestions && (\r\n                  <div className=\"px-4 py-2 text-xs text-gray-500 border-t border-gray-700\">\r\n                    Loading suggestions...\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex gap-2 items-center\">\r\n          <div className=\"flex items-center gap-1 text-gray-400\">\r\n            <DollarSign size={14} />\r\n            <span className=\"text-xs font-medium\">Price</span>\r\n          </div>\r\n          <SecureInput\r\n            value={minPrice}\r\n            onChange={handleMinPriceChange}\r\n            placeholder=\"Min\"\r\n            type=\"number\"\r\n            className=\"px-2 py-2 rounded-lg bg-black/50 border border-gray-700 text-xs text-white placeholder-gray-400 w-16 focus:ring-1 focus:ring-[#ff950e] focus:border-[#ff950e] transition-all\"\r\n            min=\"0\"\r\n            max=\"9999\"\r\n            step=\"0.01\"\r\n            inputMode=\"decimal\"\r\n            pattern=\"[0-9]*\\.?[0-9]*\"\r\n            sanitize={false}\r\n            aria-label=\"Minimum price\"\r\n          />\r\n          <span className=\"text-gray-500 text-xs\">—</span>\r\n          <SecureInput\r\n            value={maxPrice}\r\n            onChange={handleMaxPriceChange}\r\n            placeholder=\"Max\"\r\n            type=\"number\"\r\n            className=\"px-2 py-2 rounded-lg bg-black/50 border border-gray-700 text-xs text-white placeholder-gray-400 w-16 focus:ring-1 focus:ring-[#ff950e] focus:border-[#ff950e] transition-all\"\r\n            min=\"0\"\r\n            max=\"9999\"\r\n            step=\"0.01\"\r\n            inputMode=\"decimal\"\r\n            pattern=\"[0-9]*\\.?[0-9]*\"\r\n            sanitize={false}\r\n            aria-label=\"Maximum price\"\r\n          />\r\n        </div>\r\n\r\n        <select\r\n          value={sortBy}\r\n          onChange={(e) => onSortByChange(e.target.value as any)}\r\n          className=\"px-3 py-2 rounded-lg bg-black/50 border border-gray-700 text-xs text-white cursor-pointer focus:ring-1 focus:ring-[#ff950e] focus:border-[#ff950e] transition-all\"\r\n          aria-label=\"Sort by\"\r\n        >\r\n          <option value=\"newest\">🕒 Newest First</option>\r\n          <option value=\"priceAsc\">💰 Price: Low → High</option>\r\n          <option value=\"priceDesc\">💎 Price: High → Low</option>\r\n          <option value=\"endingSoon\">⏰ Ending Soon</option>\r\n        </select>\r\n\r\n        <select\r\n          value={selectedHourRange.label}\r\n          onChange={(e) => {\r\n            const selectedOption = hourRangeOptions.find(opt => opt.label === e.target.value);\r\n            if (selectedOption) onHourRangeChange(selectedOption);\r\n          }}\r\n          className=\"px-3 py-2 rounded-lg bg-black/50 border border-gray-700 text-xs text-white cursor-pointer focus:ring-1 focus:ring-[#ff950e] focus:border-[#ff950e] transition-all\"\r\n          aria-label=\"Delivery time filter\"\r\n        >\r\n          {hourRangeOptions.map(option => (\r\n            <option key={option.label} value={option.label}>\r\n              {option.label === 'Any Hours' ? '⏱️ Any Hours' : `⏱️ ${option.label}`}\r\n            </option>\r\n          ))}\r\n        </select>\r\n\r\n        {hasActiveFilters && (\r\n          <button\r\n            onClick={onClearFilters}\r\n            className=\"px-3 py-2 rounded-lg bg-red-600/20 border border-red-700 text-red-400 hover:bg-red-600/30 text-xs transition-all flex items-center gap-1 font-medium\"\r\n            aria-label=\"Clear filters\"\r\n          >\r\n            <X size={12} />\r\n            Clear\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 795, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/utils/browseUtils.ts"],"sourcesContent":["// src/utils/browseUtils.ts\r\n\r\nimport { Listing, AuctionSettings } from '@/context/ListingContext';\r\nimport { HourRangeOption } from '@/types/browse';\r\n\r\nexport const HOUR_RANGE_OPTIONS: HourRangeOption[] = [\r\n  { label: 'Any Hours', min: 0, max: Infinity },\r\n  { label: '12+ Hours', min: 12, max: Infinity },\r\n  { label: '24+ Hours', min: 24, max: Infinity },\r\n  { label: '48+ Hours', min: 48, max: Infinity },\r\n];\r\n\r\nexport const PAGE_SIZE = 40;\r\n\r\n// Type guard for auction listings\r\nexport const isAuctionListing = (listing: Listing): listing is Listing & { auction: AuctionSettings } => {\r\n  return !!listing.auction;\r\n};\r\n\r\n// Safe date parsing with validation\r\nexport const safeParseDate = (dateString: string | undefined): Date | null => {\r\n  if (!dateString) return null;\r\n  \r\n  try {\r\n    const date = new Date(dateString);\r\n    // Check if date is valid\r\n    if (isNaN(date.getTime())) {\r\n      console.warn('Invalid date string:', dateString);\r\n      return null;\r\n    }\r\n    return date;\r\n  } catch (error) {\r\n    console.error('Date parsing error:', error, 'for string:', dateString);\r\n    return null;\r\n  }\r\n};\r\n\r\n// Helper function to check if listing is active\r\nexport const isListingActive = (listing: Listing): boolean => {\r\n  if (listing.auction) {\r\n    const isActive = listing.auction.status === 'active';\r\n    const endTime = safeParseDate(listing.auction.endTime);\r\n    const endTimeNotPassed = endTime ? endTime > new Date() : false;\r\n    return isActive && endTimeNotPassed;\r\n  }\r\n  return true; // Non-auction listings are always active\r\n};\r\n\r\n// Get display price for a listing\r\nexport const getDisplayPrice = (listing: Listing): { price: string; label: string } => {\r\n  try {\r\n    if (isAuctionListing(listing)) {\r\n      const hasActiveBids = listing.auction.bids && listing.auction.bids.length > 0;\r\n      const highestBid = listing.auction.highestBid;\r\n      \r\n      // Check for null/undefined explicitly, not falsy (allows 0)\r\n      if (hasActiveBids && highestBid !== null && highestBid !== undefined) {\r\n        return {\r\n          price: highestBid.toFixed(2),\r\n          label: 'Current Bid'\r\n        };\r\n      } else {\r\n        return {\r\n          price: listing.auction.startingPrice.toFixed(2),\r\n          label: 'Starting Bid'\r\n        };\r\n      }\r\n    } else {\r\n      return {\r\n        price: listing.markedUpPrice?.toFixed(2) ?? listing.price.toFixed(2),\r\n        label: 'Buy Now'\r\n      };\r\n    }\r\n  } catch (error) {\r\n    console.error('Error getting display price:', error);\r\n    return { price: '0.00', label: 'Price Error' };\r\n  }\r\n};\r\n\r\n// Format time remaining for auction\r\nexport const formatTimeRemaining = (endTimeStr: string, timeCache: React.MutableRefObject<{[key: string]: {formatted: string, expires: number}}>): string => {\r\n  try {\r\n    const now = new Date();\r\n    const nowTime = now.getTime();\r\n    \r\n    // Check cache first\r\n    const cached = timeCache.current[endTimeStr];\r\n    if (cached && cached.expires > nowTime) {\r\n      return cached.formatted;\r\n    }\r\n    \r\n    const endTime = safeParseDate(endTimeStr);\r\n    if (!endTime) {\r\n      return 'Invalid time';\r\n    }\r\n    \r\n    if (endTime <= now) {\r\n      // Cache ended auctions for longer to prevent repeated calculations\r\n      timeCache.current[endTimeStr] = {\r\n        formatted: 'Ended',\r\n        expires: nowTime + 300000 // Cache for 5 minutes\r\n      };\r\n      return 'Ended';\r\n    }\r\n    \r\n    const diffMs = endTime.getTime() - nowTime;\r\n    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\r\n    const diffHours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n    const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));\r\n    \r\n    let formatted: string;\r\n    let cacheTime: number;\r\n    \r\n    if (diffDays > 0) {\r\n      formatted = `${diffDays}d ${diffHours}h`;\r\n      cacheTime = 300000; // Cache for 5 minutes\r\n    } else if (diffHours > 0) {\r\n      formatted = `${diffHours}h ${diffMinutes}m`;\r\n      cacheTime = 60000; // Cache for 1 minute\r\n    } else if (diffMinutes > 0) {\r\n      formatted = `${diffMinutes}m`;\r\n      cacheTime = 30000; // Cache for 30 seconds\r\n    } else {\r\n      formatted = 'Soon';\r\n      cacheTime = 10000; // Cache for 10 seconds\r\n    }\r\n    \r\n    // Update cache\r\n    timeCache.current[endTimeStr] = {\r\n      formatted,\r\n      expires: nowTime + cacheTime\r\n    };\r\n    \r\n    return formatted;\r\n  } catch (error) {\r\n    console.error('Error formatting time remaining:', error, 'for string:', endTimeStr);\r\n    return 'Time error';\r\n  }\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 941, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/browse/ListingCard.tsx"],"sourcesContent":["// src/components/browse/ListingCard.tsx\r\n'use client';\r\n\r\nimport Link from 'next/link';\r\nimport {\r\n  Crown, Clock, Lock, CheckCircle, Gavel, ArrowUp, Eye, Package, Heart\r\n} from 'lucide-react';\r\nimport { ListingCardProps } from '@/types/browse';\r\nimport { isAuctionListing } from '@/utils/browseUtils';\r\nimport { useFavorites } from '@/context/FavoritesContext';\r\nimport { useToast } from '@/context/ToastContext';\r\n\r\nexport default function ListingCard({\r\n  listing,\r\n  isHovered,\r\n  onMouseEnter,\r\n  onMouseLeave,\r\n  onClick,\r\n  onQuickView,\r\n  user,\r\n  isSubscribed,\r\n  displayPrice,\r\n  forceUpdateTimer,\r\n  formatTimeRemaining\r\n}: ListingCardProps) {\r\n  // FIXED: Use the server's isLocked field directly\r\n  const isLockedPremium = listing.isLocked === true;\r\n  const hasAuction = isAuctionListing(listing);\r\n\r\n  // Favorites functionality\r\n  const { isFavorited, toggleFavorite } = useFavorites();\r\n  const { error: showErrorToast, success: showSuccessToast } = useToast();\r\n\r\n  // Generate consistent seller ID\r\n  const sellerId = `seller_${listing.seller}`;\r\n  const isFav = user?.role === 'buyer' ? isFavorited(sellerId) : false;\r\n\r\n  const handleFavoriteClick = async (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n\r\n    if (user?.role !== 'buyer') {\r\n      showErrorToast('Only buyers can add favorites');\r\n      return;\r\n    }\r\n\r\n    const success = await toggleFavorite({\r\n      id: sellerId,\r\n      username: listing.seller,\r\n      profilePicture: listing.sellerProfile?.pic || undefined,\r\n      tier: undefined,\r\n      isVerified: listing.isSellerVerified || false,\r\n    });\r\n\r\n    if (success) {\r\n      showSuccessToast(isFav ? 'Removed from favorites' : 'Added to favorites');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`relative flex flex-col bg-gradient-to-br from-[#1a1a1a] to-[#111] border ${\r\n        hasAuction ? 'border-purple-800' : 'border-gray-800'\r\n      } rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden ${\r\n        hasAuction ? 'hover:border-purple-600' : 'hover:border-[#ff950e]'\r\n      } cursor-pointer group hover:transform hover:scale-[1.02]`}\r\n      onMouseEnter={onMouseEnter}\r\n      onMouseLeave={onMouseLeave}\r\n      onClick={onClick}\r\n    >\r\n      {/* Type Badge and Favorite Button */}\r\n      <div className=\"absolute top-4 right-4 z-10 flex items-center gap-2\">\r\n        {/* Favorite Button for Buyers */}\r\n        {user?.role === 'buyer' && !isLockedPremium && (\r\n          <button\r\n            onClick={handleFavoriteClick}\r\n            className=\"p-2 bg-black/70 backdrop-blur-sm rounded-lg hover:bg-black/90 transition-all group/fav\"\r\n            aria-label={isFav ? 'Remove from favorites' : 'Add to favorites'}\r\n          >\r\n            <Heart\r\n              size={16}\r\n              className={`transition-all group-hover/fav:scale-110 ${\r\n                isFav ? 'fill-[#ff950e] text-[#ff950e]' : 'text-white hover:text-[#ff950e]'\r\n              }`}\r\n            />\r\n          </button>\r\n        )}\r\n\r\n        {/* Type Badges */}\r\n        {hasAuction && (\r\n          <span className=\"bg-gradient-to-r from-purple-600 to-purple-500 text-white text-xs px-3 py-1.5 rounded-lg font-bold flex items-center shadow-lg\">\r\n            <Gavel className=\"w-3.5 h-3.5 mr-1.5\" /> AUCTION\r\n          </span>\r\n        )}\r\n\r\n        {!hasAuction && listing.isPremium && (\r\n          <span className=\"bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-black text-xs px-3 py-1.5 rounded-lg font-bold flex items-center shadow-lg\">\r\n            <Crown className=\"w-3.5 h-3.5 mr-1.5\" /> PREMIUM\r\n          </span>\r\n        )}\r\n      </div>\r\n\r\n      {/* Image */}\r\n      <div className=\"relative aspect-square overflow-hidden bg-black\">\r\n        {listing.imageUrls && listing.imageUrls.length > 0 ? (\r\n          <img\r\n            src={listing.imageUrls[0]}\r\n            alt={listing.title}\r\n            className={`w-full h-full object-cover group-hover:scale-110 transition-transform duration-500 ${\r\n              isLockedPremium ? 'blur-md' : ''\r\n            }`}\r\n            onError={(e) => {\r\n              const target = e.currentTarget;\r\n              target.src = '/placeholder-panty.png';\r\n              target.onerror = null;\r\n              console.warn('Image failed to load:', listing.imageUrls?.[0]);\r\n            }}\r\n          />\r\n        ) : (\r\n          <div className=\"w-full h-full flex items-center justify-center bg-gray-900\">\r\n            <div className=\"text-center text-gray-400\">\r\n              <Package className=\"w-16 h-16 mx-auto mb-3 opacity-50\" />\r\n              <p className=\"text-sm\">No Image Available</p>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Enhanced bottom gradient */}\r\n        <div className=\"absolute inset-x-0 bottom-0 h-32 bg-gradient-to-t from-black/80 via-black/40 to-transparent pointer-events-none\" />\r\n\r\n        {isLockedPremium && (\r\n          <div className=\"absolute inset-0 bg-black/70 flex flex-col items-center justify-center backdrop-blur-sm\">\r\n            <Lock className=\"w-12 h-12 text-[#ff950e] mb-4\" />\r\n            <p className=\"text-sm font-bold text-white text-center px-4\">\r\n              Subscribe to view premium content\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Enhanced auction timer */}\r\n        {hasAuction && listing.auction && (\r\n          <div className=\"absolute bottom-4 left-4 z-10\" key={`timer-${listing.id}-${forceUpdateTimer}`}>\r\n            <span className=\"bg-black/90 backdrop-blur-sm text-white text-xs px-3 py-2 rounded-lg font-bold flex items-center shadow-lg border border-purple-500/30\">\r\n              <Clock className=\"w-4 h-4 mr-2 text-purple-400\" />\r\n              {formatTimeRemaining(listing.auction.endTime)}\r\n            </span>\r\n          </div>\r\n        )}\r\n\r\n        {/* Enhanced quick view button */}\r\n        {isHovered && !isLockedPremium && (\r\n          <div className=\"absolute bottom-4 right-4 z-10\">\r\n            <button\r\n              className=\"bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-black text-sm font-bold px-4 py-2 rounded-lg flex items-center gap-2 shadow-xl hover:from-[#e88800] hover:to-[#ff950e] transition-all transform hover:scale-105\"\r\n              onClick={onQuickView}\r\n              aria-label=\"Quick view\"\r\n            >\r\n              <Eye className=\"w-4 h-4\" /> Quick View\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"p-5 flex flex-col flex-grow\">\r\n        <div>\r\n          <h2 className=\"text-xl font-bold text-white mb-2 line-clamp-1 group-hover:text-[#ff950e] transition-colors\">\r\n            {listing.title}\r\n          </h2>\r\n          <p className=\"text-sm text-gray-400 mb-3 line-clamp-2 leading-relaxed\">\r\n            {listing.description}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Tags */}\r\n        {listing.tags && listing.tags.length > 0 && (\r\n          <div className=\"flex flex-wrap gap-2 mb-4\">\r\n            {listing.tags.slice(0, 3).map((tag, i) => (\r\n              <span key={i} className=\"bg-black/50 text-[#ff950e] text-xs px-3 py-1 rounded-full font-medium border border-[#ff950e]/20\">\r\n                #{tag}\r\n              </span>\r\n            ))}\r\n            {listing.tags.length > 3 && (\r\n              <span className=\"text-gray-500 text-xs px-2 py-1\">\r\n                +{listing.tags.length - 3} more\r\n              </span>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Auction info */}\r\n        {hasAuction && listing.auction && (\r\n          <div className=\"bg-gradient-to-r from-purple-900/30 to-purple-800/20 rounded-xl p-4 mb-4 border border-purple-700/30 backdrop-blur-sm\">\r\n            <div className=\"flex justify-between items-center text-sm mb-2\">\r\n              <span className=\"text-purple-300 font-medium\">{displayPrice.label}</span>\r\n              <span className=\"font-bold text-white flex items-center text-lg\">\r\n                {listing.auction.bids && listing.auction.bids.length > 0 && (\r\n                  <ArrowUp className=\"w-4 h-4 text-green-400 mr-1\" />\r\n                )}\r\n                ${displayPrice.price}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center text-xs\">\r\n              <span className=\"text-gray-400 flex items-center gap-1\">\r\n                <Gavel className=\"w-3 h-3\" />\r\n                {listing.auction.bids?.length || 0} bids\r\n              </span>\r\n              {listing.auction.reservePrice && (\r\n                <span\r\n                  className={`font-medium ${\r\n                    (!listing.auction.highestBid || listing.auction.highestBid < listing.auction.reservePrice)\r\n                      ? 'text-yellow-400'\r\n                      : 'text-green-400'\r\n                  }`}\r\n                >\r\n                  {(!listing.auction.highestBid || listing.auction.highestBid < listing.auction.reservePrice)\r\n                    ? '⚠️ Reserve not met'\r\n                    : '✅ Reserve met'\r\n                  }\r\n                </span>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Price & seller */}\r\n        <div className=\"flex justify-between items-end mt-auto\">\r\n          <Link\r\n            href={`/sellers/${listing.seller}`}\r\n            className=\"flex items-center gap-3 text-base text-gray-400 hover:text-[#ff950e] transition-colors group/seller\"\r\n            onClick={e => e.stopPropagation()}\r\n          >\r\n            {listing.sellerProfile?.pic ? (\r\n              <img\r\n                src={listing.sellerProfile.pic}\r\n                alt={listing.seller}\r\n                className=\"w-12 h-12 rounded-full object-cover border-2 border-gray-700 group-hover/seller:border-[#ff950e] transition-colors\"\r\n                onError={(e) => {\r\n                  const target = e.currentTarget;\r\n                  target.src = '/default-avatar.png';\r\n                  target.onerror = null;\r\n                }}\r\n              />\r\n            ) : (\r\n              <span className=\"w-12 h-12 rounded-full bg-gradient-to-br from-gray-800 to-gray-700 flex items-center justify-center text-lg font-bold text-[#ff950e] border-2 border-gray-700 group-hover/seller:border-[#ff950e] transition-colors\">\r\n                {listing.seller.charAt(0).toUpperCase()}\r\n              </span>\r\n            )}\r\n            <div className=\"flex flex-col\">\r\n              <span className=\"font-bold text-base flex items-center gap-2\">\r\n                {listing.seller}\r\n                {listing.isSellerVerified && (\r\n                  <img\r\n                    src=\"/verification_badge.png\"\r\n                    alt=\"Verified\"\r\n                    className=\"w-5 h-5\"\r\n                  />\r\n                )}\r\n              </span>\r\n              {(listing.sellerSalesCount ?? 0) > 0 && (\r\n                <span className=\"text-xs text-gray-500 flex items-center gap-1\">\r\n                  <CheckCircle className=\"w-3 h-3\" />\r\n                  {listing.sellerSalesCount} completed sales\r\n                </span>\r\n              )}\r\n            </div>\r\n          </Link>\r\n\r\n          {!hasAuction && (\r\n            <div className=\"text-right\">\r\n              <p className=\"font-bold text-[#ff950e] text-2xl\">\r\n                ${displayPrice.price}\r\n              </p>\r\n              <p className=\"text-xs text-gray-500 font-medium\">\r\n                {displayPrice.label}\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Locked premium CTA */}\r\n        {user?.role === 'buyer' && isLockedPremium && (\r\n          <Link\r\n            href={`/sellers/${listing.seller}`}\r\n            className=\"mt-4 w-full bg-gradient-to-r from-gray-700 to-gray-600 text-white px-4 py-3 rounded-xl hover:from-gray-600 hover:to-gray-500 font-bold transition-all text-sm text-center flex items-center justify-center gap-2 shadow-lg\"\r\n            onClick={e => e.stopPropagation()}\r\n          >\r\n            <Lock className=\"w-4 h-4\" /> Subscribe to Unlock\r\n          </Link>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1484, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/browse/ListingGrid.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { AlertTriangle } from 'lucide-react';\r\nimport ListingCard from './ListingCard';\r\nimport { ListingGridProps } from '@/types/browse';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\nexport default function ListingGrid({\r\n  listings,\r\n  hoveredListing,\r\n  onListingHover,\r\n  onListingLeave,\r\n  onListingClick,\r\n  onQuickView,\r\n  user,\r\n  isSubscribed,\r\n  getDisplayPrice,\r\n  forceUpdateTimer,\r\n  formatTimeRemaining,\r\n  listingErrors,\r\n  onListingError\r\n}: ListingGridProps) {\r\n  return (\r\n    <div className=\"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6\">\r\n      {listings.map((listing) => {\r\n        // Individual listing error handling\r\n        if (listingErrors[listing.id]) {\r\n          return (\r\n            <div key={listing.id} className=\"bg-red-900/20 border border-red-700 rounded-xl p-4 text-center\">\r\n              <AlertTriangle className=\"w-8 h-8 text-red-400 mx-auto mb-2\" />\r\n              <p className=\"text-red-400 text-sm\">Error loading listing</p>\r\n              <SecureMessageDisplay\r\n                content={listingErrors[listing.id]}\r\n                allowBasicFormatting={false}\r\n                className=\"text-gray-500 text-xs mt-1\"\r\n                maxLength={100}\r\n              />\r\n            </div>\r\n          );\r\n        }\r\n\r\n        try {\r\n          const isLockedPremium =\r\n            listing.isPremium && (!user?.username || !isSubscribed(user?.username, listing.seller));\r\n          const displayPrice = getDisplayPrice(listing);\r\n\r\n          return (\r\n            <ListingCard\r\n              key={listing.id}\r\n              listing={listing}\r\n              isHovered={hoveredListing === listing.id}\r\n              onMouseEnter={() => onListingHover(listing.id)}\r\n              onMouseLeave={onListingLeave}\r\n              onClick={() => onListingClick(listing.id, Boolean(isLockedPremium))}\r\n              onQuickView={(e) => onQuickView(e, listing.id)}\r\n              user={user}\r\n              isSubscribed={isSubscribed(user?.username || '', listing.seller)}\r\n              displayPrice={displayPrice}\r\n              forceUpdateTimer={forceUpdateTimer}\r\n              formatTimeRemaining={formatTimeRemaining}\r\n            />\r\n          );\r\n        } catch (error) {\r\n          onListingError(error as Error, listing.id);\r\n          return null;\r\n        }\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAEA;AALA;;;;;AAOe,SAAS,YAAY,EAClC,QAAQ,EACR,cAAc,EACd,cAAc,EACd,cAAc,EACd,cAAc,EACd,WAAW,EACX,IAAI,EACJ,YAAY,EACZ,eAAe,EACf,gBAAgB,EAChB,mBAAmB,EACnB,aAAa,EACb,cAAc,EACG;IACjB,qBACE,8OAAC;QAAI,WAAU;kBACZ,SAAS,GAAG,CAAC,CAAC;YACb,oCAAoC;YACpC,IAAI,aAAa,CAAC,QAAQ,EAAE,CAAC,EAAE;gBAC7B,qBACE,8OAAC;oBAAqB,WAAU;;sCAC9B,8OAAC,wNAAA,CAAA,gBAAa;4BAAC,WAAU;;;;;;sCACzB,8OAAC;4BAAE,WAAU;sCAAuB;;;;;;sCACpC,8OAAC,gJAAA,CAAA,uBAAoB;4BACnB,SAAS,aAAa,CAAC,QAAQ,EAAE,CAAC;4BAClC,sBAAsB;4BACtB,WAAU;4BACV,WAAW;;;;;;;mBAPL,QAAQ,EAAE;;;;;YAWxB;YAEA,IAAI;gBACF,MAAM,kBACJ,QAAQ,SAAS,IAAI,CAAC,CAAC,MAAM,YAAY,CAAC,aAAa,MAAM,UAAU,QAAQ,MAAM,CAAC;gBACxF,MAAM,eAAe,gBAAgB;gBAErC,qBACE,8OAAC,2IAAA,CAAA,UAAW;oBAEV,SAAS;oBACT,WAAW,mBAAmB,QAAQ,EAAE;oBACxC,cAAc,IAAM,eAAe,QAAQ,EAAE;oBAC7C,cAAc;oBACd,SAAS,IAAM,eAAe,QAAQ,EAAE,EAAE,QAAQ;oBAClD,aAAa,CAAC,IAAM,YAAY,GAAG,QAAQ,EAAE;oBAC7C,MAAM;oBACN,cAAc,aAAa,MAAM,YAAY,IAAI,QAAQ,MAAM;oBAC/D,cAAc;oBACd,kBAAkB;oBAClB,qBAAqB;mBAXhB,QAAQ,EAAE;;;;;YAcrB,EAAE,OAAO,OAAO;gBACd,eAAe,OAAgB,QAAQ,EAAE;gBACzC,OAAO;YACT;QACF;;;;;;AAGN","debugId":null}},
    {"offset": {"line": 1572, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/browse/PaginationControls.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { PaginationControlsProps } from '@/types/browse';\r\n\r\nexport default function PaginationControls({\r\n  currentPage,\r\n  totalPages,\r\n  filteredListingsCount,\r\n  pageSize,\r\n  onPreviousPage,\r\n  onNextPage,\r\n  onPageClick\r\n}: PaginationControlsProps) {\r\n  const renderPageIndicators = () => {\r\n    if (totalPages <= 1) return null;\r\n\r\n    const indicators = [];\r\n\r\n    if (currentPage > 0) {\r\n      indicators.push(\r\n        <span\r\n          key={0}\r\n          className=\"px-2 py-1 text-sm text-gray-400 cursor-pointer hover:text-[#ff950e]\"\r\n          onClick={() => onPageClick(0)}\r\n        >\r\n          1\r\n        </span>\r\n      );\r\n    }\r\n\r\n    if (currentPage > 2) {\r\n      indicators.push(\r\n        <span key=\"start-ellipsis\" className=\"px-2 py-1 text-sm text-gray-500\">...</span>\r\n      );\r\n    }\r\n\r\n    let startPage = Math.max(1, currentPage - 1);\r\n    let endPage = Math.min(totalPages - 2, currentPage + 1);\r\n\r\n    if (endPage - startPage < 2 && totalPages > 3) {\r\n      if (startPage === 1) {\r\n        endPage = Math.min(totalPages - 2, 3);\r\n      } else if (endPage === totalPages - 2) {\r\n        startPage = Math.max(1, totalPages - 4);\r\n      }\r\n    }\r\n\r\n    for (let i = startPage; i <= endPage; i++) {\r\n      if (i === currentPage) {\r\n        indicators.push(\r\n          <span key={i} className=\"px-2 py-1 text-sm font-bold text-[#ff950e] border-b-2 border-[#ff950e]\">\r\n            {i + 1}\r\n          </span>\r\n        );\r\n      } else {\r\n        indicators.push(\r\n          <span\r\n            key={i}\r\n            className=\"px-2 py-1 text-sm text-gray-400 cursor-pointer hover:text-[#ff950e]\"\r\n            onClick={() => onPageClick(i)}\r\n          >\r\n            {i + 1}\r\n          </span>\r\n        );\r\n      }\r\n    }\r\n\r\n    if (endPage < totalPages - 2) {\r\n      indicators.push(\r\n        <span key=\"end-ellipsis\" className=\"px-2 py-1 text-sm text-gray-500\">...</span>\r\n      );\r\n    }\r\n\r\n    if (currentPage < totalPages - 1) {\r\n      indicators.push(\r\n        <span\r\n          key={totalPages - 1}\r\n          className=\"px-2 py-1 text-sm text-gray-400 cursor-pointer hover:text-[#ff950e]\"\r\n          onClick={() => onPageClick(totalPages - 1)}\r\n        >\r\n          {totalPages}\r\n        </span>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"flex justify-center items-center gap-1 mt-4\" aria-label=\"Pagination\">\r\n        {indicators}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  if (filteredListingsCount <= pageSize && currentPage === 0) return null;\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-center mt-16 gap-4\">\r\n      <div className=\"flex gap-4\">\r\n        {currentPage > 0 && (\r\n          <button\r\n            className=\"px-8 py-3 rounded-xl bg-gradient-to-r from-[#1a1a1a] to-[#222] text-white font-bold hover:from-[#222] hover:to-[#333] transition-all border border-gray-800 shadow-lg hover:shadow-xl\"\r\n            onClick={onPreviousPage}\r\n            aria-label=\"Previous page\"\r\n          >\r\n            ← Previous\r\n          </button>\r\n        )}\r\n        {filteredListingsCount > pageSize * (currentPage + 1) && (\r\n          <button\r\n            className=\"px-8 py-3 rounded-xl bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-black font-bold hover:from-[#e88800] hover:to-[#ff950e] transition-all shadow-lg hover:shadow-xl transform hover:scale-105\"\r\n            onClick={onNextPage}\r\n            aria-label=\"Next page\"\r\n          >\r\n            Next →\r\n          </button>\r\n        )}\r\n      </div>\r\n      {renderPageIndicators()}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAIe,SAAS,mBAAmB,EACzC,WAAW,EACX,UAAU,EACV,qBAAqB,EACrB,QAAQ,EACR,cAAc,EACd,UAAU,EACV,WAAW,EACa;IACxB,MAAM,uBAAuB;QAC3B,IAAI,cAAc,GAAG,OAAO;QAE5B,MAAM,aAAa,EAAE;QAErB,IAAI,cAAc,GAAG;YACnB,WAAW,IAAI,eACb,8OAAC;gBAEC,WAAU;gBACV,SAAS,IAAM,YAAY;0BAC5B;eAHM;;;;;QAOX;QAEA,IAAI,cAAc,GAAG;YACnB,WAAW,IAAI,eACb,8OAAC;gBAA0B,WAAU;0BAAkC;eAA7D;;;;;QAEd;QAEA,IAAI,YAAY,KAAK,GAAG,CAAC,GAAG,cAAc;QAC1C,IAAI,UAAU,KAAK,GAAG,CAAC,aAAa,GAAG,cAAc;QAErD,IAAI,UAAU,YAAY,KAAK,aAAa,GAAG;YAC7C,IAAI,cAAc,GAAG;gBACnB,UAAU,KAAK,GAAG,CAAC,aAAa,GAAG;YACrC,OAAO,IAAI,YAAY,aAAa,GAAG;gBACrC,YAAY,KAAK,GAAG,CAAC,GAAG,aAAa;YACvC;QACF;QAEA,IAAK,IAAI,IAAI,WAAW,KAAK,SAAS,IAAK;YACzC,IAAI,MAAM,aAAa;gBACrB,WAAW,IAAI,eACb,8OAAC;oBAAa,WAAU;8BACrB,IAAI;mBADI;;;;;YAIf,OAAO;gBACL,WAAW,IAAI,eACb,8OAAC;oBAEC,WAAU;oBACV,SAAS,IAAM,YAAY;8BAE1B,IAAI;mBAJA;;;;;YAOX;QACF;QAEA,IAAI,UAAU,aAAa,GAAG;YAC5B,WAAW,IAAI,eACb,8OAAC;gBAAwB,WAAU;0BAAkC;eAA3D;;;;;QAEd;QAEA,IAAI,cAAc,aAAa,GAAG;YAChC,WAAW,IAAI,eACb,8OAAC;gBAEC,WAAU;gBACV,SAAS,IAAM,YAAY,aAAa;0BAEvC;eAJI,aAAa;;;;;QAOxB;QAEA,qBACE,8OAAC;YAAI,WAAU;YAA8C,cAAW;sBACrE;;;;;;IAGP;IAEA,IAAI,yBAAyB,YAAY,gBAAgB,GAAG,OAAO;IAEnE,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;oBACZ,cAAc,mBACb,8OAAC;wBACC,WAAU;wBACV,SAAS;wBACT,cAAW;kCACZ;;;;;;oBAIF,wBAAwB,WAAW,CAAC,cAAc,CAAC,mBAClD,8OAAC;wBACC,WAAU;wBACV,SAAS;wBACT,cAAW;kCACZ;;;;;;;;;;;;YAKJ;;;;;;;AAGP","debugId":null}},
    {"offset": {"line": 1710, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/browse/EmptyState.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ShoppingBag } from 'lucide-react';\r\nimport { EmptyStateProps } from '@/types/browse';\r\nimport { SecureMessageDisplay } from '@/components/ui/SecureMessageDisplay';\r\n\r\nexport default function EmptyState({ searchTerm, onResetFilters }: EmptyStateProps) {\r\n  return (\r\n    <div className=\"text-center py-24 bg-gradient-to-br from-[#1a1a1a] to-[#111] rounded-2xl border border-gray-800 shadow-2xl\">\r\n      <div className=\"mb-6\">\r\n        <ShoppingBag className=\"w-20 h-20 text-gray-600 mx-auto mb-4\" />\r\n        <div className=\"w-24 h-1 bg-gradient-to-r from-[#ff950e] to-[#ff6b00] mx-auto rounded-full mb-6\"></div>\r\n      </div>\r\n      <h3 className=\"text-white font-bold text-2xl mb-3\">No listings found</h3>\r\n      <p className=\"text-gray-400 mb-8 max-w-md mx-auto\">\r\n        {searchTerm ? (\r\n          <>\r\n            We couldn't find any listings matching \"<SecureMessageDisplay\r\n              content={searchTerm}\r\n              allowBasicFormatting={false}\r\n              className=\"inline font-semibold text-[#ff950e]\"\r\n            />\". Try adjusting your filters or check back later for new items.\r\n          </>\r\n        ) : (\r\n          \"We couldn't find any listings matching your criteria. Try adjusting your filters or check back later for new items.\"\r\n        )}\r\n      </p>\r\n      <button\r\n        onClick={onResetFilters}\r\n        className=\"px-8 py-3 bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-black rounded-xl font-bold hover:from-[#e88800] hover:to-[#ff950e] transition-all shadow-lg hover:shadow-xl transform hover:scale-105\"\r\n        aria-label=\"Reset all filters\"\r\n      >\r\n        Reset All Filters\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AAEA;AAJA;;;;AAMe,SAAS,WAAW,EAAE,UAAU,EAAE,cAAc,EAAmB;IAChF,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,oNAAA,CAAA,cAAW;wBAAC,WAAU;;;;;;kCACvB,8OAAC;wBAAI,WAAU;;;;;;;;;;;;0BAEjB,8OAAC;gBAAG,WAAU;0BAAqC;;;;;;0BACnD,8OAAC;gBAAE,WAAU;0BACV,2BACC;;wBAAE;sCACwC,8OAAC,gJAAA,CAAA,uBAAoB;4BAC3D,SAAS;4BACT,sBAAsB;4BACtB,WAAU;;;;;;wBACV;;mCAGJ;;;;;;0BAGJ,8OAAC;gBACC,SAAS;gBACT,WAAU;gBACV,cAAW;0BACZ;;;;;;;;;;;;AAKP","debugId":null}},
    {"offset": {"line": 1798, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/components/browse/PopularTags.tsx"],"sourcesContent":["// src/components/browse/PopularTags.tsx\r\n'use client';\r\n\r\nimport { Tag, TrendingUp, Loader } from 'lucide-react';\r\n\r\ninterface PopularTag {\r\n  tag: string;\r\n  count: number;\r\n}\r\n\r\ninterface PopularTagsProps {\r\n  tags: PopularTag[];\r\n  onTagClick: (tag: string) => void;\r\n  isLoading?: boolean;\r\n  error?: string | null;\r\n}\r\n\r\nexport default function PopularTags({ tags, onTagClick, isLoading, error }: PopularTagsProps) {\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"max-w-[1700px] mx-auto px-6 mb-6\">\r\n        <div className=\"bg-gradient-to-r from-[#1a1a1a]/80 to-[#222]/80 backdrop-blur-sm p-4 rounded-lg border border-gray-800 shadow-lg\">\r\n          <div className=\"flex items-center justify-center gap-2 text-gray-400\">\r\n            <Loader className=\"w-4 h-4 animate-spin\" />\r\n            <span className=\"text-sm\">Loading popular tags...</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || tags.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  // Sort tags by count and take top tags\r\n  const sortedTags = [...tags].sort((a, b) => b.count - a.count);\r\n  \r\n  // Calculate relative sizes based on count\r\n  const maxCount = Math.max(...tags.map(t => t.count));\r\n  const minCount = Math.min(...tags.map(t => t.count));\r\n  const range = maxCount - minCount || 1;\r\n\r\n  const getTagSize = (count: number) => {\r\n    const normalized = (count - minCount) / range;\r\n    if (normalized > 0.8) return 'text-sm font-bold';\r\n    if (normalized > 0.5) return 'text-xs font-semibold';\r\n    return 'text-xs font-medium';\r\n  };\r\n\r\n  const getTagColor = (count: number) => {\r\n    const normalized = (count - minCount) / range;\r\n    if (normalized > 0.8) return 'bg-gradient-to-r from-[#ff950e] to-[#ff6b00] text-black border-[#ff950e]';\r\n    if (normalized > 0.5) return 'bg-[#ff950e]/20 text-[#ff950e] border-[#ff950e]/50';\r\n    return 'bg-black/50 text-gray-300 border-gray-600';\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-[1700px] mx-auto px-6 mb-6\">\r\n      <div className=\"bg-gradient-to-r from-[#1a1a1a]/80 to-[#222]/80 backdrop-blur-sm p-4 rounded-lg border border-gray-800 shadow-lg\">\r\n        <div className=\"flex items-start gap-4\">\r\n          <div className=\"flex items-center gap-2 text-gray-400 min-w-fit pt-1\">\r\n            <TrendingUp className=\"w-4 h-4\" />\r\n            <span className=\"text-xs font-semibold uppercase tracking-wider\">Trending</span>\r\n          </div>\r\n          \r\n          <div className=\"flex flex-wrap gap-2 flex-1\">\r\n            {sortedTags.map((tag) => (\r\n              <button\r\n                key={tag.tag}\r\n                onClick={() => onTagClick(tag.tag)}\r\n                className={`\r\n                  px-3 py-1.5 rounded-full border transition-all duration-300\r\n                  hover:scale-105 hover:shadow-lg cursor-pointer\r\n                  ${getTagColor(tag.count)} ${getTagSize(tag.count)}\r\n                  flex items-center gap-1.5 group\r\n                `}\r\n                title={`${tag.count} listings`}\r\n              >\r\n                <Tag className=\"w-3 h-3 opacity-70 group-hover:opacity-100\" />\r\n                <span>{tag.tag}</span>\r\n                <span className=\"opacity-60 text-[10px] font-normal\">\r\n                  ({tag.count})\r\n                </span>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Optional: Show a hint */}\r\n        <div className=\"mt-3 pt-3 border-t border-gray-700/50\">\r\n          <p className=\"text-[10px] text-gray-500 italic\">\r\n            Click a tag to filter listings • Tags are updated in real-time based on active listings\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,wCAAwC;;;;;AAGxC;AAAA;AAAA;AAFA;;;AAgBe,SAAS,YAAY,EAAE,IAAI,EAAE,UAAU,EAAE,SAAS,EAAE,KAAK,EAAoB;IAC1F,IAAI,WAAW;QACb,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,sMAAA,CAAA,SAAM;4BAAC,WAAU;;;;;;sCAClB,8OAAC;4BAAK,WAAU;sCAAU;;;;;;;;;;;;;;;;;;;;;;IAKpC;IAEA,IAAI,SAAS,KAAK,MAAM,KAAK,GAAG;QAC9B,OAAO;IACT;IAEA,uCAAuC;IACvC,MAAM,aAAa;WAAI;KAAK,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,KAAK,GAAG,EAAE,KAAK;IAE7D,0CAA0C;IAC1C,MAAM,WAAW,KAAK,GAAG,IAAI,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,KAAK;IAClD,MAAM,WAAW,KAAK,GAAG,IAAI,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,KAAK;IAClD,MAAM,QAAQ,WAAW,YAAY;IAErC,MAAM,aAAa,CAAC;QAClB,MAAM,aAAa,CAAC,QAAQ,QAAQ,IAAI;QACxC,IAAI,aAAa,KAAK,OAAO;QAC7B,IAAI,aAAa,KAAK,OAAO;QAC7B,OAAO;IACT;IAEA,MAAM,cAAc,CAAC;QACnB,MAAM,aAAa,CAAC,QAAQ,QAAQ,IAAI;QACxC,IAAI,aAAa,KAAK,OAAO;QAC7B,IAAI,aAAa,KAAK,OAAO;QAC7B,OAAO;IACT;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC,kNAAA,CAAA,aAAU;oCAAC,WAAU;;;;;;8CACtB,8OAAC;oCAAK,WAAU;8CAAiD;;;;;;;;;;;;sCAGnE,8OAAC;4BAAI,WAAU;sCACZ,WAAW,GAAG,CAAC,CAAC,oBACf,8OAAC;oCAEC,SAAS,IAAM,WAAW,IAAI,GAAG;oCACjC,WAAW,CAAC;;;kBAGV,EAAE,YAAY,IAAI,KAAK,EAAE,CAAC,EAAE,WAAW,IAAI,KAAK,EAAE;;gBAEpD,CAAC;oCACD,OAAO,GAAG,IAAI,KAAK,CAAC,SAAS,CAAC;;sDAE9B,8OAAC,gMAAA,CAAA,MAAG;4CAAC,WAAU;;;;;;sDACf,8OAAC;sDAAM,IAAI,GAAG;;;;;;sDACd,8OAAC;4CAAK,WAAU;;gDAAqC;gDACjD,IAAI,KAAK;gDAAC;;;;;;;;mCAbT,IAAI,GAAG;;;;;;;;;;;;;;;;8BAqBpB,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAE,WAAU;kCAAmC;;;;;;;;;;;;;;;;;;;;;;AAO1D","debugId":null}},
    {"offset": {"line": 1991, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/hooks/useBrowseListings.ts"],"sourcesContent":["// src/hooks/useBrowseListings.ts\r\n\r\nimport { useState, useEffect, useMemo, useRef, useCallback } from 'react';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useListings } from '@/context/ListingContext';\r\nimport { storageService, securityService } from '@/services';\r\nimport { FilterOptions, CategoryCounts, SellerProfile, ListingWithProfile } from '@/types/browse';\r\nimport { \r\n  HOUR_RANGE_OPTIONS, \r\n  PAGE_SIZE, \r\n  isAuctionListing as isAuctionListingUtil, \r\n  isListingActive as isListingActiveUtil, \r\n  getDisplayPrice as getDisplayPriceUtil,\r\n  formatTimeRemaining as formatTimeRemainingUtil\r\n} from '@/utils/browseUtils';\r\nimport { Listing } from '@/context/ListingContext';\r\nimport { sanitizeSearchQuery, sanitizeNumber, sanitizeStrict } from '@/utils/security/sanitization';\r\nimport { useRateLimit } from '@/utils/security/rate-limiter';\r\nimport { searchSchemas } from '@/utils/validation/schemas';\r\n\r\n// Type definitions - matching what we actually have in storage\r\ninterface Order {\r\n  id: string;\r\n  seller: string;\r\n  buyer: string;\r\n  date: string;\r\n}\r\n\r\ninterface User {\r\n  username: string;\r\n  verified?: boolean;\r\n  verificationStatus?: string;\r\n}\r\n\r\n// Helper functions to normalize listings for utility functions\r\nconst normalizeListing = (listing: Listing): any => ({\r\n  ...listing,\r\n  markedUpPrice: listing.markedUpPrice || Math.round(listing.price * 1.1 * 100) / 100,\r\n  imageUrls: listing.imageUrls || []\r\n});\r\n\r\nconst isAuctionListing = (listing: Listing): boolean => {\r\n  return isAuctionListingUtil(normalizeListing(listing));\r\n};\r\n\r\nconst isListingActive = (listing: Listing): boolean => {\r\n  return isListingActiveUtil(normalizeListing(listing));\r\n};\r\n\r\nconst getDisplayPrice = (listing: Listing) => {\r\n  return getDisplayPriceUtil(normalizeListing(listing));\r\n};\r\n\r\nexport const useBrowseListings = () => {\r\n  const { user } = useAuth();\r\n  const router = useRouter();\r\n  const { checkLimit: checkSearchLimit } = useRateLimit('SEARCH');\r\n  \r\n  // Get data from ListingContext\r\n  const { \r\n    listings: contextListings,\r\n    users: contextUsers,\r\n    subscriptions: contextSubscriptions,\r\n    orderHistory: contextOrderHistory,\r\n    isLoading: contextLoading,\r\n    error: contextError,\r\n    refreshListings\r\n  } = useListings();\r\n\r\n  // State for filters and UI\r\n  const [filter, setFilter] = useState<FilterOptions['filter']>('all');\r\n  const [selectedHourRange, setSelectedHourRange] = useState(HOUR_RANGE_OPTIONS[0]);\r\n  const [searchTerm, setSearchTerm] = useState<string>('');\r\n  const [minPrice, setMinPrice] = useState<string>('');\r\n  const [maxPrice, setMaxPrice] = useState<string>('');\r\n  const [sortBy, setSortBy] = useState<FilterOptions['sortBy']>('newest');\r\n  const [page, setPage] = useState(0);\r\n  const [forceUpdateTimer, setForceUpdateTimer] = useState(0);\r\n  const [hoveredListing, setHoveredListing] = useState<string | null>(null);\r\n  const [sellerProfiles, setSellerProfiles] = useState<{ [key: string]: SellerProfile }>({});\r\n  const [listingErrors, setListingErrors] = useState<{ [listingId: string]: string }>({});\r\n  const [debouncedSearchTerm, setDebouncedSearchTerm] = useState(searchTerm);\r\n  const [rateLimitError, setRateLimitError] = useState<string | null>(null);\r\n\r\n  // Refs\r\n  const timeCache = useRef<{[key: string]: {formatted: string, expires: number}}>({});\r\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\r\n  const mountedRef = useRef(true);\r\n  const lastClickTime = useRef<number>(0);\r\n  const lastQuickViewTime = useRef<number>(0);\r\n\r\n  const MAX_CACHED_PROFILES = 100;\r\n\r\n  // Sanitized search term setter\r\n  const handleSearchTermChange = useCallback((value: string) => {\r\n    const sanitized = sanitizeSearchQuery(value);\r\n    setSearchTerm(sanitized);\r\n  }, []);\r\n\r\n  // Validated price setters\r\n  const handleMinPriceChange = useCallback((value: string) => {\r\n    if (value === '') {\r\n      setMinPrice('');\r\n      return;\r\n    }\r\n    \r\n    const validation = searchSchemas.priceRange.safeParse({ min: parseFloat(value) });\r\n    if (validation.success) {\r\n      setMinPrice(value);\r\n    }\r\n  }, []);\r\n\r\n  const handleMaxPriceChange = useCallback((value: string) => {\r\n    if (value === '') {\r\n      setMaxPrice('');\r\n      return;\r\n    }\r\n    \r\n    const validation = searchSchemas.priceRange.safeParse({ max: parseFloat(value) });\r\n    if (validation.success) {\r\n      setMaxPrice(value);\r\n    }\r\n  }, []);\r\n\r\n  // Apply filters to context listings\r\n  const filteredListings = useMemo(() => {\r\n    console.log('=== Filtering listings ===');\r\n    console.log('Context listings count:', contextListings.length);\r\n    console.log('Current filters:', { filter, searchTerm: debouncedSearchTerm, minPrice, maxPrice, sortBy, selectedHourRange });\r\n    \r\n    let filtered = [...contextListings];\r\n    \r\n    // Filter out ended auctions\r\n    filtered = filtered.filter(listing => {\r\n      if (!listing.auction) return true;\r\n      const now = new Date();\r\n      const endTime = new Date(listing.auction.endTime);\r\n      return endTime > now;\r\n    });\r\n    \r\n    console.log('After active filter:', filtered.length);\r\n    \r\n    // Apply category filter\r\n    if (filter !== 'all') {\r\n      filtered = filtered.filter(listing => {\r\n        if (filter === 'premium') return listing.isPremium && !listing.auction;\r\n        if (filter === 'standard') return !listing.isPremium && !listing.auction;\r\n        if (filter === 'auction') return !!listing.auction;\r\n        return true;\r\n      });\r\n    }\r\n    \r\n    console.log('After category filter:', filtered.length);\r\n    \r\n    // Apply search filter\r\n    if (debouncedSearchTerm) {\r\n      const query = debouncedSearchTerm.toLowerCase();\r\n      filtered = filtered.filter(listing =>\r\n        listing.title.toLowerCase().includes(query) ||\r\n        listing.description.toLowerCase().includes(query) ||\r\n        listing.tags?.some(tag => tag.toLowerCase().includes(query)) ||\r\n        listing.seller.toLowerCase().includes(query)\r\n      );\r\n    }\r\n    \r\n    console.log('After search filter:', filtered.length);\r\n    \r\n    // Apply price filters\r\n    if (minPrice) {\r\n      const min = parseFloat(minPrice);\r\n      if (!isNaN(min)) {\r\n        filtered = filtered.filter(listing => {\r\n          const price = listing.auction?.highestBid || listing.price;\r\n          return price >= min;\r\n        });\r\n      }\r\n    }\r\n    \r\n    if (maxPrice) {\r\n      const max = parseFloat(maxPrice);\r\n      if (!isNaN(max)) {\r\n        filtered = filtered.filter(listing => {\r\n          const price = listing.auction?.highestBid || listing.price;\r\n          return price <= max;\r\n        });\r\n      }\r\n    }\r\n    \r\n    console.log('After price filter:', filtered.length);\r\n    \r\n    // Apply hour range filter\r\n    filtered = filtered.filter(listing => {\r\n      const hoursWorn = listing.hoursWorn ?? 0;\r\n      return hoursWorn >= selectedHourRange.min && hoursWorn <= selectedHourRange.max;\r\n    });\r\n    \r\n    console.log('After hour range filter:', filtered.length);\r\n    \r\n    // Apply sorting\r\n    filtered.sort((a, b) => {\r\n      switch (sortBy) {\r\n        case 'newest':\r\n          return new Date(b.date).getTime() - new Date(a.date).getTime();\r\n        case 'priceAsc':\r\n          const aPrice = a.auction?.highestBid || a.price;\r\n          const bPrice = b.auction?.highestBid || b.price;\r\n          return aPrice - bPrice;\r\n        case 'priceDesc':\r\n          const aPriceDesc = a.auction?.highestBid || a.price;\r\n          const bPriceDesc = b.auction?.highestBid || b.price;\r\n          return bPriceDesc - aPriceDesc;\r\n        case 'endingSoon':\r\n          if (a.auction && b.auction) {\r\n            return new Date(a.auction.endTime).getTime() - new Date(b.auction.endTime).getTime();\r\n          }\r\n          return a.auction ? -1 : b.auction ? 1 : 0;\r\n        default:\r\n          return 0;\r\n      }\r\n    });\r\n    \r\n    console.log('Final filtered count:', filtered.length);\r\n    return filtered;\r\n  }, [contextListings, filter, debouncedSearchTerm, minPrice, maxPrice, selectedHourRange, sortBy]);\r\n\r\n  // Load seller profiles\r\n  useEffect(() => {\r\n    const loadSellerProfiles = async () => {\r\n      if (typeof window !== 'undefined' && !contextLoading && contextListings.length > 0) {\r\n        const currentSellers = new Set(contextListings.map(listing => listing.seller));\r\n        const profiles: { [key: string]: SellerProfile } = {};\r\n        \r\n        const sellersArray = Array.from(currentSellers).slice(0, MAX_CACHED_PROFILES);\r\n        \r\n        // Load all user profiles at once\r\n        const userProfiles = await storageService.getItem<any>('user_profiles', {});\r\n        \r\n        sellersArray.forEach(seller => {\r\n          const profileData = userProfiles[seller];\r\n          if (profileData) {\r\n            profiles[sanitizeStrict(seller)] = { \r\n              bio: profileData.bio ? sanitizeStrict(profileData.bio) : null, \r\n              pic: profileData.profilePic || null \r\n            };\r\n          }\r\n        });\r\n        \r\n        setSellerProfiles(profiles);\r\n      }\r\n    };\r\n    \r\n    loadSellerProfiles();\r\n  }, [contextListings, contextLoading]);\r\n\r\n  // Debounced search\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedSearchTerm(searchTerm);\r\n    }, 300);\r\n    \r\n    return () => clearTimeout(timer);\r\n  }, [searchTerm]);\r\n\r\n  // Reset page on filter changes\r\n  useEffect(() => {\r\n    setPage(0);\r\n  }, [filter, selectedHourRange, debouncedSearchTerm, minPrice, maxPrice, sortBy]);\r\n\r\n  // Timer management for auctions\r\n  const auctionTimers = useMemo(() => {\r\n    try {\r\n      const now = new Date();\r\n      const activeAuctions = filteredListings.filter(listing => {\r\n        if (!isAuctionListing(listing) || !isListingActive(listing)) return false;\r\n        \r\n        const endTime = listing.auction?.endTime ? new Date(listing.auction.endTime) : null;\r\n        return endTime && endTime > now;\r\n      });\r\n\r\n      return activeAuctions.map(listing => {\r\n        if (!listing.auction) return null;\r\n        \r\n        const endTime = new Date(listing.auction.endTime);\r\n        const timeLeft = endTime.getTime() - now.getTime();\r\n        let updateInterval: number;\r\n        \r\n        if (timeLeft < 60000) {\r\n          updateInterval = 5000;\r\n        } else if (timeLeft < 300000) {\r\n          updateInterval = 15000;\r\n        } else if (timeLeft < 3600000) {\r\n          updateInterval = 60000;\r\n        } else {\r\n          updateInterval = 300000;\r\n        }\r\n        \r\n        return {\r\n          id: listing.id,\r\n          endTime: listing.auction.endTime,\r\n          updateInterval\r\n        };\r\n      }).filter(timer => timer !== null);\r\n    } catch (error) {\r\n      console.error('Error calculating auction timers:', error);\r\n      return [];\r\n    }\r\n  }, [filteredListings]);\r\n\r\n  // Timer effect\r\n  useEffect(() => {\r\n    if (timerRef.current) {\r\n      clearInterval(timerRef.current);\r\n      timerRef.current = null;\r\n    }\r\n    \r\n    if (auctionTimers.length === 0 || !mountedRef.current) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const minInterval = Math.max(\r\n        Math.min(...auctionTimers.map(t => t?.updateInterval ?? Infinity)),\r\n        5000\r\n      );\r\n      \r\n      timerRef.current = setInterval(() => {\r\n        if (!mountedRef.current) {\r\n          if (timerRef.current) {\r\n            clearInterval(timerRef.current);\r\n            timerRef.current = null;\r\n          }\r\n          return;\r\n        }\r\n        \r\n        setForceUpdateTimer(prev => prev + 1);\r\n      }, minInterval);\r\n      \r\n    } catch (error) {\r\n      console.error('Error setting up auction timer:', error);\r\n    }\r\n    \r\n    return () => {\r\n      if (timerRef.current) {\r\n        clearInterval(timerRef.current);\r\n        timerRef.current = null;\r\n      }\r\n    };\r\n  }, [auctionTimers.length]);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    mountedRef.current = true;\r\n    \r\n    return () => {\r\n      mountedRef.current = false;\r\n      if (timerRef.current) {\r\n        clearInterval(timerRef.current);\r\n        timerRef.current = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Memoized calculations\r\n  const categoryCounts = useMemo(() => {\r\n    try {\r\n      const activeListings = contextListings.filter(isListingActive);\r\n      \r\n      return {\r\n        all: activeListings.length,\r\n        standard: activeListings.filter(l => !l.isPremium && !l.auction).length,\r\n        premium: activeListings.filter(l => l.isPremium && !l.auction).length,\r\n        auction: activeListings.filter(l => l.auction).length\r\n      };\r\n    } catch (error) {\r\n      console.error('Error calculating category counts:', error);\r\n      return { all: 0, standard: 0, premium: 0, auction: 0 };\r\n    }\r\n  }, [contextListings]);\r\n\r\n  const getSellerSalesCount = useCallback((seller: string) => {\r\n    try {\r\n      return contextOrderHistory.filter(order => order.seller === seller).length;\r\n    } catch (error) {\r\n      console.error('Error getting seller sales count:', error);\r\n      return 0;\r\n    }\r\n  }, [contextOrderHistory]);\r\n\r\n  // Create paginated listings with profile data\r\n  const paginatedListings = useMemo(() => {\r\n    try {\r\n      // First, create listings with profile data\r\n      const listingsWithProfiles = filteredListings.map(listing => {\r\n        const sellerUser = contextUsers?.[listing.seller];\r\n        const isSellerVerified = sellerUser?.verified || sellerUser?.verificationStatus === 'verified';\r\n        const sellerSalesCount = getSellerSalesCount(listing.seller);\r\n        const sellerProfile = sellerProfiles[listing.seller];\r\n        \r\n        return {\r\n          ...listing,\r\n          sellerProfile,\r\n          sellerSalesCount,\r\n          isSellerVerified\r\n        } as ListingWithProfile;\r\n      });\r\n\r\n      // Then paginate\r\n      const start = page * PAGE_SIZE;\r\n      const end = start + PAGE_SIZE;\r\n      \r\n      console.log(`Paginating: page ${page}, showing items ${start}-${end} of ${listingsWithProfiles.length}`);\r\n      \r\n      return listingsWithProfiles.slice(start, end);\r\n    } catch (error) {\r\n      console.error('Error creating paginated listings:', error);\r\n      return [];\r\n    }\r\n  }, [filteredListings, contextUsers, getSellerSalesCount, sellerProfiles, page]);\r\n  \r\n  const totalPages = useMemo(() => {\r\n    try {\r\n      return Math.ceil(filteredListings.length / PAGE_SIZE);\r\n    } catch (error) {\r\n      console.error('Error calculating total pages:', error);\r\n      return 1;\r\n    }\r\n  }, [filteredListings]);\r\n\r\n  // Utility functions\r\n  const isSubscribed = useCallback((buyerUsername: string, sellerUsername: string): boolean => {\r\n    if (!buyerUsername || !sellerUsername) return false;\r\n    const buyerSubs = contextSubscriptions[buyerUsername] || [];\r\n    return buyerSubs.includes(sellerUsername);\r\n  }, [contextSubscriptions]);\r\n\r\n  // Handlers\r\n  const handleMouseEnter = useCallback((listingId: string) => {\r\n    setHoveredListing(listingId);\r\n  }, []);\r\n  \r\n  const handleMouseLeave = useCallback(() => {\r\n    setHoveredListing(null);\r\n  }, []);\r\n\r\n  const handleListingClick = useCallback((listingId: string, isLocked: boolean) => {\r\n    try {\r\n      if (isLocked) return;\r\n      \r\n      const now = Date.now();\r\n      if (now - lastClickTime.current < 300) return;\r\n      \r\n      lastClickTime.current = now;\r\n      router.push(`/browse/${listingId}`);\r\n    } catch (error) {\r\n      console.error('Error navigating to listing:', error);\r\n    }\r\n  }, [router]);\r\n\r\n  const handleQuickView = useCallback((e: React.MouseEvent, listingId: string) => {\r\n    try {\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n      \r\n      const now = Date.now();\r\n      if (now - lastQuickViewTime.current < 300) return;\r\n      \r\n      lastQuickViewTime.current = now;\r\n      router.push(`/browse/${listingId}`);\r\n    } catch (error) {\r\n      console.error('Error quick viewing listing:', error);\r\n    }\r\n  }, [router]);\r\n\r\n  const handleListingError = useCallback((error: Error, listingId: string) => {\r\n    console.error('Listing error:', error, 'for listing:', listingId);\r\n    const sanitizedError = sanitizeStrict(error.message);\r\n    setListingErrors(prev => ({\r\n      ...prev,\r\n      [listingId]: sanitizedError\r\n    }));\r\n  }, []);\r\n\r\n  const handlePreviousPage = useCallback(() => {\r\n    if (page > 0) {\r\n      setPage(prev => prev - 1);\r\n    }\r\n  }, [page]);\r\n\r\n  const handleNextPage = useCallback(() => {\r\n    if (page < totalPages - 1) {\r\n      setPage(prev => prev + 1);\r\n    }\r\n  }, [page, totalPages]);\r\n\r\n  const handlePageClick = useCallback((targetPage: number) => {\r\n    if (targetPage >= 0 && targetPage < totalPages) {\r\n      setPage(targetPage);\r\n    }\r\n  }, [totalPages]);\r\n\r\n  const formatTimeRemaining = useCallback((endTime: string) => {\r\n    return formatTimeRemainingUtil(endTime, timeCache);\r\n  }, []);\r\n\r\n  const resetFilters = useCallback(() => {\r\n    setFilter('all');\r\n    setSearchTerm('');\r\n    setMinPrice('');\r\n    setMaxPrice('');\r\n    setSelectedHourRange(HOUR_RANGE_OPTIONS[0]);\r\n    setSortBy('newest');\r\n    setRateLimitError(null);\r\n  }, []);\r\n\r\n  const handleRateLimit = useCallback(() => {\r\n    const rateLimitResult = checkSearchLimit();\r\n    if (!rateLimitResult.allowed) {\r\n      setRateLimitError(`Too many searches. Please wait ${rateLimitResult.waitTime} seconds.`);\r\n      return false;\r\n    }\r\n    setRateLimitError(null);\r\n    return true;\r\n  }, [checkSearchLimit]);\r\n\r\n  // Trigger refresh when component mounts\r\n  useEffect(() => {\r\n    refreshListings();\r\n  }, []);\r\n\r\n  return {\r\n    // Auth & State\r\n    user,\r\n    filter,\r\n    setFilter,\r\n    selectedHourRange,\r\n    setSelectedHourRange,\r\n    searchTerm,\r\n    setSearchTerm: handleSearchTermChange,\r\n    minPrice,\r\n    setMinPrice: handleMinPriceChange,\r\n    maxPrice,\r\n    setMaxPrice: handleMaxPriceChange,\r\n    sortBy,\r\n    setSortBy,\r\n    page,\r\n    hoveredListing,\r\n    listingErrors,\r\n    forceUpdateTimer,\r\n    rateLimitError,\r\n    \r\n    // Data\r\n    filteredListings: paginatedListings,\r\n    paginatedListings,\r\n    categoryCounts,\r\n    totalPages,\r\n    \r\n    // Loading state\r\n    isLoading: contextLoading,\r\n    error: contextError,\r\n    \r\n    // Handlers\r\n    handleMouseEnter,\r\n    handleMouseLeave,\r\n    handleListingClick,\r\n    handleQuickView,\r\n    handleListingError,\r\n    handlePreviousPage,\r\n    handleNextPage,\r\n    handlePageClick,\r\n    resetFilters,\r\n    refreshListings,\r\n    \r\n    // Utils\r\n    isSubscribed,\r\n    getDisplayPrice,\r\n    formatTimeRemaining,\r\n    \r\n    // Constants\r\n    HOUR_RANGE_OPTIONS,\r\n    PAGE_SIZE\r\n  };\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2519, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/hooks/useAnalytics.ts"],"sourcesContent":["// src/hooks/useAnalytics.ts\r\n\r\nimport { useCallback } from 'react';\r\nimport { usePathname } from 'next/navigation';\r\n\r\ninterface AnalyticsEvent {\r\n  action: string;\r\n  category: string;\r\n  label?: string;\r\n  value?: number;\r\n  customData?: Record<string, any>;\r\n}\r\n\r\ndeclare global {\r\n  interface Window {\r\n    gtag?: (\r\n      command: string,\r\n      ...args: any[]\r\n    ) => void;\r\n  }\r\n}\r\n\r\nexport function useAnalytics() {\r\n  const pathname = usePathname();\r\n\r\n  const trackEvent = useCallback((event: AnalyticsEvent) => {\r\n    // Google Analytics 4\r\n    if (typeof window !== 'undefined' && window.gtag) {\r\n      window.gtag('event', event.action, {\r\n        event_category: event.category,\r\n        event_label: event.label,\r\n        value: event.value,\r\n        ...event.customData\r\n      });\r\n    }\r\n\r\n    // Custom analytics endpoint\r\n    if (process.env.NEXT_PUBLIC_ANALYTICS_ENDPOINT) {\r\n      fetch(process.env.NEXT_PUBLIC_ANALYTICS_ENDPOINT, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          ...event,\r\n          timestamp: new Date().toISOString(),\r\n          page: pathname,\r\n          userAgent: navigator.userAgent\r\n        })\r\n      }).catch(() => {\r\n        // Fail silently\r\n      });\r\n    }\r\n  }, [pathname]);\r\n\r\n  const trackPageView = useCallback((url: string) => {\r\n    if (typeof window !== 'undefined' && window.gtag) {\r\n      window.gtag('config', process.env.NEXT_PUBLIC_GA_MEASUREMENT_ID!, {\r\n        page_path: url,\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  const trackPurchase = useCallback((data: {\r\n    transactionId: string;\r\n    value: number;\r\n    currency: string;\r\n    items: Array<{\r\n      id: string;\r\n      name: string;\r\n      category: string;\r\n      price: number;\r\n      quantity: number;\r\n    }>;\r\n  }) => {\r\n    trackEvent({\r\n      action: 'purchase',\r\n      category: 'ecommerce',\r\n      value: data.value,\r\n      customData: {\r\n        transaction_id: data.transactionId,\r\n        currency: data.currency,\r\n        items: data.items\r\n      }\r\n    });\r\n  }, [trackEvent]);\r\n\r\n  const trackSearch = useCallback((searchTerm: string, resultsCount: number) => {\r\n    trackEvent({\r\n      action: 'search',\r\n      category: 'engagement',\r\n      label: searchTerm,\r\n      value: resultsCount\r\n    });\r\n  }, [trackEvent]);\r\n\r\n  const trackSocialShare = useCallback((platform: string, contentId: string) => {\r\n    trackEvent({\r\n      action: 'share',\r\n      category: 'social',\r\n      label: platform,\r\n      customData: {\r\n        content_id: contentId\r\n      }\r\n    });\r\n  }, [trackEvent]);\r\n\r\n  return {\r\n    trackEvent,\r\n    trackPageView,\r\n    trackPurchase,\r\n    trackSearch,\r\n    trackSocialShare\r\n  };\r\n}"],"names":[],"mappings":"AAAA,4BAA4B;;;;AAE5B;AACA;;;AAmBO,SAAS;IACd,MAAM,WAAW,CAAA,GAAA,kIAAA,CAAA,cAAW,AAAD;IAE3B,MAAM,aAAa,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE,CAAC;QAC9B,qBAAqB;QACrB;;QASA,4BAA4B;QAC5B,IAAI,QAAQ,GAAG,CAAC,8BAA8B,EAAE;YAC9C,MAAM,QAAQ,GAAG,CAAC,8BAA8B,EAAE;gBAChD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACnB,GAAG,KAAK;oBACR,WAAW,IAAI,OAAO,WAAW;oBACjC,MAAM;oBACN,WAAW,UAAU,SAAS;gBAChC;YACF,GAAG,KAAK,CAAC;YACP,gBAAgB;YAClB;QACF;IACF,GAAG;QAAC;KAAS;IAEb,MAAM,gBAAgB,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE,CAAC;QACjC;;IAKF,GAAG,EAAE;IAEL,MAAM,gBAAgB,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE,CAAC;QAYjC,WAAW;YACT,QAAQ;YACR,UAAU;YACV,OAAO,KAAK,KAAK;YACjB,YAAY;gBACV,gBAAgB,KAAK,aAAa;gBAClC,UAAU,KAAK,QAAQ;gBACvB,OAAO,KAAK,KAAK;YACnB;QACF;IACF,GAAG;QAAC;KAAW;IAEf,MAAM,cAAc,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE,CAAC,YAAoB;QACnD,WAAW;YACT,QAAQ;YACR,UAAU;YACV,OAAO;YACP,OAAO;QACT;IACF,GAAG;QAAC;KAAW;IAEf,MAAM,mBAAmB,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE,CAAC,UAAkB;QACtD,WAAW;YACT,QAAQ;YACR,UAAU;YACV,OAAO;YACP,YAAY;gBACV,YAAY;YACd;QACF;IACF,GAAG;QAAC;KAAW;IAEf,OAAO;QACL;QACA;QACA;QACA;QACA;IACF;AACF","debugId":null}},
    {"offset": {"line": 2605, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/osr99/OneDrive/Documents/GitHub/pantypost/src/app/browse/page.tsx"],"sourcesContent":["// src/app/browse/page.tsx\r\n'use client';\r\n\r\nimport { useEffect, useRef, useCallback, useState } from 'react';\r\nimport RequireAuth from '@/components/RequireAuth';\r\nimport BanCheck from '@/components/BanCheck';\r\nimport BrowseHeader from '@/components/browse/BrowseHeader';\r\nimport BrowseFilters from '@/components/browse/BrowseFilters';\r\nimport ListingGrid from '@/components/browse/ListingGrid';\r\nimport PaginationControls from '@/components/browse/PaginationControls';\r\nimport EmptyState from '@/components/browse/EmptyState';\r\nimport PopularTags from '@/components/browse/PopularTags';\r\nimport { useBrowseListings } from '@/hooks/useBrowseListings';\r\nimport { useAnalytics } from '@/hooks/useAnalytics';\r\nimport { listingsService } from '@/services/listings.service';\r\n\r\ninterface PopularTag {\r\n  tag: string;\r\n  count: number;\r\n}\r\n\r\nexport default function BrowsePage() {\r\n  const { trackEvent, trackSearch } = useAnalytics();\r\n  const searchTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n  const filterTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n  const isMountedRef = useRef(true);\r\n  const previousFiltersRef = useRef<string>('');\r\n  \r\n  // Popular tags state\r\n  const [popularTags, setPopularTags] = useState<PopularTag[]>([]);\r\n  const [tagsLoading, setTagsLoading] = useState(false);\r\n  const [tagsError, setTagsError] = useState<string | null>(null);\r\n  \r\n  const {\r\n    user,\r\n    filter,\r\n    setFilter,\r\n    selectedHourRange,\r\n    setSelectedHourRange,\r\n    searchTerm,\r\n    setSearchTerm,\r\n    minPrice,\r\n    setMinPrice,\r\n    maxPrice,\r\n    setMaxPrice,\r\n    sortBy,\r\n    setSortBy,\r\n    page,\r\n    hoveredListing,\r\n    listingErrors,\r\n    forceUpdateTimer,\r\n    filteredListings,\r\n    paginatedListings,\r\n    categoryCounts,\r\n    totalPages,\r\n    handleMouseEnter,\r\n    handleMouseLeave,\r\n    handleListingClick,\r\n    handleQuickView,\r\n    handleListingError,\r\n    handlePreviousPage,\r\n    handleNextPage,\r\n    handlePageClick,\r\n    resetFilters,\r\n    isSubscribed,\r\n    getDisplayPrice,\r\n    formatTimeRemaining,\r\n    HOUR_RANGE_OPTIONS,\r\n    PAGE_SIZE,\r\n    isLoading,\r\n    refreshListings\r\n  } = useBrowseListings();\r\n\r\n  const hasActiveFilters = !!(searchTerm || minPrice || maxPrice || selectedHourRange.label !== 'Any Hours' || sortBy !== 'newest');\r\n\r\n  // Track component mount status\r\n  useEffect(() => {\r\n    isMountedRef.current = true;\r\n    \r\n    return () => {\r\n      isMountedRef.current = false;\r\n      // Clean up any pending timeouts\r\n      if (searchTimeoutRef.current) {\r\n        clearTimeout(searchTimeoutRef.current);\r\n        searchTimeoutRef.current = null;\r\n      }\r\n      if (filterTimeoutRef.current) {\r\n        clearTimeout(filterTimeoutRef.current);\r\n        filterTimeoutRef.current = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Listen for subscription changes and refresh listings\r\n  useEffect(() => {\r\n    const handleSubscriptionChange = (event: CustomEvent) => {\r\n      console.log('[BrowsePage] Subscription changed:', event.detail);\r\n      \r\n      // Only refresh if the current user is the one who subscribed/unsubscribed\r\n      if (user && event.detail.buyer === user.username) {\r\n        // Small delay to ensure backend has processed the change\r\n        setTimeout(() => {\r\n          refreshListings();\r\n        }, 500);\r\n      }\r\n    };\r\n\r\n    window.addEventListener('subscription:changed', handleSubscriptionChange as EventListener);\r\n    \r\n    return () => {\r\n      window.removeEventListener('subscription:changed', handleSubscriptionChange as EventListener);\r\n    };\r\n  }, [user, refreshListings]);\r\n\r\n  // Fetch popular tags\r\n  useEffect(() => {\r\n    const fetchPopularTags = async () => {\r\n      if (!isMountedRef.current) return;\r\n      \r\n      setTagsLoading(true);\r\n      setTagsError(null);\r\n      try {\r\n        const response = await listingsService.getPopularTags(15);\r\n        if (isMountedRef.current && response.success && response.data) {\r\n          setPopularTags(response.data);\r\n        } else if (isMountedRef.current && !response.success) {\r\n          setTagsError('Failed to load popular tags');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching popular tags:', error);\r\n        if (isMountedRef.current) {\r\n          setTagsError('Failed to load popular tags');\r\n        }\r\n      } finally {\r\n        if (isMountedRef.current) {\r\n          setTagsLoading(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchPopularTags();\r\n  }, []); // Only fetch once on mount\r\n\r\n  // Track page view\r\n  useEffect(() => {\r\n    if (isMountedRef.current) {\r\n      try {\r\n        trackEvent({\r\n          action: 'page_view',\r\n          category: 'navigation',\r\n          label: 'browse_page'\r\n        });\r\n      } catch (error) {\r\n        console.error('Failed to track page view:', error);\r\n      }\r\n    }\r\n  }, [trackEvent]);\r\n\r\n  // Track search with debouncing\r\n  useEffect(() => {\r\n    if (searchTerm && isMountedRef.current) {\r\n      if (searchTimeoutRef.current) {\r\n        clearTimeout(searchTimeoutRef.current);\r\n        searchTimeoutRef.current = null;\r\n      }\r\n      searchTimeoutRef.current = setTimeout(() => {\r\n        if (isMountedRef.current) {\r\n          try {\r\n            trackSearch(searchTerm, filteredListings.length);\r\n          } catch (error) {\r\n            console.error('Failed to track search:', error);\r\n          }\r\n        }\r\n      }, 1000);\r\n    }\r\n    return () => {\r\n      if (searchTimeoutRef.current) {\r\n        clearTimeout(searchTimeoutRef.current);\r\n        searchTimeoutRef.current = null;\r\n      }\r\n    };\r\n  }, [searchTerm, filteredListings.length, trackSearch]);\r\n\r\n  // Track filter changes with debouncing\r\n  useEffect(() => {\r\n    const currentFilterSignature = JSON.stringify({\r\n      filter,\r\n      searchTerm,\r\n      minPrice,\r\n      maxPrice,\r\n      selectedHourRange: selectedHourRange.label,\r\n      sortBy\r\n    });\r\n    \r\n    if (hasActiveFilters && currentFilterSignature !== previousFiltersRef.current && isMountedRef.current) {\r\n      previousFiltersRef.current = currentFilterSignature;\r\n      if (filterTimeoutRef.current) {\r\n        clearTimeout(filterTimeoutRef.current);\r\n        filterTimeoutRef.current = null;\r\n      }\r\n      filterTimeoutRef.current = setTimeout(() => {\r\n        if (isMountedRef.current) {\r\n          try {\r\n            trackEvent({\r\n              action: 'apply_filters',\r\n              category: 'browse',\r\n              label: filter,\r\n              value: filteredListings.length,\r\n              customData: {\r\n                has_search: !!searchTerm,\r\n                has_price_filter: !!(minPrice || maxPrice),\r\n                price_min: minPrice || 0,\r\n                price_max: maxPrice || 0,\r\n                hour_range: selectedHourRange.label,\r\n                sort_by: sortBy\r\n              }\r\n            });\r\n          } catch (error) {\r\n            console.error('Failed to track filter change:', error);\r\n          }\r\n        }\r\n      }, 1500);\r\n    }\r\n    return () => {\r\n      if (filterTimeoutRef.current) {\r\n        clearTimeout(filterTimeoutRef.current);\r\n        filterTimeoutRef.current = null;\r\n      }\r\n    };\r\n  }, [filter, searchTerm, minPrice, maxPrice, selectedHourRange, sortBy, filteredListings.length, hasActiveFilters, trackEvent]);\r\n\r\n  // Handler for tag clicks with analytics\r\n  const handleTagClick = useCallback((tag: string) => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    // Track the tag click\r\n    try {\r\n      trackEvent({\r\n        action: 'select_tag',\r\n        category: 'browse',\r\n        label: tag,\r\n        customData: {\r\n          source: 'popular_tags'\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error('Failed to track tag click:', error);\r\n    }\r\n    \r\n    // Add tag to search term if not already present\r\n    if (!searchTerm.includes(tag)) {\r\n      setSearchTerm(searchTerm ? `${searchTerm} ${tag}` : tag);\r\n    }\r\n  }, [searchTerm, setSearchTerm, trackEvent]);\r\n\r\n  // Enhanced click handler with analytics\r\n  const handleListingClickWithAnalytics = useCallback((listingId: string) => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    const listing = filteredListings.find(l => l.id === listingId);\r\n    if (listing) {\r\n      // Robust auction detection (matches detail page logic)\r\n      const isActualAuction = !!(\r\n        listing.auction &&\r\n        (listing.auction.isAuction || listing.auction.startingPrice !== undefined)\r\n      );\r\n      const price =\r\n        typeof listing.price === 'number'\r\n          ? listing.price\r\n          : parseFloat(String(listing.price)) || 0;\r\n\r\n      try {\r\n        trackEvent({\r\n          action: 'select_item',\r\n          category: 'browse',\r\n          label: listingId,\r\n          value: price,\r\n          customData: {\r\n            item_name: listing.title || 'Unknown',\r\n            item_category: listing.isPremium ? 'premium' : (isActualAuction ? 'auction' : 'standard'),\r\n            seller_name: listing.seller || 'Unknown',\r\n            seller_verified: (listing as any).isSellerVerified ?? (listing as any).isVerified ?? false,\r\n            position: Math.max(1, paginatedListings.findIndex(l => l.id === listingId) + 1)\r\n          }\r\n        });\r\n      } catch (error) {\r\n        console.error('Failed to track listing click:', error);\r\n      }\r\n    }\r\n    // Pass false for isLocked parameter since we're allowing the click\r\n    handleListingClick(listingId, false);\r\n  }, [filteredListings, paginatedListings, trackEvent, handleListingClick]);\r\n\r\n  // Track page navigation\r\n  const handlePageChangeWithAnalytics = useCallback((newPage: number, direction: 'previous' | 'next' | 'direct') => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    try {\r\n      trackEvent({\r\n        action: 'navigate_page',\r\n        category: 'browse',\r\n        label: direction,\r\n        value: newPage,\r\n        customData: {\r\n          from_page: page,\r\n          to_page: newPage\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error('Failed to track page navigation:', error);\r\n    }\r\n    \r\n    if (direction === 'previous') {\r\n      handlePreviousPage();\r\n    } else if (direction === 'next') {\r\n      handleNextPage();\r\n    } else {\r\n      handlePageClick(newPage);\r\n    }\r\n  }, [page, trackEvent, handlePreviousPage, handleNextPage, handlePageClick]);\r\n\r\n  // Track filter reset\r\n  const resetFiltersWithAnalytics = useCallback(() => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    try {\r\n      trackEvent({\r\n        action: 'reset_filters',\r\n        category: 'browse',\r\n        label: 'all_filters'\r\n      });\r\n    } catch (error) {\r\n      console.error('Failed to track filter reset:', error);\r\n    }\r\n    previousFiltersRef.current = '';\r\n    resetFilters();\r\n  }, [trackEvent, resetFilters]);\r\n\r\n  return (\r\n    <BanCheck>\r\n      <RequireAuth role={user?.role || 'buyer'}>\r\n        <main className=\"min-h-screen bg-black text-white pb-16 pt-8\">\r\n          <BrowseHeader\r\n            user={user}\r\n            filteredListingsCount={filteredListings.length}\r\n            filter={filter}\r\n            categoryCounts={categoryCounts}\r\n            onFilterChange={setFilter}\r\n          />\r\n\r\n          <BrowseFilters\r\n            searchTerm={searchTerm}\r\n            onSearchTermChange={setSearchTerm}\r\n            minPrice={minPrice}\r\n            onMinPriceChange={setMinPrice}\r\n            maxPrice={maxPrice}\r\n            onMaxPriceChange={setMaxPrice}\r\n            sortBy={sortBy}\r\n            onSortByChange={setSortBy}\r\n            selectedHourRange={selectedHourRange}\r\n            onHourRangeChange={setSelectedHourRange}\r\n            hourRangeOptions={HOUR_RANGE_OPTIONS}\r\n            onClearFilters={resetFiltersWithAnalytics}\r\n            hasActiveFilters={hasActiveFilters}\r\n          />\r\n\r\n          {/* Popular Tags Section - Only show when no filters are active */}\r\n          {!hasActiveFilters && popularTags.length > 0 && (\r\n            <PopularTags\r\n              tags={popularTags}\r\n              onTagClick={handleTagClick}\r\n              isLoading={tagsLoading}\r\n              error={tagsError}\r\n            />\r\n          )}\r\n\r\n          <div className=\"max-w-[1700px] mx-auto px-6\">\r\n            {paginatedListings.length === 0 && !isLoading ? (\r\n              <EmptyState\r\n                searchTerm={searchTerm}\r\n                onResetFilters={resetFiltersWithAnalytics}\r\n              />\r\n            ) : (\r\n              <>\r\n                <ListingGrid\r\n                  listings={paginatedListings}\r\n                  hoveredListing={hoveredListing}\r\n                  onListingHover={handleMouseEnter}\r\n                  onListingLeave={handleMouseLeave}\r\n                  onListingClick={handleListingClickWithAnalytics}\r\n                  onQuickView={handleQuickView}\r\n                  user={user}\r\n                  isSubscribed={isSubscribed}\r\n                  getDisplayPrice={getDisplayPrice}\r\n                  forceUpdateTimer={forceUpdateTimer}\r\n                  formatTimeRemaining={formatTimeRemaining}\r\n                  listingErrors={listingErrors}\r\n                  onListingError={handleListingError}\r\n                />\r\n\r\n                {totalPages > 1 && (\r\n                  <PaginationControls\r\n                    currentPage={page}\r\n                    totalPages={totalPages}\r\n                    filteredListingsCount={filteredListings.length}\r\n                    pageSize={PAGE_SIZE}\r\n                    onPreviousPage={() => handlePageChangeWithAnalytics(page - 1, 'previous')}\r\n                    onNextPage={() => handlePageChangeWithAnalytics(page + 1, 'next')}\r\n                    onPageClick={(newPage) => handlePageChangeWithAnalytics(newPage, 'direct')}\r\n                  />\r\n                )}\r\n              </>\r\n            )}\r\n          </div>\r\n        </main>\r\n      </RequireAuth>\r\n    </BanCheck>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}